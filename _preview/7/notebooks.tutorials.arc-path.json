{"version":2,"kind":"Notebook","sha256":"f54611558979b91e4658a0149f7789537276d8efab331db916b0c377d73585fb","slug":"notebooks.tutorials.arc-path","location":"/notebooks/tutorials/1_arc_path.ipynb","dependencies":[],"frontmatter":{"title":"Great Circle Arcs and Path","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/great-circle-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/great-circle-cookbook/blob/HEAD/notebooks/tutorials/1_arc_path.ipynb","thumbnail":"/great-circle-cookbook/_preview/7/build/17b783c8f9a45f5f402dc3edacb2de26.gif","exports":[{"format":"ipynb","filename":"1_arc_path.ipynb","url":"/great-circle-cookbook/_preview/7/build/1_arc_path-a15cf00396f3deb6dc36586d28a63c1e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/great-circle-cookbook/_preview/7/build/17b783c8f9a45f5f402dc3edacb2de26.gif","alt":"Indiana Jones Plane Flying Gif","key":"RC6nipRWeh","urlSource":"https://j.gifs.com/vO2k6P.gif"}],"key":"lpBUEN4LGB"}],"key":"lv4Yur9oBg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Great Circle Arcs and Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v5Y1mgz5Eh"}],"identifier":"great-circle-arcs-and-path","label":"Great Circle Arcs and Path","html_id":"great-circle-arcs-and-path","implicit":true,"key":"O5Kz7w8G36"}],"key":"YzayaPM7BM"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XZlCsDaUnj"}],"key":"PojnEreiAm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f9LGvW0oUM"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"i6ZToQeC3O"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Imagine you are on a plane flying from Cario to Hong Kong. As a passenger, the plane appears to travel a straight path from one airport to the next. However, in reality, as the plane travels it actually curves along the surface of Earth held down by the gravity of the planet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uPJniAAphq"}],"key":"uhtOitf7jJ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The “straight line” has become an arc connecting Cario and Hong Kong on a map. This arc is a great circle arc, just one small subsection of the great circle path.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PE9ZKiVyLh"}],"key":"Viti0qCEQI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Distance between Points on a Great Circle Arc","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"i0yLoReVNw"}],"key":"o1eIBzX6hy"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Convert Spherical Distance to Degrees","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ITL33o6TzA"}],"key":"IY2vPrkeYv"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Determine the Bearing of a Great Circle Arc","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sdw7BHh0Qi"}],"key":"XMNFZfC5OL"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Arc with Intermediate Points","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"h5L4iD0A4Z"}],"key":"OFcSOImmFY"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Determine the Midpoint of a Great Circle Arc","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tE55pp57q1"}],"key":"uLG7WXKsb0"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Path","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"vVoHAaaojc"}],"key":"OwlQzRmKgL"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Determine an Antipodal Point","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dLz8NLFzl4"}],"key":"cVmhbKHGUA"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Compare Great Circle Arc to Rhumb Line (TODO)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JxfZEo908q"}],"key":"BTFOd1nuuO"}],"key":"DpYOGKhA9e"}],"key":"SFVjIxHYvj"}],"key":"uPiAriSun6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ofS7vLlq9q"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"AUdpHYMlC7"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lCKvGn0HGj"}],"key":"vEUZgTgG1w"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"meZICS8UdJ"}],"key":"jJZDlE0UHI"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xRhxGm5oOx"}],"key":"UVyU4yl7lv"}],"key":"Zn5Q284AWp"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/numpy/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Numpy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DAF1NrENZt"}],"urlSource":"https://foundations.projectpythia.org/core/numpy/","key":"CCdLUKjBok"}],"key":"UqOPrZXtzA"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"S70hr93f3S"}],"key":"IAtFIpDlbT"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Used to work with large arrays","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xfhrmyCx1u"}],"key":"uV67F64Hi1"}],"key":"GIHxVOBgAh"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nekfaeq2RI"}],"urlSource":"https://foundations.projectpythia.org/core/pandas","key":"c4O5XGuD2q"}],"key":"CVhNFy8ueN"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jasGZMGO4u"}],"key":"KG6yBjY97p"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Used to read in and organize data (in particular dataframes)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GL90UwtYrm"}],"key":"MZ6j22jmox"}],"key":"g9qVy3fhIW"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Intro to Cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CHaXJjbzB3"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy","key":"uvoUHrAlGA"}],"key":"OvWn0xWXzE"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"J8EYyBlVpO"}],"key":"aborOwayKI"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Will be used for adding maps to plotting","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EgWIspy9WH"}],"key":"jyp1lpqeeT"}],"key":"ImFSfvhdX8"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qkobFsWzt5"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/","key":"p1xdr4jhhv"}],"key":"Y0oepivnxi"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"i67cSXLSEL"}],"key":"iQbms174JC"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Will be used for plotting","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uNiSk7SGLA"}],"key":"ISjqAgmDsb"}],"key":"Vw5F0NZqi3"}],"key":"XM3vA5P7lm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GMMa4KOysQ"}],"key":"DsPxta2sNb"},{"type":"text","value":": 40 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EznyWYKjG4"}],"key":"vSITXUVEia"}],"key":"B2ODm1q6N5"}],"key":"TWZ3FpMvfG"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aWr9sRNOBi"}],"key":"PTYy13ncUK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pd6yga3HyO"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"gCIQCBwrYy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To begin, let’s import the packages we will need in this notebook and collect the list of locations coordinates","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZtuFHrpYk0"}],"key":"T53b5v9jHi"}],"key":"Qwn3D95DF8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd       # reading in data for location information from text file\nimport numpy as np        # working with arrays, vectors, cross/dot products, and radians\n\nfrom pyproj import Geod   # working with the Earth as an ellipsod (WGS-84)\nimport geopy.distance     # working with the Earth as an ellipsod (WGS-84)","key":"pV7nsHXQmD"},{"type":"output","id":"BqoE95rhBi9zI3m3PIRmM","data":[],"key":"Wo6ie4LcMX"}],"key":"k4SFTZOQPu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the coordinates for locations with all coordinates\nlocation_df = pd.read_csv(\"../location_full_coords.txt\")\nlocation_df = location_df.rename(columns=lambda x: x.strip()) # strip excess white space from column names and values\nlocation_df.head()","key":"pvoiOamvOr"},{"type":"output","id":"q5cpea9OGnV1eFKxCtvV0","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"       name  latitude  longitude        cart_x        cart_y        cart_z  \\\n0   arecibo   18.3441   -66.7527  2.389526e+06 -5.562495e+06  2.007347e+06   \n1   boulder   40.0150  -105.2705 -1.286558e+06 -4.712394e+06  4.101066e+06   \n2    boston   42.3601   -71.0589  1.529809e+06 -4.457769e+06  4.297512e+06   \n3  redwoods   41.4017  -124.0417 -2.678169e+06 -3.964322e+06  4.218080e+06   \n4   houston   29.5518   -95.0982 -4.930480e+05 -5.526456e+06  3.145762e+06   \n\n         rho     theta       phi       polar_x       polar_y       polar_z  \n0  6378137.0 -1.165054  1.250631 -5.562495e+06  2.389526e+06  2.007347e+06  \n1  6378137.0  1.304276  0.872403 -4.712394e+06 -1.286558e+06  4.101066e+06  \n2  6378137.0 -1.240212  0.831473 -4.457769e+06  1.529809e+06  4.297512e+06  \n3  6378137.0  0.976657  0.848200 -3.964322e+06 -2.678169e+06  4.218080e+06  \n4  6378137.0  1.481816  1.055020 -5.526456e+06 -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>2.389526e+06</td>\n      <td>-5.562495e+06</td>\n      <td>2.007347e+06</td>\n      <td>6378137.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-1.286558e+06</td>\n      <td>-4.712394e+06</td>\n      <td>4.101066e+06</td>\n      <td>6378137.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>1.529809e+06</td>\n      <td>-4.457769e+06</td>\n      <td>4.297512e+06</td>\n      <td>6378137.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-2.678169e+06</td>\n      <td>-3.964322e+06</td>\n      <td>4.218080e+06</td>\n      <td>6378137.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-4.930480e+05</td>\n      <td>-5.526456e+06</td>\n      <td>3.145762e+06</td>\n      <td>6378137.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"xiDq1WwxAB"}],"key":"xfuI9HhVFG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set index to the name column, this will make it easier to access each row\nlocation_df.index = location_df[\"name\"]\nlocation_df.head()","key":"sBsSXp7HqJ"},{"type":"output","id":"R7u_0A5L-rPmNGPRo3Pst","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"              name  latitude  longitude        cart_x        cart_y  \\\nname                                                                  \narecibo    arecibo   18.3441   -66.7527  2.389526e+06 -5.562495e+06   \nboulder    boulder   40.0150  -105.2705 -1.286558e+06 -4.712394e+06   \nboston      boston   42.3601   -71.0589  1.529809e+06 -4.457769e+06   \nredwoods  redwoods   41.4017  -124.0417 -2.678169e+06 -3.964322e+06   \nhouston    houston   29.5518   -95.0982 -4.930480e+05 -5.526456e+06   \n\n                cart_z        rho     theta       phi       polar_x  \\\nname                                                                  \narecibo   2.007347e+06  6378137.0 -1.165054  1.250631 -5.562495e+06   \nboulder   4.101066e+06  6378137.0  1.304276  0.872403 -4.712394e+06   \nboston    4.297512e+06  6378137.0 -1.240212  0.831473 -4.457769e+06   \nredwoods  4.218080e+06  6378137.0  0.976657  0.848200 -3.964322e+06   \nhouston   3.145762e+06  6378137.0  1.481816  1.055020 -5.526456e+06   \n\n               polar_y       polar_z  \nname                                  \narecibo   2.389526e+06  2.007347e+06  \nboulder  -1.286558e+06  4.101066e+06  \nboston    1.529809e+06  4.297512e+06  \nredwoods -2.678169e+06  4.218080e+06  \nhouston  -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n    <tr>\n      <th>name</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>arecibo</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>2.389526e+06</td>\n      <td>-5.562495e+06</td>\n      <td>2.007347e+06</td>\n      <td>6378137.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>boulder</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-1.286558e+06</td>\n      <td>-4.712394e+06</td>\n      <td>4.101066e+06</td>\n      <td>6378137.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>boston</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>1.529809e+06</td>\n      <td>-4.457769e+06</td>\n      <td>4.297512e+06</td>\n      <td>6378137.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>redwoods</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-2.678169e+06</td>\n      <td>-3.964322e+06</td>\n      <td>4.218080e+06</td>\n      <td>6378137.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>houston</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-4.930480e+05</td>\n      <td>-5.526456e+06</td>\n      <td>3.145762e+06</td>\n      <td>6378137.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"GZsAVdOmFF"}],"key":"rJmPTAR73d"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Distance Between Points on a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nik1YrlYeO"}],"identifier":"distance-between-points-on-a-great-circle-arc","label":"Distance Between Points on a Great Circle Arc","html_id":"distance-between-points-on-a-great-circle-arc","implicit":true,"key":"YtRDptcmul"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can determine the distance between two points A and B (for example, Cario and Hong Kong) both by hand mathematically and with Python packages like ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aV4bscEgYl"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nCE8yDOt4R"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zpVgiuoIZB"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t4ph3GRCxn"}],"key":"nRqgmv66k2"}],"key":"IqTUUjpRax"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Distance Between Points Mathematically via Unit Sphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uw3DFsIm0i"}],"identifier":"determine-distance-between-points-mathematically-via-unit-sphere","label":"Determine Distance Between Points Mathematically via Unit Sphere","html_id":"determine-distance-between-points-mathematically-via-unit-sphere","implicit":true,"key":"K8v3c0MWDK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Unit sphere refers to a sphere with a radius of 1, for the purpose of this cookbook, when we are using a unit sphere to represent Earth, it is a perfect sphere that has been multiplied by 6378137 meters","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Iz5fB2cb5i"}],"key":"Tam7ZuF4Tw"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"First, to measure the distance between point A (latA, lonA) and point B (latB, lonB) on a unit sphere (radius = 1)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wt9EV50bIs"}],"key":"FElnCY8M6Q"},{"type":"math","value":"d=acos(sin(latA)*sin(latB)+cos(latA)*cos(latB)*cos(lonA-lonB))","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=acos(sin(latA)*sin(latB)+cos(latA)*cos(latB)*cos(lonA-lonB))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"1","key":"ythw925UXm"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Because of the translation when working with radians and degrees, there is a mathematically equivalent formula that works better when working with shorter distances (to produce less rounding errors):","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pzklG9BbZw"}],"key":"LIZvG5U9Ye"},{"type":"math","value":"d=2*asin(\\sqrt{sin(\\frac{latA-latB}{2})^2 + cos(latA)*cos(latB)*sin(\\frac{lonA-lonB}{2})^2})","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=2*asin(\\sqrt{sin(\\frac{latA-latB}{2})^2 + cos(latA)*cos(latB)*sin(\\frac{lonA-lonB}{2})^2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7634em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6766em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.6366em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7634em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"txlrgTnDsQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Dist","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"See more: Distance Between Points","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"TFO2SCHBj1"}],"urlSource":"https://edwilliams.org/avform147.htm#Dist","key":"E0fzEqQgyy"}],"key":"IFKv0pNAKM"}],"key":"CUEMRO3W4A"}],"key":"HnosKqRGl1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now translate these equations for measuring the distance between two points (the great circle arc distance) into Python and multiply the result by the Earth’s radius.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RxZQA3W8j6"}],"key":"Fuy8uU8tqn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"These equations use a locations’s latitude/longtiude coordinates, which we can access in a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IcNzM4wo37"},{"type":"inlineCode","value":"pandas","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QSkq28laEx"},{"type":"text","value":" dataframe with the name of the location and which coordinate type we would like, for example:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HfkZrgkj0k"}],"key":"R4g4p5eIcP"}],"key":"baOji3tKEL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"Boulder latitude: {location_df.loc[\"boulder\", \"latitude\"]}\")\nprint(f\"Boulder longitude: {location_df.loc[\"boulder\", \"longitude\"]}\")","key":"o03Sxt1OT2"},{"type":"output","id":"1ZXQRSVY9KTvDbyTAJBfL","data":[{"output_type":"stream","name":"stdout","text":"Boulder latitude: 40.015\nBoulder longitude: -105.2705\n"}],"key":"zhfce3pNzL"}],"key":"s7tvNhOlqp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below, Equation 1 has become ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xQGDQCDK0h"},{"type":"inlineCode","value":"distance_between_points_default","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C7l02LMbBO"},{"type":"text","value":" since this is the equation we will use for most equations, but Equation 2 has become ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EZufTKVJUK"},{"type":"inlineCode","value":"distance_between_points_small","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMpV36ODvy"},{"type":"text","value":" for working with small distances that are less prone to rounding errors. We can call both equations to compare outputs to see how they are mathematically equivalent. By hand, Equation 1 is a faster calculation than Equation 2, but when working with Python both of these functions will run nearly as quickly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ekaimXbkXE"}],"key":"pH2Q7shtIw"}],"key":"mp4DIPvZjM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_between_points_default(start_point=None, end_point=None):\n    earth_radius = 6378137  # meters\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    distance_default = np.arccos(np.sin(latA)*np.sin(latB)+np.cos(latA)*np.cos(latB)*np.cos(lonA-lonB))\n    return distance_default * earth_radius","key":"ipmIvIu9hm"},{"type":"output","id":"QqXT4mj-WPOwRoCgVu_nt","data":[],"key":"W188nV0ULV"}],"key":"JgZTLLtTB6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_between_points_small(start_point=None, end_point=None):\n    earth_radius = 6378137  # meters\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    distance_small = 2 * np.arcsin(np.sqrt((np.sin((latA-latB)/2))**2 + np.cos(latA)*np.cos(latB)*(np.sin((lonA-lonB)/2))**2))\n    return distance_small * earth_radius","key":"sXbx7fpISb"},{"type":"output","id":"soODIH_E1G_FgnzrOxeTh","data":[],"key":"CfqQ5mKrks"}],"key":"PlX8wcvwAk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sidenote: Additional Formulas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mMuMBSKRRP"}],"identifier":"sidenote-additional-formulas","label":"Sidenote: Additional Formulas","html_id":"sidenote-additional-formulas","implicit":true,"key":"ENT4PTfdqE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While we will be focusing on Equation 1 and Equation 2 for our calculations in the future, there are even more methods to calculate the distance between points on a sphere. Each formula has different degrees of precision based on which ellipsoid or sphere is used:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cMB8sRMV4Y"}],"key":"ib4egKDJzr"},{"type":"heading","depth":5,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Haversine Formula (TODO)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r57FE7VHtB"}],"identifier":"haversine-formula-todo","label":"Haversine Formula (TODO)","html_id":"haversine-formula-todo","implicit":true,"key":"DSG00hVJtS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The Haversine Formula determines the great circle distance between two latitude/longtidue points on a sphere, originally conceived in the early 1800’s. Haversine makes use of the central angle θ between two points, measured from the center of the sphere where:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iQakCxu4LH"}],"key":"IXoUD7vJkY"},{"type":"math","value":"θ = \\frac{d}{r}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>θ</mi><mo>=</mo><mfrac><mi>d</mi><mi>r</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">θ = \\frac{d}{r}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"3","key":"gT6QxF1hOP"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Where ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kuAw2Ki3bB"},{"type":"inlineCode","value":"d","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ufxlEa3TUN"},{"type":"text","value":" is the distance between the two latitude/longitude coordinates on the spehre and ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"b4RlHitTBh"},{"type":"inlineCode","value":"r","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oXLsPJ1mOa"},{"type":"text","value":" is the radius of the sphere. Then, to solve for the distance between the two points (","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jbVGQIaXsi"},{"type":"inlineCode","value":"d","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZIrRuEt0TK"},{"type":"text","value":"):","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dolxqcpubL"}],"key":"HxT8ZtNdJn"},{"type":"math","value":"\\text{difference in latitude} = (\\text{latB} - \\text{latA})","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>difference in latitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>latB</mtext><mo>−</mo><mtext>latA</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{difference in latitude} = (\\text{latB} - \\text{latA})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">difference in latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">latB</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">latA</span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"L0eTR0RLVo"},{"type":"math","value":"\\text{difference in longitude} = (\\text{lonB} - \\text{lonA})","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>difference in longitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>lonB</mtext><mo>−</mo><mtext>lonA</mtext><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{difference in longitude} = (\\text{lonB} - \\text{lonA})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">difference in longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">lonB</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">lonA</span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"5","key":"GEsAYj4dkv"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Where the difference in latitude (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ZuOE2F1TgX"},{"type":"inlineCode","value":"dlat","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nn72er4Tw4"},{"type":"text","value":") and longitude (","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"O9kJ4CXTci"},{"type":"inlineCode","value":"dlon","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"be7QkWfsYQ"},{"type":"text","value":") can then be used to calculate:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vGJTEPq1XH"}],"key":"w3dqiW6yHR"},{"type":"math","value":"a = sin(\\frac{dlat}{2})^2 + cos(latA) * cos(latB) * sin(\\frac{dlon}{2})^2","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>d</mi><mi>l</mi><mi>a</mi><mi>t</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>d</mi><mi>l</mi><mi>o</mi><mi>n</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">a = sin(\\frac{dlat}{2})^2 + cos(latA) * cos(latB) * sin(\\frac{dlon}{2})^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"CzzVsIQLcD"},{"type":"math","value":"c = 2 * arcsin(min(1, sqrt(a)))","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">c = 2 * arcsin(min(1, sqrt(a)))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">rcs</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">min</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)))</span></span></span></span></span>","enumerator":"7","key":"qFBaS5AP6i"},{"type":"math","value":"\\text{haversine distance} = R * c","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>haversine distance</mtext><mo>=</mo><mi>R</mi><mo>∗</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">\\text{haversine distance} = R * c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">haversine distance</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span></span>","enumerator":"8","key":"B8Mnj4GYVS"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Where R is the radius of the Earth.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"GqYbpSyJED"}],"key":"EJKcYH5ns3"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Haversine_formula","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"See more","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"YdpNrxxvoi"}],"urlSource":"https://en.wikipedia.org/wiki/Haversine_formula","data":{"page":"Haversine_formula","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"ANHRwruNIr"}],"key":"VBkn7YpVZD"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"See also: ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Al2kTzmA8G"},{"type":"link","url":"https://cs.nyu.edu/~visual/home/proj/tiger/gisfaq.html","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"reference","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"iWXRenqmT7"}],"urlSource":"https://cs.nyu.edu/~visual/home/proj/tiger/gisfaq.html","key":"JlNJy8nVgD"},{"type":"text","value":" (R.W. Sinnott, “Virtues of the Haversine”, Sky and Telescope, vol. 68, no. 2, 1984, pg. 159) (TODO)","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"yGAzPnieja"}],"key":"wwjXT6M5Uy"},{"type":"heading","depth":5,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Vincenty’s Formula (TODO)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"RJCmsoS99L"}],"identifier":"vincentys-formula-todo","label":"Vincenty’s Formula (TODO)","html_id":"vincentys-formula-todo","implicit":true,"key":"NIAHJfkHYP"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Vincenty’s formula is an interative method to calculate the distance between two points on the surface of a spheroid, which has the advantage that it assumpes that the Earth is not a perfect spehre. Instead, it assumes the Earth is an oblate spheroid, which can make it more accurate that typical great circle methods that assume the planet is a sphere","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"CUQkfwybpQ"}],"key":"qB2JVMNozN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Vincenty Sphere Great Circle Distance","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"V3iCBTupxQ"}],"key":"DrE5pYw9Qb"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Vincenty Ellipsoid Great Circle Distance","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"O3dSW32dst"}],"key":"KUO7Cpifw7"}],"key":"ElM9oMnc7b"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Vincenty%27s_formulae","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"See more","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"P8ogxyBxyZ"}],"urlSource":"https://en.wikipedia.org/wiki/Vincenty%27s_formulae","data":{"page":"Vincenty%27s_formulae","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"MnbL0dZlQr"}],"key":"aht8CqJbTk"},{"type":"heading","depth":5,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Meeus Great Circle Distance","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"HKavdZApho"}],"identifier":"meeus-great-circle-distance","label":"Meeus Great Circle Distance","html_id":"meeus-great-circle-distance","implicit":true,"key":"C7DUKHEkNz"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Meeus is a calculation for determining the distance between two points on an ellipsoid from J. Meeus ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"oPc8LCKR3D"},{"type":"emphasis","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Astronomical Algorithms","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"ilka0F3qSJ"}],"key":"v1fyP1Iyjb"},{"type":"text","value":" (1991, 2nd Edition, pg. 477) which is ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"EtFeVbeRjB"},{"type":"link","url":"https://rdrr.io/cran/geosphere/man/distMeeus.html","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"used in R (","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"wS2GUBMrkp"},{"type":"inlineCode","value":"distMeeus","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"ul9kJ0dRyi"},{"type":"text","value":")","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"WN4EUbXobf"}],"urlSource":"https://rdrr.io/cran/geosphere/man/distMeeus.html","key":"bQCiZkhkFI"},{"type":"text","value":". This calculations includes input values for both the radius and the inverse flattening value (but still defaults to WGS-84)","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"GQia74BJOu"}],"key":"h49KGCUCV3"},{"type":"heading","depth":5,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Law of Cosines Great Circle Distance (TODO)","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"wsvC0T6EUO"}],"identifier":"law-of-cosines-great-circle-distance-todo","label":"Law of Cosines Great Circle Distance (TODO)","html_id":"law-of-cosines-great-circle-distance-todo","implicit":true,"key":"lFiBde91RN"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"There is a method to use the law of cosines to determine the shortest distance between two points on a sphere, ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"x7jIcLWymP"},{"type":"link","url":"https://www.rdocumentation.org/packages/geosphere/versions/1.5-20/topics/distCosine","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"which is used in R","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"iNPwB2vKht"}],"urlSource":"https://www.rdocumentation.org/packages/geosphere/versions/1.5-20/topics/distCosine","key":"BrfHVCizQx"}],"key":"txG8w1nVhX"}],"key":"Uf0zHPYH5i"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Distance Points via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rdBanZSGkM"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fDhsHIDwHS"}],"identifier":"determine-distance-points-via-python-package-pyproj","label":"Determine Distance Points via Python Package pyproj","html_id":"determine-distance-points-via-python-package-pyproj","implicit":true,"key":"OqqnO3DwmW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While great circle distances can be determine mathematically, there are some Python packages that account for the fact that the Earth is not a perfect sphere that will be easier to work than relying entirely on the equations derived above. For example, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gEDQazw7x4"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QzP5ZN5iWU"},{"type":"text","value":" treats the Earth as an ellipsoid, by default specifically ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pcq1U3pSua"},{"type":"inlineCode","value":"WGS-84","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ws6TDTC5UK"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZSc7Pzdzj2"}],"key":"S9SieLjb51"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/World_Geodetic_System","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"WGS-84 is the World Geodetic System","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sN9XzFI5qE"}],"urlSource":"https://en.wikipedia.org/wiki/World_Geodetic_System","data":{"page":"World_Geodetic_System","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"MBDaW5EIIZ"},{"type":"text","value":" and considered to be the current standard for geodesy and working with satellite. It is an geocentric and is consistent to within 1 meter around the globe.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NJe80X0RUE"}],"key":"mTYkIw8yW8"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To begin, let use use ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ug5UywqiE1"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DoDCxHAFmo"},{"type":"text","value":" to set up an ellipsoid (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K3wf2e3Neh"},{"type":"inlineCode","value":"WGS-84","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AmlGPRL0tg"},{"type":"text","value":") that will represent the Earth.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GhDbYmHlJK"}],"key":"lvR8dNH8DZ"}],"key":"QfChpJnTj0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geodesic = Geod(ellps=\"WGS84\") # setup ellipsoid\n\n# Return the distance between two points (for example, Boulder and Boston)\n_, _, distance_meter =  geodesic.inv(location_df.loc[\"boulder\", \"longitude\"],\n                                     location_df.loc[\"boulder\", \"latitude\"],\n                                     location_df.loc[\"boston\", \"longitude\"],\n                                     location_df.loc[\"boston\", \"latitude\"])\n\nprint(f\"Distance between coordinates (ellipsoid)   = {distance_meter/1000} km\")","key":"zRFpsFTW62"},{"type":"output","id":"JYg68TLCMhm4RtdWSy-HT","data":[{"output_type":"stream","name":"stdout","text":"Distance between coordinates (ellipsoid)   = 2862.5974799145215 km\n"}],"key":"sZwx7TgF7R"}],"key":"RJoNP0bSeu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That is much easier! We can compare ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4dO6qE8JC"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X7vl3P7y0X"},{"type":"text","value":" to the output from the equations (1 and 2) that we calculated above:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eDaoPt3rjw"}],"key":"xk7h5LKRtM"}],"key":"sRpfzezHET"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nprint(f\"Distance between coordinates (unit sphere) = {distance_unit_sphere_default/1000} km\")\ndistance_unit_sphere_small = distance_between_points_small(\"boulder\", \"boston\")\nprint(f\"Distance between coordinates (unit sphere) = {distance_unit_sphere_small/1000} km\")","key":"IAEVitAnqu"},{"type":"output","id":"Yn56MSuFMhdi7GvPEUaHA","data":[{"output_type":"stream","name":"stdout","text":"Distance between coordinates (unit sphere) = 2858.532213639344 km\nDistance between coordinates (unit sphere) = 2858.5322136393447 km\n"}],"key":"D8c19JVknK"}],"key":"fkPGvYmz99"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both equations we calculated above slightly underestimate the distance between Boston and Boulder because they assume the Earth is a perfect sphere, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQW5pxV1tg"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u3ZHOxD7WP"},{"type":"text","value":" accounts for ellipse.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GLoPnJLfG8"}],"key":"gj3xFI4gum"}],"key":"r5is6irGaF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert Spherical Distance to Degrees","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UoD1OBDgMz"}],"identifier":"convert-spherical-distance-to-degrees","label":"Convert Spherical Distance to Degrees","html_id":"convert-spherical-distance-to-degrees","implicit":true,"key":"WHwnZIn5tX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sometimes when you are working with a map, you don’t always just need a distance in meters or kilometers. We can also convert the distances calculated back into degrees as needed. To convert a distance from meters to degrees, we will assume that the great circle is on a unit sphere with a constant spherical radius of ~6371 km (mean radius of Earth).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UwfUAVnrxw"}],"key":"vLuStP23cV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Side note: The Python library ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c8GeqgGOzX"},{"type":"inlineCode","value":"ObsPy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MEUf3kOrK9"},{"type":"text","value":" has a similar function built-in: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KVKPc4vxRy"},{"type":"link","url":"https://docs.obspy.org/packages/autogen/obspy.geodetics.base.kilometer2degrees.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ObsPy ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QexjN8qmFU"},{"type":"inlineCode","value":"kilometer2degrees()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mTMqqSFrlZ"}],"urlSource":"https://docs.obspy.org/packages/autogen/obspy.geodetics.base.kilometer2degrees.html","key":"w4uzOQufcN"}],"key":"dQ3jYz4QxO"}],"key":"LpylvbiZyU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"earth_radius = 6378.137 # km\n\ndef km_to_degree_distance(distance_km=None):\n    return distance_km / (2 * earth_radius * np.pi / 360)\n\ndef degree_to_km_distance(distance_degree=None):\n    return distance_degree * (2 * earth_radius * np.pi / 360)","key":"EomxFqMSu2"},{"type":"output","id":"WDsOB0sCrx9-GJSnVpeM-","data":[],"key":"KTTumnHDbZ"}],"key":"fCZm5AUI7k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We can convert back and form between kilometers and degrees\nprint(f\"300 km to degrees = {km_to_degree_distance(300)} degrees\")\nprint(f\"2.6949458523585643 degree to km = {degree_to_km_distance(2.6949458523585643)} km\")","key":"jtZkPWhmWJ"},{"type":"output","id":"WmGhK8Jb4E-biDKPrGI1p","data":[{"output_type":"stream","name":"stdout","text":"300 km to degrees = 2.6949458523585643 degrees\n2.6949458523585643 degree to km = 300.0 km\n"}],"key":"vrIV8ntY6t"}],"key":"SOKlBGxR8G"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing of a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d9zJldBbg7"}],"identifier":"determine-the-bearing-of-a-great-circle-arc","label":"Determine the Bearing of a Great Circle Arc","html_id":"determine-the-bearing-of-a-great-circle-arc","implicit":true,"key":"cMljBsIAtm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Arcs are not just a distance, but a direction. Now, we can calculate the direction that an arc takes as it moves from Point A to Point B also known as the bearing.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OYHrrb8BbT"}],"key":"rf2GuAnGLp"}],"key":"OphhgWtY3e"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing Mathematically via Unit Sphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ruEGIBCzsk"}],"identifier":"determine-the-bearing-mathematically-via-unit-sphere","label":"Determine the Bearing Mathematically via Unit Sphere","html_id":"determine-the-bearing-mathematically-via-unit-sphere","implicit":true,"key":"nRx7Xu0gpo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The bearing between between Point A (latA, lonA) and Point B (latB, lonB) on a unit sphere can be calculated as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fPaKpTJybH"}],"key":"u6oYuNosaJ"},{"type":"math","value":"x = cos(latA) * sin(latB) - sin(latA) * cos(latB) * cos(lonB - lonA)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = cos(latA) * sin(latB) - sin(latA) * cos(latB) * cos(lonB - lonA)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"9","key":"wTybP3ioZV"},{"type":"math","value":"y = sin(lonB - lonA) * cos(latB)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = sin(lonB - lonA) * cos(latB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"10","key":"gdcOvaI46w"},{"type":"math","value":"θ = atan2(y, x)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">θ = atan2(y, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"11","key":"OlK8WDLtlq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html#bearing","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Movable Type: Bearing","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zivRQ2lCp3"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html#bearing","key":"slVUvMftaL"}],"key":"TS4pkc9vJm"}],"key":"AVsx12TrhN"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This can be similarly converted to Python as:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nyutNw551a"}],"key":"ANCBfRGAQJ"}],"key":"qcDyUA3i1B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def bearing_between_points_unit_sphere(start_point=None, end_point=None):\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    x = np.cos(latA) * np.sin(latB) - np.sin(latA) * np.cos(latB) * np.cos(lonB - lonA)\n    y = np.sin(lonB - lonA) * np.cos(latB)\n    bearing = np.arctan2(y, x)\n    return np.rad2deg(bearing) % 360","key":"p4gak203if"},{"type":"output","id":"bFICW9_D7xm3fs8WDQ3gK","data":[],"key":"AssTv7KMkA"}],"key":"saNYIJ9pvH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d3c1UOU4Q6"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lqhFbeuodG"}],"identifier":"determine-the-bearing-via-python-package-pyproj","label":"Determine the Bearing via Python Package pyproj","html_id":"determine-the-bearing-via-python-package-pyproj","implicit":true,"key":"sZnpiFeUFF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eSHsqVvtqw"},{"type":"text","value":" can also use the same ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TnjRT6zbi3"},{"type":"inlineCode","value":"geodesic.inv()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RIOIFIeHpU"},{"type":"text","value":" function to calculate bearing. However, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IBzqtUh1TM"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U8Cfe6Esnb"},{"type":"text","value":" includes both the foward and reverse bearing. Foward bearing refers to the bearing from Point A to Point B, while the reverse bearing is the bearing from Point B to Point A. The reverse bearing is returned as a negative angle, but it can also be calculated as the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h5Vxh1rKGJ"},{"type":"inlineCode","value":"Forward Bearing - 360","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T2Vy4GJ8v5"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LmPNith634"}],"key":"RNHGlZJJPr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For example, to find the bearing from Boulder and Boston:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OtytAusDXq"}],"key":"RGp0ZqDqfY"}],"key":"RI74erLnHc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geodesic = Geod(ellps=\"WGS84\")\nfwd_bearing, rvs_bearing, _ =  geodesic.inv(location_df.loc[\"boulder\", \"longitude\"],\n                                             location_df.loc[\"boulder\", \"latitude\"],\n                                             location_df.loc[\"boston\", \"longitude\"],\n                                             location_df.loc[\"boston\", \"latitude\"])\nprint(f\"Foward Bearing: {fwd_bearing}\")\nprint(f\"Reverse Bearing: {rvs_bearing} ({rvs_bearing%360})\")","key":"kBYFuDlKeU"},{"type":"output","id":"Q63r-FlaUjjcPvzMhDFbX","data":[{"output_type":"stream","name":"stdout","text":"Foward Bearing: 73.51048829569022\nReverse Bearing: -83.57035585674933 (276.4296441432507)\n"}],"key":"PovEtt3V80"}],"key":"V5zIoW0Ilq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When refering to bearing however, it is typically assumed to be refering to the foward bearing, so we will use the function below as we move foward.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eCva1aAnOp"}],"key":"Ucj8RRaWxC"}],"key":"jP9GU6nxix"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def bearing_between_points_ellps(start_point=None, end_point=None):\n    geodesic = Geod(ellps=\"WGS84\")\n    fwd_bearing, _, _ =  geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                        location_df.loc[start_point, \"latitude\"],\n                                        location_df.loc[end_point, \"longitude\"],\n                                        location_df.loc[end_point, \"latitude\"])\n    return fwd_bearing","key":"eQD8dhgkVT"},{"type":"output","id":"Brdhx6qatCzKOFHiC7V9q","data":[],"key":"vwnJVWznq6"}],"key":"T5hxrMJvlV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because of the slightly flattened shape of an ellipsoid compared to a sphere, the bearing can also vary depending on if you are calculating bearing on a unit sphere or a ellipsoid:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C1m6j82utw"}],"key":"zY0vfrfab4"}],"key":"RiVoadxNga"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Compare Unit Sphere and Ellipsoid\nbeaing_ellps = bearing_between_points_ellps(\"boulder\", \"boston\")\nprint(f\"forward bearing between coordinates (ellipsoid)   = {beaing_ellps} Degrees\")\nbearing_us = bearing_between_points_unit_sphere(\"boulder\", \"boston\")\nprint(f\"forward bearing between coordinates (unit sphere) = {bearing_us} Degrees\")","key":"pdlVqLytkM"},{"type":"output","id":"yJgB2atrwopm6BlVlst7O","data":[{"output_type":"stream","name":"stdout","text":"forward bearing between coordinates (ellipsoid)   = 73.51048829569022 Degrees\nforward bearing between coordinates (unit sphere) = 73.49180375272644 Degrees\n"}],"key":"n9uSkL9mH7"}],"key":"LyShgpRfJt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generating a Great Circle Arc with Intermediates Points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qJTcDp1jKM"}],"identifier":"generating-a-great-circle-arc-with-intermediates-points","label":"Generating a Great Circle Arc with Intermediates Points","html_id":"generating-a-great-circle-arc-with-intermediates-points","implicit":true,"key":"vNTKMhpgvI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we have calculated both the length of a great circle arc as well as its bearing. Now we can begin to add additional points along the arc. These intermediate points will lie along the great circle arc and can be calculated as the fractional distance laong the arc (for example, a point for every 10th of the arc).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AZikVD1M0u"}],"key":"rBMgYhFPKk"}],"key":"MWlxRUU3rL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Intermediate Points Mathemetically via Unit Sphere (Fractional Distance)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xY7gDsAKTl"}],"identifier":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","label":"Determine Intermediate Points Mathemetically via Unit Sphere (Fractional Distance)","html_id":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","implicit":true,"key":"xhgRVwFKhT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Along a unit sphere, we can calculate each intermediate point as a fractional distance along the arc. We can determine the points as a given fraction of a distance (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UJCUlEIAUp"},{"type":"inlineCode","value":"d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k5EzOeYnCh"},{"type":"text","value":") between a starting points A (latA, lonA) and the final point B (latB, lonB) where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LIrPQCQRQD"},{"type":"inlineCode","value":"f","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UPv2XxagK7"},{"type":"text","value":" is a fraction along the great circle arc. As a result, Point A is at","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gFRNyHOKAk"},{"type":"inlineCode","value":"f=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dpuk89ZUMF"},{"type":"text","value":" and Point B sits at","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s3QAs1Zc0A"},{"type":"inlineCode","value":"f=1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XjBmuSxr3O"},{"type":"text","value":" along the arc.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rDGRDilT5k"}],"key":"AfBJxmsMIM"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: The points must not lie on exact opposite sides of a sphere (antipodal), otherwise, the path is undefined because f=0=1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qd4loALi6i"}],"key":"Cqb6JWO2G9"}],"key":"yE4DzVkcEo"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Where, antipodal is defined by:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"X6ldma98ab"}],"key":"VIs1GLAybO"},{"type":"math","value":"latA + latB = 0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo>+</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">latA + latB = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"12","key":"fB0WmgPBPI"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JEwMabsIKi"}],"key":"j9VA1wqfG1"},{"type":"math","value":"abs(lonA - lonB) = pi","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mi>b</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">abs(lonA - lonB) = pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">i</span></span></span></span></span>","enumerator":"13","key":"XTVDJziteR"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Where the distance between two points is the angular distance:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xoQRIPGnnd"}],"key":"yE7X9FT9x2"},{"type":"math","value":"d = \\frac{\\text{total distance of arc}}{\\text{earth's radius}}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mfrac><mtext>total distance of arc</mtext><mtext>earth’s radius</mtext></mfrac></mrow><annotation encoding=\"application/x-tex\">d = \\frac{\\text{total distance of arc}}{\\text{earth&#x27;s radius}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">earth’s radius</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">total distance of arc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"14","key":"TZdV54P2q7"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The intermediate points (lat, lon) along a given path starting point to end point:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"buxiEyAqfR"}],"key":"QrXMyNcoid"},{"type":"math","value":"A = sin(\\frac{(1-f) * d}{sin(d)}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>d</mi></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">A = sin(\\frac{(1-f) * d}{sin(d)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"15","key":"SKuzi7wL6w"},{"type":"math","value":"B = \\frac{sin(f*d)}{sin(d)}","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo>∗</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">B = \\frac{sin(f*d)}{sin(d)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"16","key":"X5Unt28Q2U"},{"type":"math","value":"x = A * cos(latA) * cos(lonA) + B * cos(latB) * cos(lonB)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = A * cos(latA) * cos(lonA) + B * cos(latB) * cos(lonB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"17","key":"dTRF60duTh"},{"type":"math","value":"y = A * cos(latA) * sin(lonA) + B * cos(latB) * sin(lonB)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = A * cos(latA) * sin(lonA) + B * cos(latB) * sin(lonB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"18","key":"ing97mLJoz"},{"type":"math","value":"z = A * sin(latA) + B * sin(latB)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>z</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">z = A * sin(latA) + B * sin(latB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"19","key":"lSFaC6c8PW"},{"type":"math","value":"lat = atan2(z, \\sqrt{x^2 + y^2})","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>z</mi><mo separator=\"true\">,</mo><msqrt><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">lat = atan2(z, \\sqrt{x^2 + y^2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2567em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0067em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.9667em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2333em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"20","key":"yvWMJ87mBi"},{"type":"math","value":"lon = atan2(y, x)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">lon = atan2(y, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"21","key":"LdpcSb4Dvg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Intermediate","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Ed Williams: Intermediate Points on a Great Circle","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ugu7IlnRIc"}],"urlSource":"https://edwilliams.org/avform147.htm#Intermediate","key":"hdmCuiOyNf"}],"key":"aoos3sBiv8"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html#intermediate-point","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Moveable Type: Intermediate Point","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"GvUhoHnDbG"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html#intermediate-point","key":"EZR0czUmLr"}],"key":"rdHLIudkSU"}],"key":"DbfRCP4Qii"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Let’s translate this math into Python code:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"HWHsUNgzlm"}],"key":"ZNTnapXG2C"}],"key":"GZETcZEtuW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def intermediate_points(start_point=None, end_point=None,\n                        fraction=None, distance=None):\n    # Calculates the position of an intermediate point based on its fractional position along an arc defined from Point A to Point B\n    earth_radius = 6378137  # meters\n    total_distance = distance / earth_radius\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    A = np.sin((1-fraction) * total_distance) / np.sin(total_distance)\n    B = np.sin(fraction * total_distance) / np.sin(total_distance)\n    x = (A * np.cos(latA) * np.cos(lonA)) + (B * np.cos(latB) * np.cos(lonB))\n    y = (A * np.cos(latA) * np.sin(lonA)) + (B * np.cos(latB) * np.sin(lonB))\n    z = (A * np.sin(latA)) + (B * np.sin(latB))\n    lat = np.arctan2(z, np.sqrt(x**2 + y**2))\n    lon = np.arctan2(y, x)\n    return (np.rad2deg(lat), np.rad2deg(lon))\n\ndef calculate_intermediate_pts(start_point=None, end_point=None,\n                               fraction=None, total_distance_meter=None):\n    # returns a list of intermediate points along the arc seperated by a specific fraction\n    fractions = np.arange(0, 1+fraction, fraction)\n    intermediate_lat_lon = []\n    for fractional in fractions:\n        intermediate_pts = intermediate_points(start_point, end_point,\n                                                fractional, total_distance_meter)\n        intermediate_lat_lon.append(intermediate_pts)\n    return intermediate_lat_lon","key":"S4ehAjlmBZ"},{"type":"output","id":"AtKYOyx7CR0TuiPbCIfjK","data":[],"key":"Ifqtj4AXEE"}],"key":"ZxmR6jN7KS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Intermediate Points via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hV3r1ZZf3c"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bI4MYjGQdW"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v2VHocPD0Q"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZNbVZZO75q"}],"identifier":"determine-intermediate-points-via-python-package-pyproj-and-geopy","label":"Determine Intermediate Points via Python Package pyproj and geopy","html_id":"determine-intermediate-points-via-python-package-pyproj-and-geopy","implicit":true,"key":"B8vT6To5ME"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"However, there is a strong advantage when you the Python libraries ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yNalDeugDm"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xgGPeDtC24"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sblUkvzR41"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Im9iCI6Mtl"},{"type":"text","value":". Not only can you use an ellipsoid instead of a sphere, you can also interpolate points along an arc in additional ways:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ObW7N8lyvR"}],"key":"cPsout3rpW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A fractional distance laong the arc (for example, a point for every 10th of the arc)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zHod6aSzUz"}],"key":"SITiu2ARUL"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A known distance along the arc (for example, a point ever 100 meters)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zh7GUMmDDt"}],"key":"G2At1ioRHq"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"An equal amount of points (for example, adding 6 intermediate points which are equally spaced along the arc)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qERhskwKKM"}],"key":"AGKubjsRuT"}],"key":"D1CRn3ELbO"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Below you will see how we can use one function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"c16lDCRsrT"},{"type":"inlineCode","value":"interpolate_points_along_gc","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bW25DqKChy"},{"type":"text","value":" to be able to solve for all three possible types of intermediate points. The function will use both the starting and ending coordinates (Point A to Point B) and a distance you’d like to have between each point.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rZawv28cDM"}],"key":"LzCbJg0ai4"}],"key":"p1Mj090tNO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def interpolate_points_along_gc(lat_start,\n                                lon_start,\n                                lat_end,\n                                lon_end,\n                                distance_between_points_meter): \n    # Interpolate intermediate points along an arc wtih a given distance between each point\n    lat_lon_points = [(lat_start, lon_start)]\n    \n    # move to next point when distance between points is less than the equal distance\n    move_to_next_point = True\n    while(move_to_next_point):\n        forward_bearing, _, distance_meters = geodesic.inv(lon_start,\n                                                            lat_start, \n                                                            lon_end,\n                                                            lat_end)\n        if distance_meters < distance_between_points_meter:\n            # ends before overshooting\n            move_to_next_point = False\n        else:\n            start_point = geopy.Point(lat_start, lon_start)\n            distance_to_move = geopy.distance.distance(\n                            kilometers=distance_between_points_meter /\n                            1000)  # distance to move towards the next point\n            final_position = distance_to_move.destination(\n                            start_point, bearing=forward_bearing)\n            lat_lon_points.append((final_position.latitude, final_position.longitude))\n            # new starting position is newly found end position\n            lon_start, lat_start = final_position.longitude, final_position.latitude\n    lat_lon_points.append((lat_end, lon_end))\n    return lat_lon_points","key":"ZkwVIIugW7"},{"type":"output","id":"gtW7NdcU5Yfl8QNBAlyuL","data":[],"key":"mNf856sRid"}],"key":"LhFON8r6Km"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot Arcs as Points on a World Map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kaaKo7KDx1"}],"identifier":"plot-arcs-as-points-on-a-world-map","label":"Plot Arcs as Points on a World Map","html_id":"plot-arcs-as-points-on-a-world-map","implicit":true,"key":"F0hrBw00FW"}],"key":"vJXyxx526h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom cartopy import crs as ccrs, feature as cfeature\n\ndef plot_coordinate(lst_of_coords=None, title=None):\n    # Set up world map plot on the United States\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -130, -60, 20, 60\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.STATES, edgecolor=\"black\")\n    \n    # Plot Latitude/Longitude Location\n    longitudes = [x[1] for x in lst_of_coords] # longitude\n    latitudes = [x[0] for x in lst_of_coords] # latitude\n    plt.plot(longitudes, latitudes)\n    plt.scatter(longitudes, latitudes)\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(title)\n    plt.show()","key":"dFkMdjYXJO"},{"type":"output","id":"I-IW2-e2mlUADla5tTEsh","data":[],"key":"ASwWEPxHBK"}],"key":"nulgulCsPA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate with N Total Equally Spaced Points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IKmZC4fP7k"}],"identifier":"interpolate-with-n-total-equally-spaced-points","label":"Interpolate with N Total Equally Spaced Points","html_id":"interpolate-with-n-total-equally-spaced-points","implicit":true,"key":"dSPseZelJ3"}],"key":"MGfHr2VCn6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_total_points = 10 # total points (n points)\ndistance_between_points_meter = distance_meter / (n_total_points + 1)\nprint(f\"Each point will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"HhVJANjLBd"},{"type":"output","id":"Y4XlrGY8TVyO9zhDhzgVY","data":[{"output_type":"stream","name":"stdout","text":"Each point will be separated by 260236.13453768377 meters (260.23613453768377 km)\n"}],"key":"CHOjnHsdO7"}],"key":"U2F8IVl14t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[[\"boulder\"]][\"latitude\"].iloc[0], location_df.loc[[\"boulder\"]][\"longitude\"].iloc[0]\nlat_end, lon_end = location_df.loc[[\"boston\"]][\"latitude\"].iloc[0], location_df.loc[[\"boston\"]][\"longitude\"].iloc[0]\n\nintermediate_geodesic = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(intermediate_geodesic)} Total Points\")\nintermediate_geodesic","key":"LXDXc93M44"},{"type":"output","id":"yWd5eR4EDR_8R6N3juako","data":[{"output_type":"stream","name":"stdout","text":"12 Total Points\n"},{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"[(np.float64(40.015), np.float64(-105.2705)),\n (40.64283438472448, -102.32002071588883),\n (41.19386139956729, -99.31719425393653),\n (41.665293789240074, -96.2672998277903),\n (42.05464865958041, -93.17653047007545),\n (42.35980367525435, -90.05192021556942),\n (42.579048241302566, -86.9012334462751),\n (42.71112689737456, -83.73281874084786),\n (42.75527239726804, -80.5554326250441),\n (42.711226442193585, -77.37804142647055),\n (42.579246749547636, -74.20961159223961),\n (np.float64(42.3601), np.float64(-71.0589))]","content_type":"text/plain"}}}],"key":"uRPskQR3il"}],"key":"nTcPCxolCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(intermediate_geodesic,\n                title=f\"Interpolate {n_total_points} Points\")","key":"TZb5rc6FQy"},{"type":"output","id":"V1wgzabBH4Qxii3eibSE0","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a11fc5746ac81c24b18cf1ed49c2d96a","path":"/great-circle-cookbook/_preview/7/build/a11fc5746ac81c24b18cf1ed49c2d96a.png"}}}],"key":"mbnpOTuH84"}],"key":"zj3KHrqAtz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate every N meters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B9VBXa7J8j"}],"identifier":"interpolate-every-n-meters","label":"Interpolate every N meters","html_id":"interpolate-every-n-meters","implicit":true,"key":"wppaJWCBkj"}],"key":"IHXzHPY68U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_between_points_meter = 112000\nprint(f\"Each point will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"gXCXGXG1uj"},{"type":"output","id":"7dArimUPuUb62rRAqYigE","data":[{"output_type":"stream","name":"stdout","text":"Each point will be separated by 112000 meters (112.0 km)\n"}],"key":"MNua11tmIs"}],"key":"R9TlPG6g0m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\nintermediate_geodesic = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(intermediate_geodesic)} Total Points\")\nintermediate_geodesic","key":"BEjukqliOv"},{"type":"output","id":"NXw0TZvJQ7vvpVJkU_ZdY","data":[{"output_type":"stream","name":"stdout","text":"27 Total Points\n"},{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"[(np.float64(40.015), np.float64(-105.2705)),\n (40.29443152420481, -104.00739372929635),\n (40.55994883031889, -102.73410083358552),\n (40.811312209497714, -101.45097760323463),\n (41.04829010633232, -100.15841313140038),\n (41.27065999040772, -98.8568290209118),\n (41.47820922569627, -97.54667886388195),\n (41.67073593071231, -96.22844748540258),\n (41.848049822017195, -94.90264994540797),\n (42.00997303342117, -93.56983029584387),\n (42.156340903095064, -92.23056009359964),\n (42.287002720790326, -90.88543667319323),\n (42.40182242747838, -89.53508118686946),\n (42.50067925996674, -88.1801364234981),\n (42.583468333429785, -86.82126442135142),\n (42.65010115530707, -85.45914389340653),\n (42.700506064664665, -84.09446748716023),\n (42.73462859187762, -82.72793890397021),\n (42.75243173435998, -81.36026990555973),\n (42.75389614502746, -79.99217723746453),\n (42.73902023120852, -78.62437950079696),\n (42.707820162798164, -77.25759400470386),\n (42.66032978955507, -75.89253363227026),\n (42.596600468550456, -74.52990375235937),\n (42.51670080386281, -73.1703992089883),\n (42.42071630165334, -71.81470141834599),\n (np.float64(42.3601), np.float64(-71.0589))]","content_type":"text/plain"}}}],"key":"kNKlWfKNXg"}],"key":"dBuaneXJID"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(intermediate_geodesic,\n                title=f\"Interpolate every {distance_between_points_meter/1000} km\")","key":"I0s8ybQIij"},{"type":"output","id":"nEDkIMeUmj1A2lKsa0-Rb","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"28737e9a3d0aaf334d562b6aa52a1b8e","path":"/great-circle-cookbook/_preview/7/build/28737e9a3d0aaf334d562b6aa52a1b8e.png"}}}],"key":"knpKcc7erg"}],"key":"q7GrngTau0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate a fractional distance along arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GHU5OWDstZ"}],"identifier":"interpolate-a-fractional-distance-along-arc","label":"Interpolate a fractional distance along arc","html_id":"interpolate-a-fractional-distance-along-arc","implicit":true,"key":"keGRr132kt"}],"key":"x72zahquMv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fraction = 1/10","key":"uvlYyGao9a"},{"type":"output","id":"xL5ftRDKSAsHDNshnJ6F5","data":[],"key":"Gf9GTp40L1"}],"key":"fqIVaIBPqn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_between_points_meter = fraction * distance_meter\nprint(f\"Each point will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"YZ9GeexFbq"},{"type":"output","id":"o7_zCIFyNgrcbhrfB5to4","data":[{"output_type":"stream","name":"stdout","text":"Each point will be separated by 286259.74799145217 meters (286.2597479914522 km)\n"}],"key":"xfSIw1Uyb4"}],"key":"RhVsNh2GSy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\nintermediate_ellipsoid = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(intermediate_ellipsoid)} Total Points\")\nintermediate_ellipsoid","key":"PszGVJsilP"},{"type":"output","id":"s64adZoeBr2vjjLsSmWCc","data":[{"output_type":"stream","name":"stdout","text":"11 Total Points\n"},{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"[(np.float64(40.015), np.float64(-105.2705)),\n (40.70144152851926, -102.0220139666611),\n (41.29459964930597, -98.7107954391427),\n (41.790822409112124, -95.34405626799516),\n (42.18692017366623, -91.93032741511365),\n (42.4802543416051, -88.47932636547252),\n (42.66881568690329, -85.00175846666659),\n (42.75128706952139, -81.50905885116296),\n (42.72708599453554, -78.01308797522954),\n (42.59638380227174, -74.52579917182065),\n (np.float64(42.3601), np.float64(-71.0589))]","content_type":"text/plain"}}}],"key":"nUv019ROXk"}],"key":"kbUktBEd4E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(intermediate_ellipsoid,\n                title=f\"(Ellipsoid) Interpolate on Fraction {fraction}\")","key":"FGSbTL6vIn"},{"type":"output","id":"MlrDLoDLgAls9v7AH9XLT","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e80f4098f658d112c319643655dea3f1","path":"/great-circle-cookbook/_preview/7/build/e80f4098f658d112c319643655dea3f1.png"}}}],"key":"RZKdIpTbI3"}],"key":"l7FRjMgB8x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nintermediate_unit_sphere = calculate_intermediate_pts(\"boulder\", \"boston\",\n                                               fraction, distance_unit_sphere_default)\nprint(f\"{len(intermediate_unit_sphere)} Total Points\")\nintermediate_unit_sphere","key":"w8uIM611i9"},{"type":"output","id":"BbU0LosAPJKA6UOPBhxGB","data":[{"output_type":"stream","name":"stdout","text":"11 Total Points\n"},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"[(np.float64(40.015), np.float64(-105.2705)),\n (np.float64(40.69956840796515), np.float64(-102.0224051615289)),\n (np.float64(41.291305596308824), np.float64(-98.71150732723615)),\n (np.float64(41.786544424077), np.float64(-95.3450112546059)),\n (np.float64(42.1820804843035), np.float64(-91.93144054027105)),\n (np.float64(42.475261312703864), np.float64(-88.48050569778584)),\n (np.float64(42.66406520473303), np.float64(-85.00290620334833)),\n (np.float64(42.74716436193266), np.float64(-81.51007310432796)),\n (np.float64(42.723967826794556), np.float64(-78.01386515980239)),\n (np.float64(42.59464096704978), np.float64(-74.52623685097386)),\n (np.float64(42.3601), np.float64(-71.0589))]","content_type":"text/plain"}}}],"key":"QyI7QmibVY"}],"key":"qHvkJP4CTm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(intermediate_unit_sphere,\n                title=f\"(Unit Sphere) Interpolate on Fraction {fraction}\")","key":"Ed2OrYhm3z"},{"type":"output","id":"f1DJqsjunJSE2y1ge8-SM","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"27b547f6fbb9d97278bb174a042ab8a1","path":"/great-circle-cookbook/_preview/7/build/27b547f6fbb9d97278bb174a042ab8a1.png"}}}],"key":"HeaR77PE0y"}],"key":"DzGjwUETgD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# compare math and geodesic outputs\nfor i in range(len(intermediate_ellipsoid)):\n    _, _, distance_m = geodesic.inv(intermediate_ellipsoid[i][0], intermediate_ellipsoid[i][1],\n                                   intermediate_unit_sphere[i][0], intermediate_unit_sphere[i][1])\n    if np.isnan(distance_m): distance_m = 0\n    print(f\"Distance between ellipsoid/unit sphere defined point {i}: {distance_m} meters\")","key":"ZVoEoHdxdX"},{"type":"output","id":"KYA-VAF3pxarkccd-ykNA","data":[{"output_type":"stream","name":"stdout","text":"Distance between ellipsoid/unit sphere defined point 0: 0 meters\nDistance between ellipsoid/unit sphere defined point 1: 0 meters\nDistance between ellipsoid/unit sphere defined point 2: 0 meters\nDistance between ellipsoid/unit sphere defined point 3: 0 meters\nDistance between ellipsoid/unit sphere defined point 4: 0 meters\nDistance between ellipsoid/unit sphere defined point 5: 132.55154860348821 meters\nDistance between ellipsoid/unit sphere defined point 6: 136.26443374199349 meters\nDistance between ellipsoid/unit sphere defined point 7: 132.0972186842191 meters\nDistance between ellipsoid/unit sphere defined point 8: 112.95654352480192 meters\nDistance between ellipsoid/unit sphere defined point 9: 71.29186326482345 meters\nDistance between ellipsoid/unit sphere defined point 10: 0.0 meters\n"}],"key":"KHawVrgcAi"}],"key":"RkWvb8QxPd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Midpoint of a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nQYSWwdgL7"}],"identifier":"determine-the-midpoint-of-a-great-circle-arc","label":"Determine the Midpoint of a Great Circle Arc","html_id":"determine-the-midpoint-of-a-great-circle-arc","implicit":true,"key":"cpV74Kb3Iw"}],"key":"b3eviuNIw1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The midpoint of an arc can be determiend as a fractional distance along an arc where f = 0.5.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UuqoRWcthw"}],"key":"hfSPQzER47"}],"key":"bbl3BHq62X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"midpoint = distance_meter / 2\nlat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\nintermediate_geodesic = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          midpoint)\nprint(f\"{len(intermediate_geodesic)} Total Points\")\nprint(intermediate_geodesic)\nprint(f\"Midpoint = {intermediate_geodesic[1]}\")","key":"PALpCJiviL"},{"type":"output","id":"9h4E5l2RosWg1ZWlqXD8R","data":[{"output_type":"stream","name":"stdout","text":"3 Total Points\n[(np.float64(40.015), np.float64(-105.2705)), (42.48025434160511, -88.4793263654725), (np.float64(42.3601), np.float64(-71.0589))]\nMidpoint = (42.48025434160511, -88.4793263654725)\n"}],"key":"OXRFe71nlR"}],"key":"icWxHHxffS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nintermediate_unit_sphere = calculate_intermediate_pts(\"boulder\", \"boston\",\n                                               1/2, distance_unit_sphere_default)\nprint(f\"{len(intermediate_unit_sphere)} Total Points\")\nprint(intermediate_unit_sphere)\nprint(f\"Midpoint = {intermediate_unit_sphere[1]}\")","key":"ePT0d7Qgn1"},{"type":"output","id":"KX5hAClIC6_hGODIIDkX1","data":[{"output_type":"stream","name":"stdout","text":"3 Total Points\n[(np.float64(40.015), np.float64(-105.2705)), (np.float64(42.475261312703864), np.float64(-88.48050569778584)), (np.float64(42.3601), np.float64(-71.0589))]\nMidpoint = (np.float64(42.475261312703864), np.float64(-88.48050569778584))\n"}],"key":"pAQoZagsP1"}],"key":"E4GQKlPgUf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compare geodesic and unit sphere\n_, _, distance_m = geodesic.inv(intermediate_geodesic[1][0], intermediate_geodesic[1][1],\n                                   intermediate_unit_sphere[1][0], intermediate_unit_sphere[1][1])\nprint(f\"Distance between geodesic/unint sphere defined midpoint = {distance_m} meters\")","key":"BsIsjYESv0"},{"type":"output","id":"Y6ivJiOKFLMZsqEiAXgAs","data":[{"output_type":"stream","name":"stdout","text":"Distance between geodesic/unint sphere defined midpoint = 132.55154860505925 meters\n"}],"key":"LaxH3r5sw8"}],"key":"Q7HsNMqNZ2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rvN0ZQifgs"}],"identifier":"generate-a-great-circle-path","label":"Generate a Great Circle Path","html_id":"generate-a-great-circle-path","implicit":true,"key":"dsNpuNNBVs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Generate points along a great circle path bewtween two points.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P543EJZVV3"}],"key":"o2StMTfotK"}],"key":"DWLTynWN4X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate Latitude Coordinates based on Longitude Coordinates\ndef generate_latitude_along_gc(start_point=None, end_point=None, number_of_lon_pts=360):\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    # Verify not meridian (longitude passes through the poles)\n    if np.sin(lon1 - lon2) == 0:\n        print(\"Invalid inputs: start/end points are meridians\")\n        # plotting meridians at 0 longitude through all latitudes\n        meridian_lat = np.arange(-90, 90, 180/len(longitude_lst)) # split in n number\n        meridians = []\n        for lat in meridian_lat:\n            meridians.append((lat, 0))\n        return meridians\n\n    # verify not anitpodal (diametrically opposite, points)\n    if lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi:\n        print(\"Invalid inputs: start/end points are antipodal\")\n        return []\n\n    # note: can be expanded to handle input of np arrays by filter out antipodal/merdiain points\n\n    # generate n total number of longitude points along the great circle\n    # https://github.com/rspatial/geosphere/blob/master/R/greatCircle.R#L18C3-L18C7\n    gc_lon_lst = []\n    for lon in range(1, number_of_lon_pts+1):\n        new_lon = (lon  * (360/number_of_lon_pts) - 180)\n        gc_lon_lst.append(np.deg2rad(new_lon))\n\n    # Intermediate points on a great circle: https://edwilliams.org/avform147.htm\"\n    gc_lat_lon = []\n    for gc_lon in gc_lon_lst:\n        num = np.sin(lat1)*np.cos(lat2)*np.sin(gc_lon-lon2)-np.sin(lat2)*np.cos(lat1)*np.sin(gc_lon-lon1)\n        den = np.cos(lat1)*np.cos(lat2)*np.sin(lon1-lon2)\n        new_lat = np.arctan(num/den)\n        gc_lat_lon.append((np.rad2deg(new_lat), np.rad2deg(gc_lon)))\n    return gc_lat_lon","key":"AtXLHNzUs3"},{"type":"output","id":"UkDuKgM9__SL6tIgStEbR","data":[],"key":"uCvcbN6S2y"}],"key":"ac3qRoPElo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def arc_points(start_lat=None,\n               start_lon=None,\n               end_lat=None,\n               end_lon=None,\n               n_total_points=10):\n    _, _, distance_meter =  geodesic.inv(start_lon,\n                                        start_lat,\n                                        end_lon,\n                                        end_lat)\n        \n    distance_between_points_meter = distance_meter / (n_total_points + 1)\n\n    \n    points_along_arc = interpolate_points_along_gc(start_lat,\n                                              start_lon,\n                                              end_lat,\n                                              end_lon,\n                                              distance_between_points_meter)\n    return points_along_arc","key":"DnXYUk1KBg"},{"type":"output","id":"Dai2PspO1xIggwCji_VSL","data":[],"key":"YlVDrzcBaA"}],"key":"L8faTTDyQ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_coordinate(lat_lon_lst=None,\n                    start_point=None, end_point=None,\n                    title=None):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -180, 180, -90, 90\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.BORDERS, edgecolor='grey')\n    ax.add_feature(cfeature.STATES, edgecolor=\"grey\")\n        \n    # Plot Latitude/Longitude Location of great circle path\n    longitudes = [x[1] for x in lat_lon_lst] # longitude\n    latitudes = [x[0] for x in lat_lon_lst] # latitude\n    plt.plot(longitudes, latitudes, c=\"cornflowerblue\")\n    plt.scatter(longitudes, latitudes, c=\"cornflowerblue\")\n\n    # Overly great circle with arc rom start/end point\n    start_end_lat_lon = arc_points(location_df.loc[start_point, \"latitude\"],\n                                   location_df.loc[start_point, \"longitude\"],\n                                   location_df.loc[end_point, \"latitude\"],\n                                   location_df.loc[end_point, \"longitude\"],\n                                   n_total_points=20)\n    longitudes = [x[1] for x in start_end_lat_lon] # longitude\n    latitudes = [x[0] for x in start_end_lat_lon] # latitude\n    plt.plot(longitudes, latitudes, c=\"red\")\n    plt.scatter(longitudes, latitudes, c=\"red\")\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(title)\n    plt.show()","key":"L4sqWRhv4y"},{"type":"output","id":"7osQiNnmzoXc76gefLYvu","data":[],"key":"ThcdiBjjoR"}],"key":"GmxJdBrsF4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"boulder\"\nend_pt = \"boston\"\nn_pts = 360\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"nB94JU3Guy"},{"type":"output","id":"G9SA-KU48SZOcG51XZPB_","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a29e75aafa9affc652963ab64f6c565e","path":"/great-circle-cookbook/_preview/7/build/a29e75aafa9affc652963ab64f6c565e.png"}}}],"key":"M1wGpyBwa2"}],"key":"MeuNFMvCdz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"arecibo\"\nend_pt = \"greenwich\"\nn_pts = 360\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"ksqDTZC9kD"},{"type":"output","id":"uJFGscpMphDLdssdnHbSG","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"17bb48a6fdb124f7de536f4ee890e9b3","path":"/great-circle-cookbook/_preview/7/build/17bb48a6fdb124f7de536f4ee890e9b3.png"}}}],"key":"J2D1NfOeUU"}],"key":"mBK45jL8F6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"zambezi\"\nend_pt = \"svalbard\"\nn_pts = 360\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"Aa0ekfqBIv"},{"type":"output","id":"jPuw5hND-iVMtJl6HJeri","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"237b16bae3645b56d40e37286c66752b","path":"/great-circle-cookbook/_preview/7/build/237b16bae3645b56d40e37286c66752b.png"}}}],"key":"tptKo1FsqK"}],"key":"dy4Bd65jVG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine an Antipodal Point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uh03ChBETn"}],"identifier":"determine-an-antipodal-point","label":"Determine an Antipodal Point","html_id":"determine-an-antipodal-point","implicit":true,"key":"yMmCCYgB5M"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Antipodal is the point on the globe that is on the exact opposite side of the Earth.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qPRJSrX8zR"}],"key":"baQ8z1lWIS"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Antipodal latitude is defined as:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xyuImsxNS5"}],"key":"SekXOFhCIu"},{"type":"math","value":"\\text{antipodal latitude} = -1 * \\text{latitude}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>antipodal latitude</mtext><mo>=</mo><mo>−</mo><mn>1</mn><mo>∗</mo><mtext>latitude</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{antipodal latitude} = -1 * \\text{latitude}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">antipodal latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">latitude</span></span></span></span></span></span>","enumerator":"22","key":"g7HO0hvzyr"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Antipodal longitude is defined as:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jpJRxDCa7Y"}],"key":"NAHmoHuBZq"},{"type":"math","value":"\\text{anitpodal longitude} = (\\text{longitude} + 180) \\text{ if longitude} \\le 0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>anitpodal longitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>longitude</mtext><mo>+</mo><mn>180</mn><mo stretchy=\"false\">)</mo><mtext> if longitude</mtext><mo>≤</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\text{anitpodal longitude} = (\\text{longitude} + 180) \\text{ if longitude} \\le 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">anitpodal longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">180</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> if longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"23","key":"uNtKAfKTwc"},{"type":"math","value":"\\text{anitpodal longitude} = (\\text{longitude} - 180) \\text{ if longitude} \\gt 0","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>anitpodal longitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>longitude</mtext><mo>−</mo><mn>180</mn><mo stretchy=\"false\">)</mo><mtext> if longitude</mtext><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\text{anitpodal longitude} = (\\text{longitude} - 180) \\text{ if longitude} \\gt 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">anitpodal longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">180</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> if longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"24","key":"sAjbaV1k4f"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://www.antipodesmap.com/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Antipodes Map","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"QtWAQhgZPj"}],"urlSource":"https://www.antipodesmap.com/","key":"iYp0nyD92E"}],"key":"TghgdfMDlf"}],"key":"kbHzGhZwzX"}],"key":"km4NmcxZi3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def antipodal(start_point=None):\n    anti_lat = -1 * location_df.loc[start_point, \"latitude\"]\n    ref_lon = location_df.loc[start_point, \"longitude\"]\n    if ref_lon > 0:\n        anti_lon = ref_lon - 180\n    else:\n        anti_lon = ref_lon + 180\n    #if anti_lon >= 180:\n    #    anti_lon = -1 * (anti_lon % 180)\n    return (anti_lat, anti_lon)","key":"XscVPUnQdz"},{"type":"output","id":"nHAOsseW4EEhI2ZxGsAvK","data":[],"key":"ukR4PSJXCX"}],"key":"wykQYTE4md"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def is_antipodal(start_point=None, end_point=None):\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    return lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi","key":"F7XHXo1KFx"},{"type":"output","id":"9PaD-t8XuRGFS9CUPGTXx","data":[],"key":"R2Z5Ehad3S"}],"key":"cOTfkxqUEV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_antipodal(start_point=None):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -180, 180, -90, 90\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.BORDERS, edgecolor='grey')\n    ax.add_feature(cfeature.STATES, edgecolor=\"grey\")\n        \n    # Plot Start point\n    plt.scatter(location_df.loc[start_point, \"longitude\"],\n                location_df.loc[start_point, \"latitude\"],\n                s=100, c=\"cornflowerblue\", label=start_point.title())\n\n    # Plot Antipodal Point\n    antipodal_point = antipodal(start_point)\n    plt.scatter(antipodal_point[1], antipodal_point[0], s=100, c=\"red\", label=\"Antipodal\")\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(f\"{start_point.title()} and Antipodal Point {antipodal_point}\")\n    plt.legend(loc=\"lower right\")\n    plt.show()","key":"Cw3DxxMeQk"},{"type":"output","id":"Y_Hw3nrTfsN7VxwNGC--U","data":[],"key":"M9nSr3aip4"}],"key":"eXMSS2PlGB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(antipodal(\"boulder\"))\nplot_antipodal(\"boulder\")","key":"lmKlsIF0v2"},{"type":"output","id":"_PndrJOeDhA-WdpmIMLHn","data":[{"output_type":"stream","name":"stdout","text":"(np.float64(-40.015), np.float64(74.7295))\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4a11e6e1f88f0f30ac8c259d7112a2cd","path":"/great-circle-cookbook/_preview/7/build/4a11e6e1f88f0f30ac8c259d7112a2cd.png"}}}],"key":"Na3tnZ1LFH"}],"key":"BTIf4GPS1T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(antipodal(\"svalbard\"))\nplot_antipodal(\"svalbard\")","key":"MgDAqqIze8"},{"type":"output","id":"SS-4oQu6Fm7lW2JqEYdbS","data":[{"output_type":"stream","name":"stdout","text":"(np.float64(-77.875), np.float64(-159.0248))\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0f825fab16b0230557b0bd35d6b60f03","path":"/great-circle-cookbook/_preview/7/build/0f825fab16b0230557b0bd35d6b60f03.png"}}}],"key":"uR4IMJHFS3"}],"key":"z4WsS8Tv98"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(antipodal(\"cairo\"))\nplot_antipodal(\"cairo\")","key":"gRJS7dhcyz"},{"type":"output","id":"JmN7fS_u1z8sBFFhAoB_f","data":[{"output_type":"stream","name":"stdout","text":"(np.float64(-30.0444), np.float64(-148.7643))\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fd32dd8cc37a1a6ff638cf47cb506409","path":"/great-circle-cookbook/_preview/7/build/fd32dd8cc37a1a6ff638cf47cb506409.png"}}}],"key":"tXlq6RV2wD"}],"key":"EqSEusnBIR"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yx1CTSkX4E"}],"key":"UJUgEu0gvg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hUxdgGsJAO"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"sBISquYQqR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Calculating and mapping the midpoint and intermediate points along the great circle arc and closed circle path.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sd4v9wVngr"}],"key":"WM8BXzU78I"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IsILdOb7bC"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"SuGvwvMcoA"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"With a great circle arc defined, determine if a third point is along the arc or at what distance it sits from the great circle arc and path.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r4NjoU88mv"}],"key":"XNI1LuInhq"}],"key":"BQAKgzXZ9Z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kf1EX0OJFB"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"qtLmqZ6dOf"}],"key":"irxYL70Rye"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ed Williams “Avitation Formulary”","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QgecH1lE9M"}],"urlSource":"https://edwilliams.org/avform147.htm","key":"xdbMpFKSKy"}],"key":"Z83pBVIsV8"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Movable Type Scripts","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xyAuBcyrjU"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html","key":"bHrtGqpceQ"}],"key":"iqW6YwiaJz"}],"key":"y2x7V2kzoK"}],"key":"BY8lsIGQ7r"}],"key":"xv5jp7d4Iv"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Coordinate Types","url":"/notebooks/foundations/coordinates","group":"Foundations"},"next":{"title":"Great Circles and a Point","url":"/notebooks/tutorials/arc-to-point","group":"Tutorials"}}},"domain":"http://localhost:3000"}