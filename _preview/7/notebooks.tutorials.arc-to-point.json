{"version":2,"kind":"Notebook","sha256":"71ef0d0b9153045fc1706a8e9710cd463a172d1acd6f7c9da8ae3b6c4f98405e","slug":"notebooks.tutorials.arc-to-point","location":"/notebooks/tutorials/2_arc_to_point.ipynb","dependencies":[],"frontmatter":{"title":"Great Circles and a Point","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/great-circle-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/great-circle-cookbook/blob/HEAD/notebooks/tutorials/2_arc_to_point.ipynb","thumbnail":"/great-circle-cookbook/_preview/7/build/undefined","exports":[{"format":"ipynb","filename":"2_arc_to_point.ipynb","url":"/great-circle-cookbook/_preview/7/build/2_arc_to_point-305115b0ac0da3252f2ed93dffaa473f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/great-circle-cookbook/_preview/7/build/undefined","alt":"The Earth Polychromatic Imaging Camera, or EPIC, captured this image of smoke from a wildfire in North America on Aug.15, 2018. Credit: NASA Goddard/ Katy Mersmann","key":"RrmcOFGHsE","urlSource":"https://climate.nasa.gov/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBbjhxIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--4991bee2efb16c12caca6f535e504ce7a99b0f1c/epic_fires_header_0.gif"}],"key":"BYUvzvHBje"}],"key":"HQg4Fhr94N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Great Circles and a Point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DoIsRvWLgF"}],"identifier":"great-circles-and-a-point","label":"Great Circles and a Point","html_id":"great-circles-and-a-point","implicit":true,"key":"VcFU8JBm4l"}],"key":"qMLF4snBL9"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GQ3G18uoRY"}],"key":"EGQY6XCOdA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ETFM4LWhUx"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"ClZSSMucBT"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Oh no! A plane traveling across the country suddenly discovers it is low on fuel! It can no longer make it to the planned airport, instead it has to find the closest airport to its current position that it can make it with its remaining fuel.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Jf1BGmrcVV"}],"key":"KBWcqdG4YB"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In great circle terms, we want to determine how far a point (let’s say, the next closest airport) is from a great circle arc (the flight’s path). In this notebook we will:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"oGC9DqNMHp"}],"key":"qnqNGsvOZv"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Determine the distance of a point to a great circle arc (cross-track and along-track distance)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"d0vytPTeXn"}],"key":"nmzvxcDU95"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Determine if a point lies on a great circle arc and path (with and without tolerances)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lrfWpZpEvZ"}],"key":"rW6xXNKwDW"}],"key":"JSD0G4g6Ps"}],"key":"BIedNZUko9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AkZWpqcNCr"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"sKtd18DuM0"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CFZclplAfO"}],"key":"ZtfKoE7pav"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oCDi8VXxPb"}],"key":"Jd80tdd4kf"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gqhs4PDtlI"}],"key":"dKAT8N8ojC"}],"key":"DipbaSzLG5"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/numpy/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Numpy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pfXhgIRaNs"}],"urlSource":"https://foundations.projectpythia.org/core/numpy/","key":"iigCPmN5my"}],"key":"LLcI0w2rfi"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"N1tYHahl2c"}],"key":"Ug2Aw2PoId"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Used to work with large arrays","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IYhiOdKLbi"}],"key":"i83CFSsD7q"}],"key":"Y3QeHrxE75"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XBikBmGlFC"}],"urlSource":"https://foundations.projectpythia.org/core/pandas","key":"VZ9yqOGXfd"}],"key":"enoDBROv1N"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YfHuF05TZZ"}],"key":"BLUJ3aBwY4"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Used to read in and organize data (in particular dataframes)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v5XJMa6vmT"}],"key":"aBOqPfGVjJ"}],"key":"qY3zmDkLny"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Intro to Cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q5qPR0S8RK"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy","key":"G83jpHEVt7"}],"key":"jHbWeZXHf2"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"okdbimmfl8"}],"key":"gQ9Siy9Lju"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Will be used for adding maps to plotting","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KJK5QH8ll9"}],"key":"JYyteurPlK"}],"key":"o8pF43UWLI"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"IYikzOPDt6"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/","key":"oeivJX0Ers"}],"key":"GwdpTWeHIk"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KOHQulsvi8"}],"key":"SRFdjsuS2M"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Will be used for plotting","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"B4AeeZeE23"}],"key":"ExzwUTKlDq"}],"key":"KNYnuNAgE6"}],"key":"jhkonUFTmt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Cl9o5KgLvO"}],"key":"DS2N4cYtYv"},{"type":"text","value":": 20 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tgcc04X8sJ"}],"key":"bxfNDNwd07"}],"key":"cT5coVhjO8"}],"key":"kqtGU2bEvU"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IR6bic0UUA"}],"key":"yFSn1sCFPA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z6dNFsJXaZ"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"ht1YtUHo41"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Import Packages","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JURNqgoUbf"}],"key":"QdV7cY1psx"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Setup location dataframe with coordinates","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gDEKZMOxYA"}],"key":"hahd8ILVHV"}],"key":"gEqwJyk9K7"}],"key":"AdF0poi3gG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd                                    # read in data text file\nimport numpy as np                                     # working with degrees and radians\n\nfrom pyproj import Geod                                # working with the Earth as an ellipsod (WGS-84)\nimport geopy.distance                                  # moving along a known distance on the Earth's ellipsoid surface\n\nimport matplotlib.pyplot as plt                        # plotting a graph\nfrom cartopy import crs as ccrs, feature as cfeature   # plotting a world map","key":"y6SNjj7Jvh"},{"type":"output","id":"M1l59viGqtTHjz1_GW3y_","data":[],"key":"FkBqKRLMg2"}],"key":"qUoPgpPll3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get all Coordinates for Locations\nlocation_df = pd.read_csv(\"../location_full_coords.txt\")\nlocation_df = location_df.rename(columns=lambda x: x.strip()) # strip excess white space from column names and values\nlocation_df.index = location_df[\"name\"]\nlocation_df.head()","key":"l0NHFzEEJP"},{"type":"output","id":"v6uG-Oj9IUTMveILjLzPj","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"              name  latitude  longitude        cart_x        cart_y  \\\nname                                                                  \narecibo    arecibo   18.3441   -66.7527  2.389526e+06 -5.562495e+06   \nboulder    boulder   40.0150  -105.2705 -1.286558e+06 -4.712394e+06   \nboston      boston   42.3601   -71.0589  1.529809e+06 -4.457769e+06   \nredwoods  redwoods   41.4017  -124.0417 -2.678169e+06 -3.964322e+06   \nhouston    houston   29.5518   -95.0982 -4.930480e+05 -5.526456e+06   \n\n                cart_z        rho     theta       phi       polar_x  \\\nname                                                                  \narecibo   2.007347e+06  6378137.0 -1.165054  1.250631 -5.562495e+06   \nboulder   4.101066e+06  6378137.0  1.304276  0.872403 -4.712394e+06   \nboston    4.297512e+06  6378137.0 -1.240212  0.831473 -4.457769e+06   \nredwoods  4.218080e+06  6378137.0  0.976657  0.848200 -3.964322e+06   \nhouston   3.145762e+06  6378137.0  1.481816  1.055020 -5.526456e+06   \n\n               polar_y       polar_z  \nname                                  \narecibo   2.389526e+06  2.007347e+06  \nboulder  -1.286558e+06  4.101066e+06  \nboston    1.529809e+06  4.297512e+06  \nredwoods -2.678169e+06  4.218080e+06  \nhouston  -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n    <tr>\n      <th>name</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>arecibo</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>2.389526e+06</td>\n      <td>-5.562495e+06</td>\n      <td>2.007347e+06</td>\n      <td>6378137.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>boulder</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-1.286558e+06</td>\n      <td>-4.712394e+06</td>\n      <td>4.101066e+06</td>\n      <td>6378137.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>boston</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>1.529809e+06</td>\n      <td>-4.457769e+06</td>\n      <td>4.297512e+06</td>\n      <td>6378137.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>redwoods</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-2.678169e+06</td>\n      <td>-3.964322e+06</td>\n      <td>4.218080e+06</td>\n      <td>6378137.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>houston</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-4.930480e+05</td>\n      <td>-5.526456e+06</td>\n      <td>3.145762e+06</td>\n      <td>6378137.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"dFO8PDlL9u"}],"key":"MIwdEQGRRN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the distance of a point to a great circle arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IK1X7KRPVg"}],"identifier":"determine-the-distance-of-a-point-to-a-great-circle-arc","label":"Determine the distance of a point to a great circle arc","html_id":"determine-the-distance-of-a-point-to-a-great-circle-arc","implicit":true,"key":"qOcU9oJgxj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The distance from a point to a great circle arc is known as the cross track distance (sometimes known as cross track error). For example, how far a unscheduled airport refueling will take a plane off its path. Meantime, the along track distance measuer how far along the great arc a point lies. For instance, what is your new position (latitude/longitude) when you’ve traveled 250 km into your 2000 km plane ride.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x5OCzsPQ5N"}],"key":"PwZT0yM2O9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross track distance: angular distance from point P to great circle path","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GHFhEV3Bsx"}],"key":"Om66qep9gq"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Along track distance: angular distance along the great circle path from A to B before hitting a point that is closest to point P","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TPPd0J4LHq"}],"key":"PpEqUd6z9g"}],"key":"MrbM1LIUH3"}],"key":"qxLSfTR5o2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geodesic = Geod(ellps=\"WGS84\")\nearth_radius = 6378137  # meters","key":"KV0CNG5hJ8"},{"type":"output","id":"xzjIZi1RQIq-9OUjqApyT","data":[],"key":"XiCitcJfxp"}],"key":"rL8jWTHcwy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cross Track Distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ml20FviuGp"}],"identifier":"cross-track-distance","label":"Cross Track Distance","html_id":"cross-track-distance","implicit":true,"key":"V1v2vgrSs1"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Distance of a point to a great circle arc is defined as:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HaocQvKxkx"}],"key":"QqjX82evCI"},{"type":"math","value":"dxt = asin( sin(δ13) ⋅ sin(θ13 − θ12) ) * R","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>x</mi><mi>t</mi><mo>=</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>δ</mi><mn>13</mn><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mn>13</mn><mo>−</mo><mi>θ</mi><mn>12</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">dxt = asin( sin(δ13) ⋅ sin(θ13 − θ12) ) * R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">13</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord\">13</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord\">12</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span>","enumerator":"1","key":"EXbAJBHQ5T"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Where,","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"R3GGMIsW6J"}],"key":"v7C12hkxXR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"δ13 (delta_13) is (angular) distance from start point to third point","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"a5RB8snDUh"}],"key":"qNJWmf9dhA"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"θ13 (theta_13) is (initial) bearing from start point to third point","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Htvi8sJkO8"}],"key":"SkxBkFWcYo"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"θ12 (theta_12) is (initial) bearing from start point to end point","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"CDq3etaOaA"}],"key":"RYkmrJDgEb"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"R is the earth’s radius","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OqnTRfMXsw"}],"key":"LMc9tCR88z"}],"key":"Vn0qcH2fkh"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Then,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jc33FwlxZF"}],"key":"XrjakJgPjA"},{"type":"math","value":"d_xt = np.arcsin(np.sin(delta_13)*np.sin(theta_13 - theta_12)) * R","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mi>x</mi></msub><mi>t</mi><mo>=</mo><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><msub><mi>a</mi><mn>1</mn></msub><mn>3</mn><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mn>1</mn></msub><mn>3</mn><mo>−</mo><mi>t</mi><mi>h</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mn>1</mn></msub><mn>2</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">d_xt = np.arcsin(np.sin(delta_13)*np.sin(theta_13 - theta_12)) * R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">rcs</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">lt</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">2</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span>","enumerator":"2","key":"GHYn6hEVkB"},{"type":"math","value":"XTD =asin(sin(dist_AD)*sin(crs_AD-crs_AB))","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>X</mi><mi>T</mi><mi>D</mi><mo>=</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>A</mi></msub><mi>D</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mi>r</mi><msub><mi>s</mi><mi>A</mi></msub><mi>D</mi><mo>−</mo><mi>c</mi><mi>r</mi><msub><mi>s</mi><mi>A</mi></msub><mi>B</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">XTD =asin(sin(dist_AD)*sin(crs_AD-crs_AB))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">XT</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">cr</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">cr</span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"3","key":"g61QGTwc1l"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Where,","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"fGL0KgcFbd"}],"key":"kYQuRqbOov"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Positive Cross-Track Distance: Point lies in the hemisphere to the left of the great circle","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"RFhZGl7cJe"}],"key":"cl3qG9JQRZ"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Negative Cross-Track Distance: Point lies in the hemiphere to the right of the great circle","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"HbfbUgbRjk"}],"key":"MItCnfMMe2"}],"key":"lXMPVJ4H7X"},{"type":"blockquote","position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Note: If the point A is the North or South Pole replace ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"dfHY7PIvrb"},{"type":"inlineCode","value":"crs_AD-crs_AB","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"cxm6KCEnvY"},{"type":"text","value":" with\n","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Y7y4o7FARB"},{"type":"inlineCode","value":"lon_D-lon_B","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"eiDhA4cYD4"},{"type":"text","value":" or ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"jFx7ZzB82H"},{"type":"inlineCode","value":"lon_B-lon_D","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"V8kMvoBOHn"},{"type":"text","value":", respectively","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"AS0QuQhTsI"}],"key":"GX5UHV7bDd"}],"key":"X1NvMPl7iK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#XTE","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"See more: Cross track error","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"kDwK7ZC6AF"}],"urlSource":"https://edwilliams.org/avform147.htm#XTE","key":"JYFp9ywraf"}],"key":"vwqci21Lkk"}],"key":"yos3PxorM4"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"That was a lot of math, let’s see how that translates into a Python function. For the purpose of this example, let’s determine the foward bearing and distance between the great circle arc and the new point on an ellipsoid.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"phIrkQuEhU"}],"key":"Mr58KV2C0g"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"We will be creating two sides of a spherical triangle. Side 1 will be the great circle arc formed from Point A to Point B, while Side 2 will be a new great circle arc we will create from Point A to the new Point (Point C). We can use the angle between these two legs to determine the cross track distance:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ZSlPmVtmMR"}],"key":"UyZzJ3DqGZ"}],"key":"S4GlDjGDQR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def cross_track_distance(start_point=None, end_point=None, new_point=None):\n    # Determine the foward bearing from Point A (start) to Point B (end)\n    fwd_bearing_start_end, _, _ = geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                               location_df.loc[start_point, \"latitude\"],\n                                               location_df.loc[end_point, \"longitude\"],\n                                               location_df.loc[end_point, \"latitude\"])\n    \n    # Determine the foward bearing (angle) and distance from Point A (start) to new Point C\n    fwd_bearing_start_new, _, distance_m_start_new = geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                                                  location_df.loc[start_point, \"latitude\"],\n                                                                  location_df.loc[new_point, \"longitude\"],\n                                                                  location_df.loc[new_point, \"latitude\"]) \n\n    # Determine the Angular Distance from Point A to Point C\n    angular_distance_start_new = distance_m_start_new / earth_radius\n    ct_distance = np.arcsin(np.sin(angular_distance_start_new) * np.sin(np.deg2rad(fwd_bearing_start_new - fwd_bearing_start_end))) * earth_radius\n    return ct_distance","key":"rEtBNZOJQN"},{"type":"output","id":"u7yDJsVIWpjPlgSJUYxNo","data":[],"key":"GLJfl0CNFa"}],"key":"pV4y0o7rEl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Along Track Distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4Kio2XTfI"}],"identifier":"along-track-distance","label":"Along Track Distance","html_id":"along-track-distance","implicit":true,"key":"muyuAJ83aZ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Distance along a great circle arc, closest to a point is defined as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z2ziQt3w83"}],"key":"bwI17e7uz1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Where:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AAWJoDin45"}],"key":"nHhfjVQxpj"},{"type":"math","value":"dat = acos(\\frac{cos(δ13)}{cos(δxt)}) * R","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>δ</mi><mn>13</mn><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>δ</mi><mi>x</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">dat = acos(\\frac{cos(δ13)}{cos(δxt)}) * R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\">13</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span>","enumerator":"4","key":"KAVQD5g1An"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"δ13 (delta_13) is (angular) distance from start point to third point","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"V0jZ7bdrSS"}],"key":"oSUFa64hfX"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"δxt (delta_xt) is (angular) cross-track distance","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"JUvm8Qmcd8"}],"key":"Xihl84pRqI"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"R is the earth’s radius","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QbfoLRGsMX"}],"key":"OuAedIGowD"}],"key":"LejfI6fk42"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"So,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LFUYzoNqEY"}],"key":"wIaRwtVglp"},{"type":"math","value":"d_at = np.arccos(\\frac{np.cos(delta_13)}{np.cos(d_xt/R)} * R","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mi>a</mi></msub><mi>t</mi><mo>=</mo><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><msub><mi>a</mi><mn>1</mn></msub><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><mrow><mi>n</mi><mi>p</mi><mi mathvariant=\"normal\">.</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><msub><mi>d</mi><mi>x</mi></msub><mi>t</mi><mi mathvariant=\"normal\">/</mi><mi>R</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>∗</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">d_at = np.arccos(\\frac{np.cos(delta_13)}{np.cos(d_xt/R)} * R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">rccos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">t</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">p</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">lt</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span>","enumerator":"5","key":"YUtnv6B2EW"},{"type":"math","value":"ATD=acos(\\frac{cos(dist_AD)}{cos(XTD)})","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mi>T</mi><mi>D</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>A</mi></msub><mi>D</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi>T</mi><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">ATD=acos(\\frac{cos(dist_AD)}{cos(XTD)})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">XT</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"fyo8H07Ap0"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"However, for very short distances we can also use a new equation that is less susceptible to rounding errors:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Ssz3bfPTvJ"}],"key":"Joc2l0XnQX"},{"type":"math","value":"ATD=asin(\\sqrt{\\frac{sin(dist_AD))^2 - (sin(XTD))^2 )}{cos(XTD)}}","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mi>T</mi><mi>D</mi><mo>=</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msqrt><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><msub><mi>t</mi><mi>A</mi></msub><mi>D</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>−</mo><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi>T</mi><mi>D</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi>T</mi><mi>D</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">ATD=asin(\\sqrt{\\frac{sin(dist_AD))^2 - (sin(XTD))^2 )}{cos(XTD)}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.04em;vertical-align:-1.1606em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8794em;\"><span class=\"svg-align\" style=\"top:-5em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">XT</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">XT</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.8394em;\"><span class=\"pstrut\" style=\"height:5em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:3.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='3.08em' viewBox='0 0 400000 3240' preserveAspectRatio='xMinYMin slice'><path d='M473,2793\nc339.3,-1799.3,509.3,-2700,510,-2702 l0 -0\nc3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM1001 80h400000v40H1017.7z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1606em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"Pql97rEJVC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#XTE","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"See more: Along track distance","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"NjTarPCphS"}],"urlSource":"https://edwilliams.org/avform147.htm#XTE","key":"aUeCKDCyOB"}],"key":"ppFNIptETC"}],"key":"K2V4xLNHgF"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"To similiarly convert into a Python function, we will need to know the total length of the great circle from Point A to Point B, but we can also make a new great circle arc with Point C that represents the distance along the great circle arc that it lies:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"UUJxYvAW2G"}],"key":"yu8aZ5z5hc"}],"key":"ZnVdQocPgU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def along_track_distance(start_point=None, end_point=None, new_point=None):\n    # Determine the cross track distance from Point A to Point B from Point C\n    crosst_distance = cross_track_distance(start_point, end_point, new_point)\n\n    # Determine the total distance of a great circle arc from Point A to Point C\n    _, _, distance_m_start_new = geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                              location_df.loc[start_point, \"latitude\"],\n                                              location_df.loc[new_point, \"longitude\"],\n                                              location_df.loc[new_point, \"latitude\"])  \n    \n    # Determine the Along-Track Distance using the Cross Track Distance Distance \n    angular_distance_start_new = distance_m_start_new / earth_radius\n    at_distance = np.arccos(np.cos(angular_distance_start_new) / np.cos(crosst_distance / earth_radius)) * earth_radius\n    return at_distance","key":"g8u76upFRT"},{"type":"output","id":"pBUxKpjHJ5UdYTZi9L0hM","data":[],"key":"OxNSh7e5Zw"}],"key":"UB6AWL29YC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Closest Point along Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hfUdXYhGcg"}],"identifier":"determine-closest-point-along-great-circle-arc","label":"Determine Closest Point along Great Circle Arc","html_id":"determine-closest-point-along-great-circle-arc","implicit":true,"key":"U9bVDgN07I"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To be able to plot a cross track distance we need to find the point on the great circle that is closest to the new Point C. To do this we need to find the closest point from Point C to the arc and measure the along track distance that the intersection lies","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T8b7ubvzWC"}],"key":"heqoAw0x0y"}],"key":"jPHcl6h4So"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Distance point along great circle path\ndef point_along_path(start_point=None, end_point=None, distance_m=None):\n    fwd_bearing, _, _ = geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                     location_df.loc[start_point, \"latitude\"],\n                                     location_df.loc[end_point, \"longitude\"],\n                                     location_df.loc[end_point, \"latitude\"])  \n    origin = geopy.Point(location_df.loc[start_point, \"latitude\"],\n                         location_df.loc[start_point, \"longitude\"])\n    distance_to_move = geopy.distance.distance(\n                            kilometers=distance_m / 1000)  # distance to move towards the next point\n    final_position = distance_to_move.destination(origin, bearing=fwd_bearing)\n    return (final_position.latitude, final_position.longitude)","key":"SeejR0tTAo"},{"type":"output","id":"qrPgj_VvUcKKJiXZOESHy","data":[],"key":"Z2ZGOnaGcA"}],"key":"Y6TwEVf8UQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s see how of this looks on a map! Let’s plot!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZVdjvEqhjM"}],"key":"QPBQlom38a"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the previous notebook, we determined how to interpolate points along the great circle arc (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AT24ktDwp3"},{"type":"inlineCode","value":"interpolate_points_along_gc","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pnhkw3SZLz"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"niGHTITZXb"},{"type":"inlineCode","value":"arc_points","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZRhmr6B7Qv"},{"type":"text","value":"). We will repeat the functions below to be able to use them to plot the great circle arc with the new infomration about cross track and along track distances","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Baq2jDpHnS"}],"key":"EDRvWhMjwq"}],"key":"xsf8pNgCK4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# See Previous Notebook for how these functions were defined\n\ndef interpolate_points_along_gc(lat_start,\n                                lon_start,\n                                lat_end,\n                                lon_end,\n                                distance_between_points_meter): \n    lat_lon_points = [(lat_start, lon_start)]\n    \n    # move to next point when distance between points is less than the equal distance\n    move_to_next_point = True\n    while(move_to_next_point):\n        forward_bearing, reverse_bearing, distance_meters = geodesic.inv(lon_start,\n                                                                         lat_start, \n                                                                         lon_end,\n                                                                         lat_end)\n        if distance_meters < distance_between_points_meter:\n            # ends before overshooting\n            move_to_next_point = False\n        else:\n            start_point = geopy.Point(lat_start, lon_start)\n            distance_to_move = geopy.distance.distance(\n                            kilometers=distance_between_points_meter /\n                            1000)  # distance to move towards the next point\n            final_position = distance_to_move.destination(\n                            start_point, bearing=forward_bearing)\n            lat_lon_points.append((final_position.latitude, final_position.longitude))\n            # new starting position is newly found end position\n            lon_start, lat_start = final_position.longitude, final_position.latitude\n    lat_lon_points.append((lat_end, lon_end))\n    return lat_lon_points\n\ndef arc_points(start_lat=None,\n               start_lon=None,\n               end_lat=None,\n               end_lon=None,\n               n_total_points=10):\n    _, _, distance_meter =  geodesic.inv(start_lon,\n                                        start_lat,\n                                        end_lon,\n                                        end_lat)\n        \n    distance_between_points_meter = distance_meter / (n_total_points + 1)\n\n    \n    new_points_lst = interpolate_points_along_gc(start_lat,\n                                              start_lon,\n                                              end_lat,\n                                              end_lon,\n                                              distance_between_points_meter)\n    return new_points_lst","key":"gHlk3EKiX7"},{"type":"output","id":"S0jkkk9R76SI-8avlrP0o","data":[],"key":"KPJLyPA2Bg"}],"key":"iQNoMhHlFt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To begin, we will plot the cross track distance. This will look like a map with two arcs: one from Point A to Point B (the primary great circle arc) and a second that will show the angular distance between the great circle arc and a new point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBMstLGJLU"}],"key":"YSubqmbq6Z"}],"key":"m5uCTjuPcu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_cross_track(start_point=None, end_point=None, new_point=None,\n                     lon_west=-130, lon_east=-60,\n                     lat_south=20, lat_north=60):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(16, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.BORDERS, edgecolor='grey')\n    ax.add_feature(cfeature.STATES, edgecolor=\"grey\")\n\n    # Cross-Track and Along-Track Distances\n    ct_distance = cross_track_distance(start_point, end_point, new_point)\n    print(f\"Cross Track Distance: \\n{ct_distance} meters ({ct_distance/1000} km)\")\n\n    at_distance = along_track_distance(start_point, end_point, new_point)\n    print(f\"Along Track Distance: \\n{at_distance} meters ({at_distance/1000} km)\\n\")\n\n    closest_point = point_along_path(start_point, end_point, at_distance)\n    print(f\"Closest Point To Point Along Great Circle Path:\\n{closest_point}\") \n\n    # Plot Latitude/Longitude Points of the Great Circle Arc (with 10 interpolate points)\n    great_circle_arc_pts = arc_points(location_df.loc[start_point, \"latitude\"],\n                                      location_df.loc[start_point, \"longitude\"],\n                                      location_df.loc[end_point, \"latitude\"],\n                                      location_df.loc[end_point, \"longitude\"],\n                                      10)\n    longitudes = [x[1] for x in great_circle_arc_pts] # longitude\n    latitudes = [x[0] for x in great_circle_arc_pts] # latitude\n    plt.plot(longitudes, latitudes, c=\"purple\")\n    plt.scatter(longitudes, latitudes, c=\"purple\")\n\n    # Plot the Cross Track Distance as an Arc from Point C to the closest point on the arc (Point D) (with 10 intrpolated points)\n    cross_track_arc = arc_points(closest_point[0],\n                                 closest_point[1],\n                                 location_df.loc[new_point, \"latitude\"],\n                                 location_df.loc[new_point, \"longitude\"],\n                                   10)\n    longitudes = [x[1] for x in cross_track_arc] # longitude\n    latitudes = [x[0] for x in cross_track_arc] # latitude\n    plt.plot(longitudes, latitudes, c=\"green\")\n    plt.scatter(longitudes, latitudes, c=\"green\")\n\n    # Plot the Closest Point on the Arc in Red (to see easier)\n    plt.scatter(closest_point[1], closest_point[0], c=\"red\")\n\n    plt.title(f\"Closest Point {closest_point} from {start_point.title()}->{end_point.title()} to {new_point.title()}, Cross-Track Distance = {ct_distance/1000:4f} km\")\n    plt.show()","key":"uVieGrJD1f"},{"type":"output","id":"3fvcAEZLG302HPNzHl613","data":[],"key":"cKo1vI7PYC"}],"key":"VRNMD6QwIC"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Positive Cross-Track Distance: Point lies in the hemisphere to the left of the great circle","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYEMLWEcNb"}],"key":"nHNAcPtSsV"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Negative Cross-Track Distance: Point lies in the hemiphere to the right of the great circle","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"kblItp8kgB"}],"key":"t4H6wHO3n1"}],"key":"Al2IFVrFnB"}],"key":"TMJlySv4Bu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_cross_track(start_point=\"boulder\", end_point=\"boston\", new_point=\"cape canaveral\")","key":"YTmYN7GbOW"},{"type":"output","id":"P_txxWgT7U_PbPaJpFMkJ","data":[{"output_type":"stream","name":"stdout","text":"Cross Track Distance: \n1593669.526094791 meters (1593.669526094791 km)\nAlong Track Distance: \n2076501.5510165778 meters (2076.5015510165777 km)\n\nClosest Point To Point Along Great Circle Path:\n(42.75525245755491, -80.62124342116076)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_0_boundary_lines_land.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e13b19d49a8ce7b1e75ea383b06e8697","path":"/great-circle-cookbook/_preview/7/build/e13b19d49a8ce7b1e75ea383b06e8697.png"}}}],"key":"cuZB4KjEKz"}],"key":"n5ALoyerIc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine if a point lies on a great circle arc and path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RPP0Uk2XWV"}],"identifier":"determine-if-a-point-lies-on-a-great-circle-arc-and-path","label":"Determine if a point lies on a great circle arc and path","html_id":"determine-if-a-point-lies-on-a-great-circle-arc-and-path","implicit":true,"key":"zHDYPwUQtH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Does a given Point C lie on a great circle arc? Does it lie on the great circle path? We can check if a point lies on a great circle path/arc if:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GqUkyHksfz"}],"key":"qDrMkjotCN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Check if the latitude/longtiude matches the expected latitude that the same longitude position would have produced on the great circle path","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qX3k5cNncE"}],"key":"yLd1OVLdau"}],"key":"uerfluIZiT"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This is possible with and without tolerances (in meters) to allow for some grace based on your precision.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jl2kA2cn0G"}],"key":"U8pJhM79NP"}],"key":"zQk7ugkpvB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def is_point_on_arc(start_point=None, end_point=None,\n                check_point=None, tolerance=0):\n    # tolerance in meters\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    check_lon = np.deg2rad(location_df.loc[check_point, \"longitude\"])\n    check_lat = np.deg2rad(location_df.loc[check_point, \"latitude\"])\n\n    # Verify not meridian (longitude passes through the poles)\n    if np.sin(lon1 - lon2) == 0:\n        print(\"Invalid inputs: start/end points are meridians\")\n        return np.nan\n    \n    # verify not antipodal (diametrically opposite, points)\n    if lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi:\n        print(\"Invalid inputs: start/end points are antipodal\")\n        return np.nan\n\n    # account for tolerance based on cross-track distance from arc\n    ct_distance = cross_track_distance(start_point, end_point, check_point)\n    print(f\"Cross-Track Distance = {ct_distance} meters\")\n    if np.abs(ct_distance) <= tolerance:\n        return True\n\n    # determine expected latitude\n    num = np.sin(lat1)*np.cos(lat2)*np.sin(check_lon-lon2)-np.sin(lat2)*np.cos(lat1)*np.sin(check_lon-lon1)\n    den = np.cos(lat1)*np.cos(lat2)*np.sin(lon1-lon2)\n    new_lat = np.arctan(num/den)\n    expected_lat = np.rad2deg(new_lat)\n    return bool(check_lat == expected_lat)","key":"F3Mxbg9qU5"},{"type":"output","id":"srMrENc5twjIgaRcRaaau","data":[],"key":"TymOyqopFc"}],"key":"AZjIcv9YqK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check if a point lies on a great circle arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pQ0NJUtvVb"}],"identifier":"check-if-a-point-lies-on-a-great-circle-arc","label":"Check if a point lies on a great circle arc","html_id":"check-if-a-point-lies-on-a-great-circle-arc","implicit":true,"key":"km1YdzGQC2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s see this for ourselves. Does the city of Rockford lie on the great circle arc from Boulder to Boston?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mjSTmmFFOI"}],"key":"rPdwYiir2i"}],"key":"gPsl3jdHLe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"is_point_on_arc(\"boulder\", \"boston\", \"rockford\", tolerance=0) # with no tolerance (0 meters)","key":"gXhZ0FxUMC"},{"type":"output","id":"hUT7quYm-gilfURXo5olr","data":[{"output_type":"stream","name":"stdout","text":"Cross-Track Distance = 18201.48035911659 meters\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"False","content_type":"text/plain"}}}],"key":"PhMstgJWuu"}],"key":"XxDxvdzJMk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Rockford is sitting about 18 km away from the great circle arc that is formed by Boulder and Boston. Let’s give it a look on a map:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CYIpmY4nTa"}],"key":"kr4PBQqnHP"}],"key":"CuX6HyOsga"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_cross_track(start_point=\"boulder\", end_point=\"boston\", new_point=\"rockford\")","key":"x2S2bhHnUM"},{"type":"output","id":"O7D8qMheXIW4BjxISQ6L3","data":[{"output_type":"stream","name":"stdout","text":"Cross Track Distance: \n18201.48035911659 meters (18.20148035911659 km)\nAlong Track Distance: \n1378654.5186233742 meters (1378.654518623374 km)\n\nClosest Point To Point Along Great Circle Path:\n(42.434120910748035, -89.11630028269337)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"63bddb7e78f2d867d018dcba59c59eb2","path":"/great-circle-cookbook/_preview/7/build/63bddb7e78f2d867d018dcba59c59eb2.png"}}}],"key":"H7VM1IcBZK"}],"key":"VEOZrY59T3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Hard to see, right? Let’s zoom in:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W0Ecmirusi"}],"key":"F1SLthdnq9"}],"key":"IhuxWZ6nTC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_cross_track(start_point=\"boulder\", end_point=\"boston\", new_point=\"rockford\", \n                 lon_west=-95, lon_east=-85,\n                 lat_south=40, lat_north=45)","key":"pWFPs4Akw3"},{"type":"output","id":"HUZMOgKt-WlqsB86T-6P2","data":[{"output_type":"stream","name":"stdout","text":"Cross Track Distance: \n18201.48035911659 meters (18.20148035911659 km)\nAlong Track Distance: \n1378654.5186233742 meters (1378.654518623374 km)\n\nClosest Point To Point Along Great Circle Path:\n(42.434120910748035, -89.11630028269337)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/10m_physical/ne_10m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/10m_cultural/ne_10m_admin_0_boundary_lines_land.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/10m_cultural/ne_10m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1600x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"27f11e4bd2fc03e0abcd7fa10b47c23a","path":"/great-circle-cookbook/_preview/7/build/27f11e4bd2fc03e0abcd7fa10b47c23a.png"}}}],"key":"ndrxlbYybT"}],"key":"OihwG72D4l"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"18 km is far, but for the sake of clarity, maybe it serves our purposes as “on the arc”. If so, we can increase the tolerance of the function to about 18 km to encompass the town:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fDVF9c4hfa"}],"key":"x57bJV5MJ5"}],"key":"HxB8ntu0Ab"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# increase tolerance to capture point\nprint(\"tolerance = 0\")\nprint(is_point_on_arc(\"boulder\", \"boston\", \"rockford\", tolerance=0))\nprint(\"\\ntolerance >= cross-track distance\")\nprint(is_point_on_arc(\"boulder\", \"boston\", \"rockford\", tolerance=18202))","key":"o0ZTU8UMNn"},{"type":"output","id":"_ChNI_tu1wJMm8QAr2_c4","data":[{"output_type":"stream","name":"stdout","text":"tolerance = 0\nCross-Track Distance = 18201.48035911659 meters\nFalse\n\ntolerance >= cross-track distance\nCross-Track Distance = 18201.48035911659 meters\nTrue\n"}],"key":"MvaqTlcf9t"}],"key":"XdZRyhfmeO"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kOmrD6Gr45"}],"key":"mISjJw7z3I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f2ZDIySvuO"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"nArOEg7QqA"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we calculated and plotted the cross track and along track distance for points around a great circle arc","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wxM58PGEmx"}],"key":"BNVVru00Wd"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vZoPBXuN2b"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"q7wDkNPZQh"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Next, we will determine when a great circle path crosses a given parallel and the maximum and minimum latitude coordinates of a great circle path.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"joBVFe5NxJ"}],"key":"XqOX8MUPL3"}],"key":"dV37cDoGmh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G1UJVUwZ4A"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"uFKq9KHDXb"}],"key":"VbtJYAHl5y"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aviation Formulary V1.47","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l6E6HVheJ0"}],"urlSource":"https://edwilliams.org/avform147.htm","key":"fpbGep71Bj"}],"key":"DC8o2tTUzY"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Moveable Type Script","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fzmg72H4tG"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html","key":"pTgugmWdiL"}],"key":"sDQpd8tNla"}],"key":"AWaFiS8Wu5"}],"key":"qshUh9FFv6"}],"key":"XzfymGeO0d"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Great Circle Arcs and Path","url":"/notebooks/tutorials/arc-path","group":"Tutorials"},"next":{"title":"Great Circles and Parallels","url":"/notebooks/tutorials/parallels-max-min","group":"Tutorials"}}},"domain":"http://localhost:3000"}