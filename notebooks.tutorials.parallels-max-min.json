{"version":2,"kind":"Notebook","sha256":"34b6dcf9681eca26e069729b704ace2fbac76e1ce57a7f8c9cfe6f205f803115","slug":"notebooks.tutorials.parallels-max-min","location":"/notebooks/tutorials/3_parallels_max_min.ipynb","dependencies":[],"frontmatter":{"title":"Great Circles and Parallels","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/great-circle-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/great-circle-cookbook/blob/main/notebooks/tutorials/3_parallels_max_min.ipynb","thumbnail":"/great-circle-cookbook/build/0425273bd8f62ee885fd0d5f673b76df.gif","exports":[{"format":"ipynb","filename":"3_parallels_max_min.ipynb","url":"/great-circle-cookbook/build/3_parallels_max_min-c89fa3596f8dde6317779c72ded036d6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/great-circle-cookbook/build/0425273bd8f62ee885fd0d5f673b76df.gif","alt":"Ship on waves gif","key":"HpPdTweKJz","urlSource":"https://cdn1.byjus.com/wp-content/uploads/blog/2021/01/21071038/giphy-1.gif"}],"key":"IBYwk2jx2P"}],"key":"qQyT5vHVpR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Great Circles and Parallels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QRTrXb4UHF"}],"identifier":"great-circles-and-parallels","label":"Great Circles and Parallels","html_id":"great-circles-and-parallels","implicit":true,"key":"iYHGqeG57n"}],"key":"yBLs33F4vn"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cnJBZX4mUb"}],"key":"iIjhTEfOLq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yMOMuTTkMu"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"UkEx3HCEiw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A valid great circle path (that is not a path around the equator) will cross a maximum and minimum latitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ae1gj5oLBr"}],"key":"TKJIzK7YhJ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Determine the maximum latitude on a Great Circle Path","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VceQcf5MBU"}],"key":"ux0XYVNCOa"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Determine the minimum latitude on a Great Great path","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fbTdEiHo0k"}],"key":"tCmkil4oWy"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Determine when a great circle path crosses parallels (TODO)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GbBii5egS8"}],"key":"SBsukW1Pqb"}],"key":"F4hrGCUHP9"}],"key":"H0vuo7QFoC"}],"key":"C0Qlu9cFC3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OD72V5swfb"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"l11nIvwYq7"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lqdgAuU77t"}],"key":"lyiKRd5qqB"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yu6bOhnvNi"}],"key":"AoY3yeGXik"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B1iu2L5bb1"}],"key":"FTtR7TkVFf"}],"key":"y3q37aKDKz"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/numpy.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Numpy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WMnp0ouv6P"}],"urlSource":"https://foundations.projectpythia.org/core/numpy.html","key":"os4HIge9pq"}],"key":"gVx0r4Blu1"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zyHEinioa3"}],"key":"HAFzamdgAN"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Used to work with large arrays","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LZnsqRkbb0"}],"key":"ofyEcMtVKt"}],"key":"GsZXLStRPY"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/numpy.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DIO4ZFa8Ya"}],"urlSource":"https://foundations.projectpythia.org/core/numpy.html","key":"p2CwrV8GDv"}],"key":"eKlPMKfJjr"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eFrIbxMO3A"}],"key":"NsGz7K4ePE"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Used to read in and organize data (in particular dataframes)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rGMSBm4Jki"}],"key":"dORXfkEep4"}],"key":"bvXPWWmZpX"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy/cartopy.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Intro to Cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VuIMXqZIkM"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy/cartopy.html","key":"sVnxjYBDW8"}],"key":"kxA9xQd1JJ"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CjjDwL2yML"}],"key":"R1T7uVKVyK"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Will be used for adding maps to plotting","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rLi48d7ORd"}],"key":"FsuBUbpu8l"}],"key":"RJzy0mWPYN"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib.html","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uye67NYPGr"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib.html","key":"g0C96ozWXg"}],"key":"bR6LZ6oWp5"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vqFkWsbk1j"}],"key":"qYcXJw4IlF"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Will be used for plotting","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ek8KsUv1EA"}],"key":"MZ0q2emZAP"}],"key":"fs0SV3VqS8"}],"key":"vgKnCigvlv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ccGDS43FC5"}],"key":"QqqKI2HrF9"},{"type":"text","value":": 30 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ZAQWQLbmTq"}],"key":"y5qRIiqieQ"}],"key":"rvPdwMMshJ"}],"key":"DJxgVwR5XO"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VVm7NEHOdI"}],"key":"mqHu4WBOyu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1J0cFPtXh"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"sQ3hdbQOP0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Import Packages","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kd5IEXpj5Q"}],"key":"Ps5B9lpfmh"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Setup location dataframe with coordinates","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YwQnP9XzQ1"}],"key":"p40542gK6r"}],"key":"jXFyI6gICf"}],"key":"k9DT9gfl3o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd       # reading in data for location information from text file\nimport numpy as np        # working with arrays, vectors, cross/dot products, and radians\n\nfrom pyproj import Geod   # working with the Earth as an ellipsod (WGS-84)\n\nimport matplotlib.pyplot as plt                        # plotting a graph\nfrom cartopy import crs as ccrs, feature as cfeature   # plotting a world map","key":"TmdMZVUzko"},{"type":"output","id":"x09BrhVvo9rqfV0UE2yEb","data":[],"key":"y5kSBG09vk"}],"key":"GCXYDsOZS2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get all Coordinates for Locations\nlocation_df = pd.read_csv(\"../location_full_coords.txt\")\nlocation_df = location_df.rename(columns=lambda x: x.strip()) # strip excess white space from column names and values\nlocation_df.head()","key":"m5CkLktZ9F"},{"type":"output","id":"y6PnpHyTTnv-QP5g7jOBr","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"       name  latitude  longitude        cart_x        cart_y        cart_z  \\\n0   arecibo   18.3441   -66.7527  2.389526e+06 -5.562495e+06  2.007347e+06   \n1   boulder   40.0150  -105.2705 -1.286558e+06 -4.712394e+06  4.101066e+06   \n2    boston   42.3601   -71.0589  1.529809e+06 -4.457769e+06  4.297512e+06   \n3  redwoods   41.4017  -124.0417 -2.678169e+06 -3.964322e+06  4.218080e+06   \n4   houston   29.5518   -95.0982 -4.930480e+05 -5.526456e+06  3.145762e+06   \n\n         rho     theta       phi       polar_x       polar_y       polar_z  \n0  6378137.0 -1.165054  1.250631 -5.562495e+06  2.389526e+06  2.007347e+06  \n1  6378137.0  1.304276  0.872403 -4.712394e+06 -1.286558e+06  4.101066e+06  \n2  6378137.0 -1.240212  0.831473 -4.457769e+06  1.529809e+06  4.297512e+06  \n3  6378137.0  0.976657  0.848200 -3.964322e+06 -2.678169e+06  4.218080e+06  \n4  6378137.0  1.481816  1.055020 -5.526456e+06 -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>2.389526e+06</td>\n      <td>-5.562495e+06</td>\n      <td>2.007347e+06</td>\n      <td>6378137.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-1.286558e+06</td>\n      <td>-4.712394e+06</td>\n      <td>4.101066e+06</td>\n      <td>6378137.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>1.529809e+06</td>\n      <td>-4.457769e+06</td>\n      <td>4.297512e+06</td>\n      <td>6378137.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-2.678169e+06</td>\n      <td>-3.964322e+06</td>\n      <td>4.218080e+06</td>\n      <td>6378137.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-4.930480e+05</td>\n      <td>-5.526456e+06</td>\n      <td>3.145762e+06</td>\n      <td>6378137.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"ODnmA0QwDA"}],"key":"TsHfJd3MOj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"location_df.index = location_df[\"name\"]","key":"cROKf6b9jX"},{"type":"output","id":"nhGFOdlyjvXTj7eI07T5z","data":[],"key":"GfRBslFbb0"}],"key":"IP10pdvANU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Maximum Latitude on a Great Circle Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ocpIhiS1Ge"}],"identifier":"maximum-latitude-on-a-great-circle-path","label":"Maximum Latitude on a Great Circle Path","html_id":"maximum-latitude-on-a-great-circle-path","implicit":true,"key":"exfBu6FcN8"}],"key":"rHxnnQ4q5Y"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have previously determined an equation to derive a great circle path from intermediate points from two points on a great circle arc.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LGH6f03S8W"}],"key":"aYEilLAAPx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Without additional calculations, we can use a list of points along the great circle path to find the maximum location of the maximum and minimum.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Po9b8uWvsc"}],"key":"hpe8QxhsmU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"By default, the equation below will determine 360 points along longitude, so the output will only have a resolution of 1 degree. However, by defining the longitude with more points, the resolution increases.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bvcI0w7xNO"}],"key":"Jf2uzwv0OE"}],"key":"GJus5KZ8rt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate Latitude Coordinates based on Longitude Coordinates\ndef generate_latitude_along_gc(start_point=None, end_point=None, number_of_lon_pts=360):\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n\n    # Verify not meridian (longitude passes through the poles)\n    if np.sin(lon1 - lon2) == 0:\n        print(\"Invalid inputs: start/end points are meridians\")\n        # plotting meridians at 0 longitude through all latitudes\n        meridian_lat = np.arange(-90, 90, 180/len(longitude_lst)) # split in n number\n        meridians = []\n        for lat in meridian_lat:\n            meridians.append((lat, 0))\n        return meridians\n\n    # verify not anitpodal (diametrically opposite, points)\n    if lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi:\n        print(\"Invalid inputs: start/end points are antipodal\")\n        return []\n\n    # note: can be expanded to handle input of np arrays by filter out antipodal/merdiain points\n\n    # generate n total number of longitude points along the great circle\n    # https://github.com/rspatial/geosphere/blob/master/R/greatCircle.R#L18C3-L18C7\n    gc_lon_lst = []\n    for lon in range(1, number_of_lon_pts+1):\n        new_lon = (lon  * (360/number_of_lon_pts) - 180)\n        gc_lon_lst.append(np.deg2rad(new_lon))\n\n    # Intermediate points on a great circle: https://edwilliams.org/avform147.htm\"\n    gc_lat_lon = []\n    for gc_lon in gc_lon_lst:\n        num = np.sin(lat1)*np.cos(lat2)*np.sin(gc_lon-lon2)-np.sin(lat2)*np.cos(lat1)*np.sin(gc_lon-lon1)\n        den = np.cos(lat1)*np.cos(lat2)*np.sin(lon1-lon2)\n        new_lat = np.arctan(num/den)\n        gc_lat_lon.append((np.rad2deg(new_lat), np.rad2deg(gc_lon)))\n    return gc_lat_lon","key":"kdRhW79XqJ"},{"type":"output","id":"QMXWqzdX11ZNfB-x_81VV","data":[],"key":"i1BcKx5yrQ"}],"key":"ragOZNdscK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=360)\nprint(f\"Max Latitude (within 1 degree): {max(lat_lon, key=lambda x:x[0])}\")","key":"BAzPSkN5II"},{"type":"output","id":"kfFJ3zrJlrwXlvSo4LFOc","data":[{"output_type":"stream","name":"stdout","text":"Max Latitude (within 1 degree): (np.float64(42.750406941471915), np.float64(-81.0))\n"}],"key":"YQY8Xv8tHp"}],"key":"ExHv8YSIob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=720)\nprint(f\"Max Latitude (within 0.5 degree): {max(lat_lon, key=lambda x:x[0])}\")","key":"uGnjWSDIar"},{"type":"output","id":"hxo_dxrUlB6FmQJwnMc6u","data":[{"output_type":"stream","name":"stdout","text":"Max Latitude (within 0.5 degree): (np.float64(42.751388471834524), np.float64(-80.5))\n"}],"key":"nsNQUAHkIr"}],"key":"tE2bUhV8R9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=1080)\nprint(f\"Max Latitude (within 0.3 degree): {max(lat_lon, key=lambda x:x[0])}\")","key":"Z3B0DEaFvi"},{"type":"output","id":"H4xW33f4BFht7G9fSHney","data":[{"output_type":"stream","name":"stdout","text":"Max Latitude (within 0.3 degree): (np.float64(42.751302958796096), np.float64(-80.66666666666667))\n"}],"key":"diOzoClb4Z"}],"key":"thh0QvcOMk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot Maximum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sJHTTJZHyQ"}],"identifier":"plot-maximum","label":"Plot Maximum","html_id":"plot-maximum","implicit":true,"key":"F55YcTtQoR"}],"key":"zV1nkPk08L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_coordinate_max_min(great_circle_pts=None,\n                            max_coord=None, min_coord=None,\n                            title=None):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -180, 180, -90, 90\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.STATES, edgecolor=\"black\")\n    \n    # Plot Great Circle Latitude/Longitude Location\n    longitudes = [x[1] for x in great_circle_pts] # longitude\n    latitudes = [x[0] for x in great_circle_pts] # latitude\n    plt.plot(longitudes, latitudes)\n\n    # Overly Max/Min Coordinates\n    if max_coord is not None:\n        plt.scatter([max_coord[1]], [max_coord[0]], s=100, c=\"red\")\n    if min_coord is not None:\n        plt.scatter([min_coord[1]], [min_coord[0]], s=100, c=\"green\")\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(title)\n    plt.show()","key":"taA0XOIWSi"},{"type":"output","id":"yN30nZ3YXtU0FCnb1lCJ3","data":[],"key":"bTi7FjSFlJ"}],"key":"wujFb5fUZ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gc_lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=360)\nmax_lat_lon = max(gc_lat_lon, key=lambda x:x[0])\nplot_coordinate_max_min(great_circle_pts=gc_lat_lon,\n                            max_coord=max_lat_lon,\n                            title=f\"Max Latitude located at {max_lat_lon}\")","key":"IrycXGU5Ig"},{"type":"output","id":"3SrvTOofSx6xIfO4jDvKM","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_cultural/ne_110m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2f3ff6175df8531ccb54e2890a36b698","path":"/great-circle-cookbook/build/2f3ff6175df8531ccb54e2890a36b698.png"}}}],"key":"d5O8Tn5bdh"}],"key":"USWjuI0VCo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gc_lat_lon = generate_latitude_along_gc(\"boulder\", \"houston\", number_of_lon_pts=360)\nmax_lat_lon = max(gc_lat_lon, key=lambda x:x[0])\nplot_coordinate_max_min(great_circle_pts=gc_lat_lon,\n                            max_coord=max_lat_lon,\n                            title=f\"Max Latitude located at {max_lat_lon}\")","key":"rA9XveRc41"},{"type":"output","id":"LCbY1axUPX_5I6Ebsh8xs","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7d2f3a532cb1ca29c23df5b60e8de9ab","path":"/great-circle-cookbook/build/7d2f3a532cb1ca29c23df5b60e8de9ab.png"}}}],"key":"ansC124TeV"}],"key":"bEDIbDf6JW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Maximumn Latitude from Clairaut’s Formula","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qbqFQ2oRNQ"}],"identifier":"maximumn-latitude-from-clairauts-formula","label":"Maximumn Latitude from Clairaut’s Formula","html_id":"maximumn-latitude-from-clairauts-formula","implicit":true,"key":"bXhdXJVoAk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Clairaut%27s_relation_(differential_geometry)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Clairaut’s Formula","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PbUwdtlHaJ"}],"urlSource":"https://en.wikipedia.org/wiki/Clairaut%27s_relation_(differential_geometry)","data":{"page":"Clairaut%27s_relation_(differential_geometry)","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"j0N8N4PUFq"},{"type":"text","value":" (Clairaut’s equation or Clairaut’s relation) is a differential equation which defines the relationship between the latitude, φ, and the true course (bearing, θ) where:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KtJZTK8Y3F"}],"key":"atgRBNx7UV"},{"type":"math","value":"sin(θ) * cos(φ) = \\text{constant}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>φ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>constant</mtext></mrow><annotation encoding=\"application/x-tex\">sin(θ) * cos(φ) = \\text{constant}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord text\"><span class=\"mord\">constant</span></span></span></span></span></span>","enumerator":"1","key":"lLBVysErWU"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"So, for any two points (A and B) along the great circle:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vLLNAqu0Hf"}],"key":"aIBxO9TICG"},{"type":"math","value":"sin(θA) * cos(φA) = sin(θB) * cos(φB)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>φ</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>φ</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">sin(θA) * cos(φA) = sin(θB) * cos(φB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">θB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">φB</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"bIGYlkFrNI"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"So, to solve for the maximum latitude the true course should be when 90 and 270 degrees on the unit sphere where for ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"F6ywahiBiP"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"any","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Xk2lcWDtQ3"}],"key":"hHsPN610tl"},{"type":"text","value":" bearing/latitude along the great circle:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"T2hXS2Vfps"}],"key":"mZaeZpZQwO"},{"type":"math","value":"\\text{max latitude} = acos(|sin(θ) * cos(φ)|)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>max latitude</mtext><mo>=</mo><mi>a</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">∣</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>φ</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{max latitude} = acos(|sin(θ) * cos(φ)|)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">max latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"3","key":"D5KYh0DZs3"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"For the purpose of this example, we will use ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xaxwUVRfQF"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gG9JX5vPZV"},{"type":"text","value":" geodesic to determine the bearing based on a great circle arc, but consult previous sections if you want to determine bearing mathetically based on the unit sphere instead of the ellipsoid.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"nfjPzzVqtO"}],"key":"SU1DZWDM4Q"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Important Note","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"TzqxhadGF4"}],"key":"PEQNZWSPZV"}],"key":"K6i0eqeoVo"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Clairaut’s Formula works from unit sphere, and as a result, is subject to errors (about 3%, about +/- 11 degrees).","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"skKpWMGCAI"}],"key":"llF3wr77Jg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Clairaut","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Ed Williams: Clairaut’s Formula","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ZK1cDtHeP7"}],"urlSource":"https://edwilliams.org/avform147.htm#Clairaut","key":"f5IIVKRJZR"}],"key":"QoOa9em0Jr"}],"key":"uVScM3gaGg"}],"key":"w3csyjLUHh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def clairaut_formula_max(start_point=None, end_point=None):\n    geodesic = Geod(ellps=\"WGS84\")\n    fwd_bearing, _, _ =  geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                      location_df.loc[start_point, \"latitude\"],\n                                      location_df.loc[end_point, \"longitude\"],\n                                      location_df.loc[end_point, \"latitude\"])\n    # Clairaut\n    start_lat = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    max_lat = np.arccos(np.abs(np.sin(fwd_bearing) * np.cos(start_lat)))\n    return np.rad2deg(max_lat)","key":"n2EbRtLkxk"},{"type":"output","id":"qW7NyfZptQtIsMbnTgz2p","data":[],"key":"vKBfzas6sH"}],"key":"qWZ2xlfxyY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"max_lat = clairaut_formula_max(\"boulder\", \"boston\")\nprint(f\"Max latitude from Boulder to Boston: {max_lat}\")","key":"JUO0ycbzJd"},{"type":"output","id":"7kFrivMSbJ9u1yO69bDFE","data":[{"output_type":"stream","name":"stdout","text":"Max latitude from Boulder to Boston: 75.50718325253314\n"}],"key":"U1TQnlz0HQ"}],"key":"kiPqP5pqUm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Minimum Latitude on a Great Circle Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MmUYVpJJxH"}],"identifier":"minimum-latitude-on-a-great-circle-path","label":"Minimum Latitude on a Great Circle Path","html_id":"minimum-latitude-on-a-great-circle-path","implicit":true,"key":"RC8W3HH9zk"}],"key":"TKVAuhofwk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Antipodal Point of Max (TODO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cnRoU0igPo"}],"identifier":"antipodal-point-of-max-todo","label":"Antipodal Point of Max (TODO)","html_id":"antipodal-point-of-max-todo","implicit":true,"key":"gOjnrs6ur4"}],"key":"f2H62rkR1k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def antipodal(latitude=None, longitude=None):\n    anti_lat = -1 * latitude\n    if longitude > 0:\n        anti_lon = longitude - 180\n    else:\n        anti_lon = longitude + 180\n    return (anti_lat, anti_lon)","key":"OMEBjfTGpD"},{"type":"output","id":"0UdiPqlYcGV37Y_34C7LZ","data":[],"key":"uLLLnbcfLw"}],"key":"Xh26hLDPN9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Like finding maximum from a list of great circle path, the smallest latitude can be found by analysing the list for the smallest latitude point.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VRlznpSpML"}],"key":"BRv2qvte1I"}],"key":"iPoEvQlrX0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gc_lat_lon = generate_latitude_along_gc(\"boulder\", \"houston\", number_of_lon_pts=360)\nmax_lat_lon = max(gc_lat_lon, key=lambda x:x[0])\nprint(max_lat_lon)\nantipodal(max_lat_lon[0], max_lat_lon[1])","key":"HAmZtQFsyQ"},{"type":"output","id":"k0qV112g10A58g31MJzrX","data":[{"output_type":"stream","name":"stdout","text":"(np.float64(59.410929434369436), np.float64(-166.0))\n"},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"(np.float64(-59.410929434369436), np.float64(14.0))","content_type":"text/plain"}}}],"key":"D5naOPPWAQ"}],"key":"seoelhGZqs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Minimum Latitude along Great Circle Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QYBUJ86ion"}],"identifier":"minimum-latitude-along-great-circle-path","label":"Minimum Latitude along Great Circle Path","html_id":"minimum-latitude-along-great-circle-path","implicit":true,"key":"Nfu9SrzU43"}],"key":"ugRjt9qSgS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=360)\nprint(f\"Min Latitude (within 1 degree): {min(lat_lon, key=lambda x:x[0])}\")","key":"KmxDHHkZ6B"},{"type":"output","id":"faaOFom3GW-MFKhL08KQJ","data":[{"output_type":"stream","name":"stdout","text":"Min Latitude (within 1 degree): (np.float64(-42.75040694147194), np.float64(99.0))\n"}],"key":"VvEyF5Eou6"}],"key":"N7o2xa5iOR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=720)\nprint(f\"Min Latitude (within 0.5 degree): {min(lat_lon, key=lambda x:x[0])}\")","key":"ftbHzGW25R"},{"type":"output","id":"Bj-D_7QhjW-4a2_BGwPZj","data":[{"output_type":"stream","name":"stdout","text":"Min Latitude (within 0.5 degree): (np.float64(-42.75138847183453), np.float64(99.5))\n"}],"key":"bF7fmZsLXJ"}],"key":"jesstKrpLv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=1080)\nprint(f\"Min Latitude (within 0.3 degree): {min(lat_lon, key=lambda x:x[0])}\")","key":"l5JfbfU02C"},{"type":"output","id":"LTaFEXaf_eKbvXPsuGWAL","data":[{"output_type":"stream","name":"stdout","text":"Min Latitude (within 0.3 degree): (np.float64(-42.7513029587961), np.float64(99.33333333333331))\n"}],"key":"vjVm3R5PhE"}],"key":"mNu8OpEARu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gc_lat_lon = generate_latitude_along_gc(\"boulder\", \"boston\", number_of_lon_pts=360)\nmin_lat_lon = min(gc_lat_lon, key=lambda x:x[0])\nplot_coordinate_max_min(great_circle_pts=gc_lat_lon,\n                            min_coord=min_lat_lon,\n                            title=f\"Min Latitude located at {min_lat_lon}\")","key":"S3KhSNgslF"},{"type":"output","id":"5x-7aZ54_J_-ULyjCmaFt","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"48cd0e75238d32272560c26dd35f34fb","path":"/great-circle-cookbook/build/48cd0e75238d32272560c26dd35f34fb.png"}}}],"key":"GGiT2f0173"}],"key":"P4dXv5yu0T"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Maximumn Latitude from Clairaut’s Formula","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wNvorYDM6f"}],"identifier":"maximumn-latitude-from-clairauts-formula","label":"Maximumn Latitude from Clairaut’s Formula","html_id":"maximumn-latitude-from-clairauts-formula-1","implicit":true,"key":"qZFmQU7Ei3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To solve for the minimum, the true course should be when 0 and 180 degrees on the unit sphere where for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vm9qiHLzsX"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"any","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mLLc4ZR7IZ"}],"key":"gwoLGM4eVW"},{"type":"text","value":" bearing/latitude along the great circle:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NYrWBGzDeZ"}],"key":"BJ5zhuJOJo"},{"type":"math","value":"\\text{min latitude} = asin(|sin(θ) * cos(φ)|)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>min latitude</mtext><mo>=</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">∣</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>φ</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{min latitude} = asin(|sin(θ) * cos(φ)|)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">min latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">φ</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"joIGj5pqsB"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The southernmost point is the antipode to the northernmost (max) latitude.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wPnLdvjgzP"}],"key":"TssPqIbeYS"}],"key":"ZjVWSEks0c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def clairaut_formula_min(start_point=None, end_point=None):\n    geodesic = Geod(ellps=\"WGS84\")\n    fwd_bearing, _, _ =  geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                      location_df.loc[start_point, \"latitude\"],\n                                      location_df.loc[end_point, \"longitude\"],\n                                      location_df.loc[end_point, \"latitude\"])\n    # Clairaut Formula\n    start_lat = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    min_lat = np.arcsin(np.abs(np.cos(fwd_bearing) * np.sin(start_lat)))\n    return np.rad2deg(min_lat)","key":"kkvJoyKfP1"},{"type":"output","id":"9QXck-U6GSGPkPPk1Ba-o","data":[],"key":"S3yGG8nU5q"}],"key":"mLAqR65iLu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"min_lat = clairaut_formula_min(\"boulder\", \"boston\")\nprint(f\"Min latitude along great circle path from Boulder to Boston: {min_lat}\")","key":"Dt0aLsO6OJ"},{"type":"output","id":"oU31Dv9lzuGT8FD5oh_rZ","data":[{"output_type":"stream","name":"stdout","text":"Min latitude along great circle path from Boulder to Boston: 17.49699780715814\n"}],"key":"pAmAXVZOK3"}],"key":"xTlhc93RSe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine when great circle path cross parallels (TODO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AWsRhlrhVz"}],"identifier":"determine-when-great-circle-path-cross-parallels-todo","label":"Determine when great circle path cross parallels (TODO)","html_id":"determine-when-great-circle-path-cross-parallels-todo","implicit":true,"key":"kHGMIF13Mz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Determine the longitude when a great circle crosses a given latitude parrellel.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N2Y9FcB3MQ"}],"key":"Hz78PAT8l5"}],"key":"iCSJWIwakT"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LNrfMoJZ0y"}],"key":"hxo8A9jwkF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kygTA98B3V"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"vlSttPRSJB"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Determine the coordinates when a great circle path crosses a specific parallel as well as the maximumn and minimum latitude coordinates.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vntAQq2Ikf"}],"key":"L7GVdVAWBN"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mUAUStN8SX"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"XZFzkTFb32"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Intersections of Great Circles.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SUlL3DObeh"}],"key":"l7988Tgrha"}],"key":"sdA81na4DO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HbjgtInwBc"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"fzWistQ2M7"}],"key":"gnSb2e6jsq"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aviation Formulary V1.47","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nCQA4FAosO"}],"urlSource":"https://edwilliams.org/avform147.htm","key":"xV9lQMJOwL"}],"key":"LcuMHVcHIM"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Moveable Type Script","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BNIdlWBhwh"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html","key":"jede8vJwkj"}],"key":"PhBO1FKFmL"}],"key":"t8RJA5oaCN"}],"key":"ZXHd3qUuRW"}],"key":"KvT5NeZ0Hu"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Great Circles and a Point","url":"/notebooks/tutorials/arc-to-point","group":"Tutorials"},"next":{"title":"Intersections of Great Circles","url":"/notebooks/tutorials/path-intersection","group":"Tutorials"}}},"domain":"http://localhost:3000"}