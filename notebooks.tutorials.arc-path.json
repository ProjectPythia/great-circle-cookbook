{"version":2,"kind":"Notebook","sha256":"b6542967f9047dcb12ca44c47996c9868ac1f4e4f08114bf1d46b41e505f8fd7","slug":"notebooks.tutorials.arc-path","location":"/notebooks/tutorials/1_arc_path.ipynb","dependencies":[],"frontmatter":{"title":"Great Circle Arcs and Path","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Cora Schneck","given":"Cora","family":"Schneck"},"name":"Cora Schneck","orcid":"0009-0009-1415-5170","affiliations":["NSF National Center for Atmospheric Research"],"id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-1"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/great-circle-cookbook","copyright":"2025","affiliations":[{"id":"NSF National Center for Atmospheric Research","name":"NSF National Center for Atmospheric Research"},{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/great-circle-cookbook/blob/main/notebooks/tutorials/1_arc_path.ipynb","thumbnail":"/great-circle-cookbook/build/17b783c8f9a45f5f402dc3edacb2de26.gif","exports":[{"format":"ipynb","filename":"1_arc_path.ipynb","url":"/great-circle-cookbook/build/1_arc_path-08930fd59c4edaabb6ac1031a258650f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/great-circle-cookbook/build/17b783c8f9a45f5f402dc3edacb2de26.gif","alt":"Indiana Jones Plane Flying Gif","key":"Zb4VdNurlC","urlSource":"https://j.gifs.com/vO2k6P.gif"}],"key":"Pqsjsqa0zd"}],"key":"mY71TF69sP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Great Circle Arcs and Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UCeMluEUtT"}],"identifier":"great-circle-arcs-and-path","label":"Great Circle Arcs and Path","html_id":"great-circle-arcs-and-path","implicit":true,"key":"szyFMR7HJ1"}],"key":"JhL2YGvwIa"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IABSgeOVqq"}],"key":"LVmei6wJnB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZQVGeQS0TN"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"H73ToAsgdK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Imagine you are on a plane flying from Cario to Hong Kong. As a passenger, the plane appears to travel a straight path from one airport to the next. However, in reality, as the plane travels it actually curves along the surface of Earth held down by the gravity of the planet.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t37bLqn4UZ"}],"key":"bze1G4OJdj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The “straight line” has become an arc connecting Cario and Hong Kong on a map. This arc is a great circle arc, just one small subsection of the great circle path.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CpfH0tYl8a"}],"key":"c8Iv10Tgn7"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Distance between Points on a Great Circle Arc","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rTOrPB9Uci"}],"key":"jZmMgSYDBb"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Convert Spherical Distance to Degrees","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sBurntAShb"}],"key":"TwiaEMzDzc"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Determine the Bearing of a Great Circle Arc","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NIgHRV3AEl"}],"key":"l6VYSMCkHh"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Arc with Intermediate Points","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"yQ8QZNczRS"}],"key":"WBxDgjaTjc"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Determine the Midpoint of a Great Circle Arc","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OjC8pygv0w"}],"key":"IJYxwQKBm6"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Path","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qwZnhighe2"}],"key":"iIjpHEt8wO"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Determine an Antipodal Point","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LG4Ha32RPn"}],"key":"j1K1XuZ56w"}],"key":"TRNqeEWQj2"}],"key":"lJu5H9M0RI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b2zIWBA3jb"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"CWIp5joqwx"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nLXKXC0Z44"}],"key":"T5vM5w1064"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JxeJqmym8L"}],"key":"NsxwFJuQXB"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IgxPJBzS2X"}],"key":"FqQThX3uhK"}],"key":"UAj3JZKYy5"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/numpy/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Numpy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fk0tU9nC7b"}],"urlSource":"https://foundations.projectpythia.org/core/numpy/","key":"Sddj48iHkc"}],"key":"J7a2iLzs41"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"d2evnKf7Un"}],"key":"az7WNXr96q"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Used to work with large arrays","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WxrbQUcEDx"}],"key":"KvB7dTkK7E"}],"key":"EGJqAmdO22"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Pandas","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HHzlvQNuRJ"}],"urlSource":"https://foundations.projectpythia.org/core/pandas","key":"w6h8GcjkAt"}],"key":"oGbD1A1aAB"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"I8a5sRJGQF"}],"key":"vM1zTUf9fl"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Used to read in and organize data (in particular dataframes)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nsu79hyj4t"}],"key":"Sdaely2HVe"}],"key":"ZnbRGjaiTM"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Intro to Cartopy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lNEnqRiIAj"}],"urlSource":"https://foundations.projectpythia.org/core/cartopy","key":"Hs9tiNhRMt"}],"key":"AoS7gaznOI"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"s5ZaqkkA3X"}],"key":"Jw9ZFYDLrO"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Will be used for adding maps to plotting","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"W1kgbAljcD"}],"key":"ObTtSkXu0B"}],"key":"VOsQvO7BrT"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/matplotlib/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vUiQTbrp3G"}],"urlSource":"https://foundations.projectpythia.org/core/matplotlib/","key":"u3gDwRYEwM"}],"key":"aa2T0JY5zq"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zXs7yYwK7o"}],"key":"oRNqDDx40D"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Will be used for plotting","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NEt9e8kVVj"}],"key":"alkGfDbMKm"}],"key":"BsZR8Zm3zz"}],"key":"YC3Z1WoBTY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kWxIZY8lk1"}],"key":"MUdXnHZZE4"},{"type":"text","value":": 40 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QWk7lU4w6M"}],"key":"glJjvJCjsb"}],"key":"hvM05DHmgw"}],"key":"LDsSAObIpY"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"afQU6yvErF"}],"key":"PMwMqHVr0C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YtHyXHewqb"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"LH3mAW8P2E"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To begin, let’s import the packages we will need in this notebook and collect the list of locations coordinates","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jVq5BbuYjM"}],"key":"hBquRcHcyF"}],"key":"KuskizZWm1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd       # reading in data for location information from text file\nimport numpy as np        # working with arrays, vectors, cross/dot products, and radians\n\nfrom pyproj import Geod   # working with the Earth as an ellipsod (WGS-84)\nimport geopy.distance     # working with the Earth as an ellipsod (WGS-84)\n\nimport matplotlib.pyplot as plt    # Plotting a figure\nfrom cartopy import crs as ccrs, feature as cfeature  # Add World Map to Plot","key":"NhUy2OMrVx"},{"type":"output","id":"-K51ukIPXgqlc3FTXOama","data":[],"key":"xRrCmN5C01"}],"key":"J8XbKOLHfv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the coordinates for locations with all coordinates\nlocation_df = pd.read_csv(\"../location_full_coords.txt\")\nlocation_df = location_df.rename(columns=lambda x: x.strip()) # strip excess white space from column names and values\nlocation_df.head()","key":"F1fJn1dJuG"},{"type":"output","id":"HVZO3-CQtiCLcxgYQZzxM","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"       name  latitude  longitude    cart_x    cart_y    cart_z  rho     theta  \\\n0   arecibo   18.3441   -66.7527  0.374643 -0.872119  0.314723  1.0 -1.165054   \n1   boulder   40.0150  -105.2705 -0.201714 -0.738835  0.642988  1.0  1.304276   \n2    boston   42.3601   -71.0589  0.239852 -0.698914  0.673788  1.0 -1.240212   \n3  redwoods   41.4017  -124.0417 -0.419898 -0.621549  0.661334  1.0  0.976657   \n4   houston   29.5518   -95.0982 -0.077303 -0.866469  0.493210  1.0  1.481816   \n\n        phi       polar_x       polar_y       polar_z  \n0  1.250631 -5.562495e+06  2.389526e+06  2.007347e+06  \n1  0.872403 -4.712394e+06 -1.286558e+06  4.101066e+06  \n2  0.831473 -4.457769e+06  1.529809e+06  4.297512e+06  \n3  0.848200 -3.964322e+06 -2.678169e+06  4.218080e+06  \n4  1.055020 -5.526456e+06 -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>0.374643</td>\n      <td>-0.872119</td>\n      <td>0.314723</td>\n      <td>1.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-0.201714</td>\n      <td>-0.738835</td>\n      <td>0.642988</td>\n      <td>1.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>0.239852</td>\n      <td>-0.698914</td>\n      <td>0.673788</td>\n      <td>1.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-0.419898</td>\n      <td>-0.621549</td>\n      <td>0.661334</td>\n      <td>1.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-0.077303</td>\n      <td>-0.866469</td>\n      <td>0.493210</td>\n      <td>1.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"uGW4awpsvT"}],"key":"zLiilTiXy9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set index to the name column, this will make it easier to access each row\nlocation_df.index = location_df[\"name\"]\nlocation_df.head()","key":"IdZ1sGZES6"},{"type":"output","id":"pEV7vd5T1Zs9-6VZSNxxT","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"              name  latitude  longitude    cart_x    cart_y    cart_z  rho  \\\nname                                                                         \narecibo    arecibo   18.3441   -66.7527  0.374643 -0.872119  0.314723  1.0   \nboulder    boulder   40.0150  -105.2705 -0.201714 -0.738835  0.642988  1.0   \nboston      boston   42.3601   -71.0589  0.239852 -0.698914  0.673788  1.0   \nredwoods  redwoods   41.4017  -124.0417 -0.419898 -0.621549  0.661334  1.0   \nhouston    houston   29.5518   -95.0982 -0.077303 -0.866469  0.493210  1.0   \n\n             theta       phi       polar_x       polar_y       polar_z  \nname                                                                    \narecibo  -1.165054  1.250631 -5.562495e+06  2.389526e+06  2.007347e+06  \nboulder   1.304276  0.872403 -4.712394e+06 -1.286558e+06  4.101066e+06  \nboston   -1.240212  0.831473 -4.457769e+06  1.529809e+06  4.297512e+06  \nredwoods  0.976657  0.848200 -3.964322e+06 -2.678169e+06  4.218080e+06  \nhouston   1.481816  1.055020 -5.526456e+06 -4.930480e+05  3.145762e+06  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>latitude</th>\n      <th>longitude</th>\n      <th>cart_x</th>\n      <th>cart_y</th>\n      <th>cart_z</th>\n      <th>rho</th>\n      <th>theta</th>\n      <th>phi</th>\n      <th>polar_x</th>\n      <th>polar_y</th>\n      <th>polar_z</th>\n    </tr>\n    <tr>\n      <th>name</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>arecibo</th>\n      <td>arecibo</td>\n      <td>18.3441</td>\n      <td>-66.7527</td>\n      <td>0.374643</td>\n      <td>-0.872119</td>\n      <td>0.314723</td>\n      <td>1.0</td>\n      <td>-1.165054</td>\n      <td>1.250631</td>\n      <td>-5.562495e+06</td>\n      <td>2.389526e+06</td>\n      <td>2.007347e+06</td>\n    </tr>\n    <tr>\n      <th>boulder</th>\n      <td>boulder</td>\n      <td>40.0150</td>\n      <td>-105.2705</td>\n      <td>-0.201714</td>\n      <td>-0.738835</td>\n      <td>0.642988</td>\n      <td>1.0</td>\n      <td>1.304276</td>\n      <td>0.872403</td>\n      <td>-4.712394e+06</td>\n      <td>-1.286558e+06</td>\n      <td>4.101066e+06</td>\n    </tr>\n    <tr>\n      <th>boston</th>\n      <td>boston</td>\n      <td>42.3601</td>\n      <td>-71.0589</td>\n      <td>0.239852</td>\n      <td>-0.698914</td>\n      <td>0.673788</td>\n      <td>1.0</td>\n      <td>-1.240212</td>\n      <td>0.831473</td>\n      <td>-4.457769e+06</td>\n      <td>1.529809e+06</td>\n      <td>4.297512e+06</td>\n    </tr>\n    <tr>\n      <th>redwoods</th>\n      <td>redwoods</td>\n      <td>41.4017</td>\n      <td>-124.0417</td>\n      <td>-0.419898</td>\n      <td>-0.621549</td>\n      <td>0.661334</td>\n      <td>1.0</td>\n      <td>0.976657</td>\n      <td>0.848200</td>\n      <td>-3.964322e+06</td>\n      <td>-2.678169e+06</td>\n      <td>4.218080e+06</td>\n    </tr>\n    <tr>\n      <th>houston</th>\n      <td>houston</td>\n      <td>29.5518</td>\n      <td>-95.0982</td>\n      <td>-0.077303</td>\n      <td>-0.866469</td>\n      <td>0.493210</td>\n      <td>1.0</td>\n      <td>1.481816</td>\n      <td>1.055020</td>\n      <td>-5.526456e+06</td>\n      <td>-4.930480e+05</td>\n      <td>3.145762e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"key":"i4mxrsIoS6"}],"key":"DEk0NyUWYz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Distance Between Points on a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j7fQCVtK9p"}],"identifier":"distance-between-points-on-a-great-circle-arc","label":"Distance Between Points on a Great Circle Arc","html_id":"distance-between-points-on-a-great-circle-arc","implicit":true,"key":"EwDY5MROsw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can determine the distance between two points A and B (for example, Cario and Hong Kong) both by hand mathematically and with Python packages like ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YWRoFXl9uP"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H9uvZ2DAJi"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aSPcBXWkr4"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DpT58ar8QL"}],"key":"UvJmOi9ap7"}],"key":"wVAR2Q0J17"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Distance Between Points Mathematically via Unit Sphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fJ1kAJheDH"}],"identifier":"determine-distance-between-points-mathematically-via-unit-sphere","label":"Determine Distance Between Points Mathematically via Unit Sphere","html_id":"determine-distance-between-points-mathematically-via-unit-sphere","implicit":true,"key":"ZjqT9wEhpR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Unit sphere refers to a sphere with a radius of 1, for the purpose of this cookbook, when we are using a unit sphere to represent Earth, it is a perfect sphere that has been multiplied by 6378137 meters","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZiTpIDU1HY"}],"key":"Sr3nWv8Zku"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"First, to measure the distance between point A (latA, lonA) and point B (latB, lonB) on a unit sphere (radius = 1)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mSLH1PXdaM"}],"key":"Thaje2chvZ"},{"type":"math","value":"d=acos(sin(latA)*sin(latB)+cos(latA)*cos(latB)*cos(lonA-lonB))","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=acos(sin(latA)*sin(latB)+cos(latA)*cos(latB)*cos(lonA-lonB))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"1","key":"SqmNYEYkZ8"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Because of the translation when working with radians and degrees, there is a mathematically equivalent formula that works better when working with shorter distances (to produce less rounding errors):","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JPDxndCLLI"}],"key":"RZ1EfBN4I6"},{"type":"math","value":"d=2*asin(\\sqrt{sin(\\frac{latA-latB}{2})^2 + cos(latA)*cos(latB)*sin(\\frac{lonA-lonB}{2})^2})","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mi>a</mi><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi></mrow><mn>2</mn></mfrac><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=2*asin(\\sqrt{sin(\\frac{latA-latB}{2})^2 + cos(latA)*cos(latB)*sin(\\frac{lonA-lonB}{2})^2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.44em;vertical-align:-0.7634em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6766em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.6366em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7634em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"2","key":"b2zDOxnTIl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Dist","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"See more: Distance Between Points","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"auz3HEfQHu"}],"urlSource":"https://edwilliams.org/avform147.htm#Dist","key":"f153GxqMQ9"}],"key":"EaL1meIVby"}],"key":"o5xg3mbSg8"}],"key":"SXGk5zW978"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now translate these equations for measuring the distance between two points (the great circle arc distance) into Python and multiply the result by the Earth’s radius.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ozMZ9kD6lP"}],"key":"DjYXGGO03J"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"These equations use a locations’s latitude/longtiude coordinates, which we can access in a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YZnb6EUc4u"},{"type":"inlineCode","value":"pandas","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R1Q58cpfRQ"},{"type":"text","value":" dataframe with the name of the location and which coordinate type we would like, for example:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wTIhYcig2F"}],"key":"XRz8SjIKgN"}],"key":"d7U4SijS7J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"Boulder latitude: {location_df.loc[\"boulder\", \"latitude\"]}\")\nprint(f\"Boulder longitude: {location_df.loc[\"boulder\", \"longitude\"]}\")","key":"WX7sSZk984"},{"type":"output","id":"ydQMRU6k9pqQLrWAWwoW0","data":[{"output_type":"stream","name":"stdout","text":"Boulder latitude: 40.015\nBoulder longitude: -105.2705\n"}],"key":"MibN27DVCB"}],"key":"HJEYHYoAKV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below, Equation 1 has become ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zitSaJtW2G"},{"type":"inlineCode","value":"distance_between_points_default","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ov3IQtDaM3"},{"type":"text","value":" since this is the equation we will use for most equations, but Equation 2 has become ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J8pIxhiURm"},{"type":"inlineCode","value":"distance_between_points_small","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CE9F93qFQ9"},{"type":"text","value":" for working with small distances that are less prone to rounding errors. We can call both equations to compare outputs to see how they are mathematically equivalent. By hand, Equation 1 is a faster calculation than Equation 2, but when working with Python both of these functions will run nearly as quickly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WBbTPxQEMx"}],"key":"teLrBkrF0N"}],"key":"xgTzJ5KE74"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_between_points_default(start_point=None, end_point=None):\n    earth_radius = 6378137  # meters\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    distance_default = np.arccos(np.sin(latA)*np.sin(latB)+np.cos(latA)*np.cos(latB)*np.cos(lonA-lonB))\n    return distance_default * earth_radius","key":"AOmjv2SHnK"},{"type":"output","id":"a03x9mPOOu4SxhB1-apff","data":[],"key":"xfuiZPcSkx"}],"key":"FKJOivCfew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_between_points_small(start_point=None, end_point=None):\n    earth_radius = 6378137  # meters\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    distance_small = 2 * np.arcsin(np.sqrt((np.sin((latA-latB)/2))**2 + np.cos(latA)*np.cos(latB)*(np.sin((lonA-lonB)/2))**2))\n    return distance_small * earth_radius","key":"Mhpdc6e475"},{"type":"output","id":"lLFTX2ZInD0aM6jU927ai","data":[],"key":"vhst6aL3y7"}],"key":"z07FWxKvoP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sidenote: Additional Formulas","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lx7qogSQzw"}],"identifier":"sidenote-additional-formulas","label":"Sidenote: Additional Formulas","html_id":"sidenote-additional-formulas","implicit":true,"key":"asNaMKutoD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While we will be focusing on Equation 1 and Equation 2 for our calculations in the future, there are even more methods to calculate the distance between points on a sphere. Each formula has different degrees of precision based on which ellipsoid or sphere is used:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ImNgkn94sv"}],"key":"IFo5MPp8kK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Haversine_formula","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Haversine Formula","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mK07Bidt1O"}],"urlSource":"https://en.wikipedia.org/wiki/Haversine_formula","data":{"page":"Haversine_formula","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"K09xcv1pEg"}],"key":"K6e3WbErJJ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Vincenty%27s_formulae","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Vincenty’s Formula","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"diGF4dBUKf"}],"urlSource":"https://en.wikipedia.org/wiki/Vincenty%27s_formulae","data":{"page":"Vincenty%27s_formulae","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"o6Ri672tDq"}],"key":"YXZzhDz5Hu"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://search.r-project.org/CRAN/refmans/geosphere/html/distMeeus.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Meeus Great Circle Distance","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pDZtruUNLx"}],"urlSource":"https://search.r-project.org/CRAN/refmans/geosphere/html/distMeeus.html","key":"aOQpJtfrWh"}],"key":"YyOWam5hPu"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://www.rdocumentation.org/packages/geosphere/versions/1.5-20/topics/distCosine","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Law of Cosines Great Circle Distance","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wei5IbIHjH"}],"urlSource":"https://www.rdocumentation.org/packages/geosphere/versions/1.5-20/topics/distCosine","key":"HFrHrFm1tP"}],"key":"GwlhRpzr86"}],"key":"U6Cvr8a2LH"}],"key":"o3hMyHq2rb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Distance Points via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bpiTYxcgKz"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVYZA2TCWc"}],"identifier":"determine-distance-points-via-python-package-pyproj","label":"Determine Distance Points via Python Package pyproj","html_id":"determine-distance-points-via-python-package-pyproj","implicit":true,"key":"SGOs1e920G"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While great circle distances can be determine mathematically, there are some Python packages that account for the fact that the Earth is not a perfect sphere that will be easier to work than relying entirely on the equations derived above. For example, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GeSZGfP9CY"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DAq1pHLI8s"},{"type":"text","value":" treats the Earth as an ellipsoid, by default specifically ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u0GwFGXuB9"},{"type":"inlineCode","value":"WGS-84","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vmQCRpKnJz"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OgwaclxgVJ"}],"key":"A9GjT8Uove"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/World_Geodetic_System","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"WGS-84 is the World Geodetic System","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hgm9q1YqnR"}],"urlSource":"https://en.wikipedia.org/wiki/World_Geodetic_System","data":{"page":"World_Geodetic_System","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"sEkGz5OYI5"},{"type":"text","value":" and considered to be the current standard for geodesy and working with satellite. It is an geocentric and is consistent to within 1 meter around the globe.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uCrwMj9yFH"}],"key":"thz5tUEhvF"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To begin, let use use ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lOA4hcuQEo"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xmkYNAssnF"},{"type":"text","value":" to set up an ellipsoid (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lP5Xi31jPQ"},{"type":"inlineCode","value":"WGS-84","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gL410xDqkn"},{"type":"text","value":") that will represent the Earth.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QPduzTlEzf"}],"key":"TcqKFTDPfZ"}],"key":"RMa9CBaPst"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_pyproj(start_pt=None, end_pt=None):\n    geodesic = Geod(ellps=\"WGS84\") # setup ellipsoid\n\n    # Return the distance between two points (for example, Boulder and Boston)\n    _, _, distance_meter =  geodesic.inv(location_df.loc[start_pt, \"longitude\"],\n                                         location_df.loc[start_pt, \"latitude\"],\n                                         location_df.loc[end_pt, \"longitude\"],\n                                         location_df.loc[end_pt, \"latitude\"])\n    \n    return distance_meter","key":"hfYpXh4YnN"},{"type":"output","id":"IDpFUppgr6DxEvgRdBmnF","data":[],"key":"K4z6cv7c9F"}],"key":"AHA0xjKH6C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Find the distance between Boulder and Boston\ndistance_meter = distance_pyproj(\"boulder\", \"boston\")\nprint(f\"Distance between coordinates (ellipsoid)   = {distance_meter/1000} km\")","key":"hsyxzwiBAV"},{"type":"output","id":"1eKpJUwzIIy_lpslKf5Ar","data":[{"output_type":"stream","name":"stdout","text":"Distance between coordinates (ellipsoid)   = 2862.5974799145215 km\n"}],"key":"sxefjULZr9"}],"key":"TY6Bmnzt0G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That is much easier! We can compare ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uonrYmh8OV"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OeQd2AtyZG"},{"type":"text","value":" to the output from the equations (1 and 2) that we calculated above:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UpDBchWQrJ"}],"key":"bnH08toCxw"}],"key":"IQhn4CcspO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nprint(f\"Distance between coordinates (unit sphere) = {distance_unit_sphere_default/1000} km\")\ndistance_unit_sphere_small = distance_between_points_small(\"boulder\", \"boston\")\nprint(f\"Distance between coordinates (unit sphere) = {distance_unit_sphere_small/1000} km\")","key":"UrKM3YMzXq"},{"type":"output","id":"it54AB4oBDeNyiewKtRM4","data":[{"output_type":"stream","name":"stdout","text":"Distance between coordinates (unit sphere) = 2858.532213639344 km\nDistance between coordinates (unit sphere) = 2858.5322136393447 km\n"}],"key":"Qi8zfTGZ8l"}],"key":"hv9fpjLWP3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both equations we calculated above slightly underestimate the distance between Boston and Boulder because they assume the Earth is a perfect sphere, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MC33qpnWSE"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rd339asSCw"},{"type":"text","value":" accounts for ellipse.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jQBl3IH59S"}],"key":"JMVGrkUiD1"}],"key":"ctkrKvUPt2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert Spherical Distance to Degrees","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cc26LkmDnN"}],"identifier":"convert-spherical-distance-to-degrees","label":"Convert Spherical Distance to Degrees","html_id":"convert-spherical-distance-to-degrees","implicit":true,"key":"PV73DpjjtN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sometimes when you are working with a map, you don’t always just need a distance in meters or kilometers. We can also convert the distances calculated back into degrees as needed. To convert a distance from meters to degrees, we will assume that the great circle is on a unit sphere with a constant spherical radius of ~6371 km (mean radius of Earth).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KHyGf1bstN"}],"key":"I3OM6MDGjr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Side note: The Python library ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zmREgaIVqb"},{"type":"inlineCode","value":"ObsPy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WEZcMiv1ED"},{"type":"text","value":" has a similar function built-in: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xHgqygOC7f"},{"type":"link","url":"https://docs.obspy.org/packages/autogen/obspy.geodetics.base.kilometer2degrees.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ObsPy ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Py439Yh8lL"},{"type":"inlineCode","value":"kilometer2degrees()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CRKdpoM7SP"}],"urlSource":"https://docs.obspy.org/packages/autogen/obspy.geodetics.base.kilometer2degrees.html","key":"b9iUBFmw0v"}],"key":"U3zppfD9ep"}],"key":"jO4Hbciyzv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"earth_radius = 6378.137 # km\n\ndef km_to_degree_distance(distance_km=None):\n    return distance_km / (2 * earth_radius * np.pi / 360)\n\ndef degree_to_km_distance(distance_degree=None):\n    return distance_degree * (2 * earth_radius * np.pi / 360)","key":"LN0YYF2uwW"},{"type":"output","id":"aGQH3XZeHw-igrknIaPyI","data":[],"key":"BzfZwAJdUj"}],"key":"EzGa3WzHcg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# We can convert back and form between kilometers and degrees\nprint(f\"300 km to degrees = {km_to_degree_distance(300)} degrees\")\nprint(f\"2.6949458523585643 degree to km = {degree_to_km_distance(2.6949458523585643)} km\")","key":"x0REf6LNV6"},{"type":"output","id":"yUP20L_7FCqfJDVqoCptw","data":[{"output_type":"stream","name":"stdout","text":"300 km to degrees = 2.6949458523585643 degrees\n2.6949458523585643 degree to km = 300.0 km\n"}],"key":"vGos4wcE32"}],"key":"c1tqf02Fp8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing of a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xa0BUeHY4Y"}],"identifier":"determine-the-bearing-of-a-great-circle-arc","label":"Determine the Bearing of a Great Circle Arc","html_id":"determine-the-bearing-of-a-great-circle-arc","implicit":true,"key":"M97mPJSjib"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Arcs are not just a distance, but a direction. Now, we can calculate the direction that an arc takes as it moves from Point A to Point B also known as the bearing.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QLE9XnajlZ"}],"key":"eW0ElVNWrw"}],"key":"A9Dm3r8WaC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing Mathematically via Unit Sphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WyMRbU3LQu"}],"identifier":"determine-the-bearing-mathematically-via-unit-sphere","label":"Determine the Bearing Mathematically via Unit Sphere","html_id":"determine-the-bearing-mathematically-via-unit-sphere","implicit":true,"key":"Y4bfpTXoP8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The bearing between between Point A (latA, lonA) and Point B (latB, lonB) on a unit sphere can be calculated as:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yq3JdUlDAg"}],"key":"ZDOg1aWHyJ"},{"type":"math","value":"x = cos(latA) * sin(latB) - sin(latA) * cos(latB) * cos(lonB - lonA)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = cos(latA) * sin(latB) - sin(latA) * cos(latB) * cos(lonB - lonA)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"3","key":"QI2KWF1h2K"},{"type":"math","value":"y = sin(lonB - lonA) * cos(latB)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = sin(lonB - lonA) * cos(latB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"fSUq0Oo4Hq"},{"type":"math","value":"θ = atan2(y, x)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">θ = atan2(y, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"5","key":"ia9fVUqs74"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html#bearing","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Movable Type: Bearing","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"moMfjVh3dk"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html#bearing","key":"PLXolVLY2E"}],"key":"h8xgEaH6af"}],"key":"aoWyB3Rmx9"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This can be similarly converted to Python as:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CfXXI8nLCs"}],"key":"zPrCE8BuY5"}],"key":"s1uTKjHiqO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def bearing_between_points_unit_sphere(start_point=None, end_point=None):\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    x = np.cos(latA) * np.sin(latB) - np.sin(latA) * np.cos(latB) * np.cos(lonB - lonA)\n    y = np.sin(lonB - lonA) * np.cos(latB)\n    bearing = np.arctan2(y, x)\n    return np.rad2deg(bearing) % 360","key":"u4Q1WPTHyg"},{"type":"output","id":"C9BSR7u_JHdugVAqjM81h","data":[],"key":"E6Ue9CogqD"}],"key":"qXD7l5Mykf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Bearing via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r5GWQti2EA"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9Tymz4WjL"}],"identifier":"determine-the-bearing-via-python-package-pyproj","label":"Determine the Bearing via Python Package pyproj","html_id":"determine-the-bearing-via-python-package-pyproj","implicit":true,"key":"Ei6ZIuBFGD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AjHclgxQYP"},{"type":"text","value":" can also use the same ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EzNWktMETz"},{"type":"inlineCode","value":"geodesic.inv()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fj5YnpVttV"},{"type":"text","value":" function to calculate bearing. However, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RGYQaeHGqx"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U8Gl3eYbXO"},{"type":"text","value":" includes both the forward and reverse bearing. Forward bearing refers to the bearing from Point A to Point B, while the reverse bearing is the bearing from Point B to Point A. The reverse bearing is returned as a negative angle, but it can also be calculated as the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c7ktAm3JXM"},{"type":"inlineCode","value":"Forward Bearing - 360","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tlGJF8TR44"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T6rlYQPqu9"}],"key":"NXLyHXTBdy"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For example, to find the bearing from Boulder and Boston:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DjXwOJISLm"}],"key":"Jg4qQQ2tjH"}],"key":"j4GzpVrPWI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"geodesic = Geod(ellps=\"WGS84\")\nfwd_bearing, rvs_bearing, _ =  geodesic.inv(location_df.loc[\"boulder\", \"longitude\"],\n                                             location_df.loc[\"boulder\", \"latitude\"],\n                                             location_df.loc[\"boston\", \"longitude\"],\n                                             location_df.loc[\"boston\", \"latitude\"])\nprint(f\"Forward Bearing: {fwd_bearing}\")\nprint(f\"Reverse Bearing: {rvs_bearing} ({rvs_bearing%360})\")","key":"nXbQwcA6Be"},{"type":"output","id":"CkfnW3S0waJZlH3QKBjI8","data":[{"output_type":"stream","name":"stdout","text":"Forward Bearing: 73.51048829569022\nReverse Bearing: -83.57035585674933 (276.4296441432507)\n"}],"key":"ZH0NEKqqBI"}],"key":"ULwq5dsGdh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When referring to bearing however, it is typically assumed to be referring to the forward bearing, so we will use the function below as we move forward.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rqA1iXXnM9"}],"key":"FYtPTPS0yU"}],"key":"q8FVXqo4Rv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def bearing_between_points_ellps(start_point=None, end_point=None):\n    geodesic = Geod(ellps=\"WGS84\")\n    fwd_bearing, _, _ =  geodesic.inv(location_df.loc[start_point, \"longitude\"],\n                                        location_df.loc[start_point, \"latitude\"],\n                                        location_df.loc[end_point, \"longitude\"],\n                                        location_df.loc[end_point, \"latitude\"])\n    return fwd_bearing","key":"RMQDuvySPl"},{"type":"output","id":"iSUAu05Oarf2trNkvj5yY","data":[],"key":"lW30Thaskr"}],"key":"BxpjgZ3qt0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Because of the slightly flattened shape of an ellipsoid compared to a sphere, the bearing can also vary depending on if you are calculating bearing on a unit sphere or a ellipsoid:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CfZKNOPVS9"}],"key":"UH62umEFTo"}],"key":"x2OlbcZ0nT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"### Compare Unit Sphere and Ellipsoid\nbeaing_ellps = bearing_between_points_ellps(\"boulder\", \"boston\")\nprint(f\"forward bearing between coordinates (ellipsoid)   = {beaing_ellps} Degrees\")\nbearing_us = bearing_between_points_unit_sphere(\"boulder\", \"boston\")\nprint(f\"forward bearing between coordinates (unit sphere) = {bearing_us} Degrees\")","key":"I8rOO2jQIF"},{"type":"output","id":"T4EqU9auWJvuIECkthZAZ","data":[{"output_type":"stream","name":"stdout","text":"forward bearing between coordinates (ellipsoid)   = 73.51048829569022 Degrees\nforward bearing between coordinates (unit sphere) = 73.49180375272644 Degrees\n"}],"key":"slRS2YJ3vS"}],"key":"NGZWB76KfV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generating a Great Circle Arc with Intermediates Points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fExk3oDrow"}],"identifier":"generating-a-great-circle-arc-with-intermediates-points","label":"Generating a Great Circle Arc with Intermediates Points","html_id":"generating-a-great-circle-arc-with-intermediates-points","implicit":true,"key":"f7JCtIpCws"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we have calculated both the length of a great circle arc as well as its bearing. Now we can begin to add additional points along the arc. These intermediate points will lie along the great circle arc and can be calculated as the fractional distance laong the arc (for example, a point for every 10th of the arc).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kx54wz3g0c"}],"key":"yq38xoIprw"}],"key":"jrvXA9wvJV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Intermediate Points Mathemetically via Unit Sphere (Fractional Distance)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tNFqtuh1Di"}],"identifier":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","label":"Determine Intermediate Points Mathemetically via Unit Sphere (Fractional Distance)","html_id":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","implicit":true,"key":"axEOaEde8Y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Along a unit sphere, we can calculate each intermediate point as a fractional distance along the arc. We can determine the points as a given fraction of a distance (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zyUME3G9r5"},{"type":"inlineCode","value":"d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nTVmSu3Jio"},{"type":"text","value":") between a starting points A (latA, lonA) and the final point B (latB, lonB) where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cDwm9rnCO1"},{"type":"inlineCode","value":"f","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i3EAYwn7J3"},{"type":"text","value":" is a fraction along the great circle arc. As a result, Point A is at","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r5W04IaQyN"},{"type":"inlineCode","value":"f=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JphDbre4wS"},{"type":"text","value":" and Point B sits at","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mC1uoKqrcp"},{"type":"inlineCode","value":"f=1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vr23NSw0xO"},{"type":"text","value":" along the arc.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TBp6vgEMvF"}],"key":"h5rlEjA6Ey"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: The points must not lie on exact opposite sides of a sphere (antipodal), otherwise, the path is undefined because f=0=1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uJ3K35ihJe"}],"key":"i6VTKGmiii"}],"key":"hmb8JgGIk9"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Where, antipodal is defined by:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wCgpaUzU1r"}],"key":"lKjL19kbtd"},{"type":"math","value":"latA + latB = 0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo>+</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">latA + latB = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"6","key":"SDPRa0DAyV"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"S9uy7P586n"}],"key":"wOBfyOHgsV"},{"type":"math","value":"abs(lonA - lonB) = pi","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>a</mi><mi>b</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>p</mi><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">abs(lonA - lonB) = pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ab</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">i</span></span></span></span></span>","enumerator":"7","key":"JJ1XVUascE"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Where the distance between two points is the angular distance:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OsnNCvw4Ee"}],"key":"MO88uc68cE"},{"type":"math","value":"d = \\frac{\\text{total distance of arc}}{\\text{earth's radius}}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>d</mi><mo>=</mo><mfrac><mtext>total distance of arc</mtext><mtext>earth’s radius</mtext></mfrac></mrow><annotation encoding=\"application/x-tex\">d = \\frac{\\text{total distance of arc}}{\\text{earth&#x27;s radius}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">earth’s radius</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">total distance of arc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"8","key":"vaCuIAmDXj"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The intermediate points (lat, lon) along a given path starting point to end point:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"dfkVpXBh79"}],"key":"Zsf4NcOxmi"},{"type":"math","value":"A = sin(\\frac{(1-f) * d}{sin(d)}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>d</mi></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">A = sin(\\frac{(1-f) * d}{sin(d)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"9","key":"hN8CormnXF"},{"type":"math","value":"B = \\frac{sin(f*d)}{sin(d)}","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo>∗</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">B = \\frac{sin(f*d)}{sin(d)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"10","key":"yFcdsBQKjL"},{"type":"math","value":"x = A * cos(latA) * cos(lonA) + B * cos(latB) * cos(lonB)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = A * cos(latA) * cos(lonA) + B * cos(latB) * cos(lonB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"11","key":"uMjSWNmbIp"},{"type":"math","value":"y = A * cos(latA) * sin(lonA) + B * cos(latB) * sin(lonB)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = A * cos(latA) * sin(lonA) + B * cos(latB) * sin(lonB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"12","key":"poSbVLh672"},{"type":"math","value":"z = A * sin(latA) + B * sin(latB)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>z</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>B</mi><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">z = A * sin(latA) + B * sin(latB)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"13","key":"I1xhdl9jK5"},{"type":"math","value":"lat = atan2(z, \\sqrt{x^2 + y^2})","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>z</mi><mo separator=\"true\">,</mo><msqrt><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">lat = atan2(z, \\sqrt{x^2 + y^2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2567em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0067em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.9667em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2333em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"14","key":"H6UrMHFbEF"},{"type":"math","value":"lon = atan2(y, x)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">lon = atan2(y, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"15","key":"aV6FyaNKGl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Intermediate","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Ed Williams: Intermediate Points on a Great Circle","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"hi29UDN4wv"}],"urlSource":"https://edwilliams.org/avform147.htm#Intermediate","key":"Mpqp4TsNbP"}],"key":"C1PsNN9Fkk"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html#intermediate-point","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Moveable Type: Intermediate Point","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Y3J4K9j4CV"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html#intermediate-point","key":"LDNEcCZOui"}],"key":"UzCqUMZlJh"}],"key":"z0MpwI2QNW"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Let’s translate this math into Python code:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"GMGzasQc2k"}],"key":"LielEmLB8a"}],"key":"VtnRBJlwlc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def intermediate_points(start_point=None, end_point=None,\n                        fraction=None, distance=None):\n    # Calculates the position of an intermediate point based on its fractional position along an arc defined from Point A to Point B\n    earth_radius = 6378137  # meters\n    total_distance = distance / earth_radius\n    latA = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lonA = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    latB = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lonB = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    A = np.sin((1-fraction) * total_distance) / np.sin(total_distance)\n    B = np.sin(fraction * total_distance) / np.sin(total_distance)\n    x = (A * np.cos(latA) * np.cos(lonA)) + (B * np.cos(latB) * np.cos(lonB))\n    y = (A * np.cos(latA) * np.sin(lonA)) + (B * np.cos(latB) * np.sin(lonB))\n    z = (A * np.sin(latA)) + (B * np.sin(latB))\n    lat = np.arctan2(z, np.sqrt(x**2 + y**2))\n    lon = np.arctan2(y, x)\n    return (float(np.rad2deg(lat)), float(np.rad2deg(lon)))\n\ndef calculate_intermediate_pts(start_point=None, end_point=None,\n                               fraction=None, total_distance_meter=None):\n    # returns a list of intermediate points along the arc separated by a specific fraction\n    fractions = np.arange(0, 1+fraction, fraction)\n    intermediate_lat_lon = []\n    for fractional in fractions:\n        intermediate_pts = intermediate_points(start_point, end_point,\n                                                fractional, total_distance_meter)\n        intermediate_lat_lon.append(intermediate_pts)\n    return intermediate_lat_lon","key":"gsPyEVZubW"},{"type":"output","id":"f-WZ5GC4eGcTDx2ER3IsS","data":[],"key":"gnW1IB1dl5"}],"key":"yEkEq1kiC5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine Intermediate Points via Python Package ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4V0cJNcZW"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SYrVqdrr3Z"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mBbVMg4cCX"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZeBjoDgyH3"}],"identifier":"determine-intermediate-points-via-python-package-pyproj-and-geopy","label":"Determine Intermediate Points via Python Package pyproj and geopy","html_id":"determine-intermediate-points-via-python-package-pyproj-and-geopy","implicit":true,"key":"B2dgiBIx4Q"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"However, there is a strong advantage when you the Python libraries ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vVe4OpSE0O"},{"type":"inlineCode","value":"pyproj","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kfLFCz6P6h"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ev5VJ6QC9S"},{"type":"inlineCode","value":"geopy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WvO9eCfzdd"},{"type":"text","value":". Not only can you use an ellipsoid instead of a sphere, you can also interpolate points along an arc in additional ways:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i5E8N0ndYV"}],"key":"Nd6kUvro83"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"A fractional distance laong the arc (for example, a point for every 10th of the arc)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W4xiVSbQZT"}],"key":"ZlO8sroiXj"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"A known distance along the arc (for example, a point ever 100 meters)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"B9lbuccVr9"}],"key":"OQtF0Unybd"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"An equal amount of points (for example, adding 6 intermediate points which are equally spaced along the arc)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wObHyEpRTU"}],"key":"bEVofhUMiG"}],"key":"JwmqvtmD0K"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Below you will see how we can use one function ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SxbWODq3ys"},{"type":"inlineCode","value":"interpolate_points_along_gc","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KSx6JgiLqm"},{"type":"text","value":" to be able to solve for all three possible types of intermediate points. The function will use both the starting and ending coordinates (Point A to Point B) and a distance you’d like to have between each point.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qiH8j9tf66"}],"key":"zpvX8mcF9g"}],"key":"SiGiNDKMOO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def interpolate_points_along_gc(lat_start,\n                                lon_start,\n                                lat_end,\n                                lon_end,\n                                distance_between_points_meter): \n    # Interpolate intermediate points along an arc with a given distance between each point\n    lat_lon_points = [(float(lat_start), float(lon_start))]\n    \n    # move to next point when distance between points is less than the equal distance\n    move_to_next_point = True\n    while(move_to_next_point):\n        forward_bearing, _, distance_meters = geodesic.inv(lon_start,\n                                                            lat_start, \n                                                            lon_end,\n                                                            lat_end)\n        if distance_meters < distance_between_points_meter:\n            # ends before overshooting\n            move_to_next_point = False\n        else:\n            start_point = geopy.Point(lat_start, lon_start)\n            distance_to_move = geopy.distance.distance(\n                            kilometers=distance_between_points_meter /\n                            1000)  # distance to move towards the next point\n            final_position = distance_to_move.destination(\n                            start_point, bearing=forward_bearing)\n            lat_lon_points.append((float(final_position.latitude), float(final_position.longitude)))\n            # new starting position is newly found end position\n            lon_start, lat_start = final_position.longitude, final_position.latitude\n    lat_lon_points.append((float(lat_end), float(lon_end)))\n    return lat_lon_points","key":"YlJG6xxtRm"},{"type":"output","id":"N_1dq2oqhl_28GimzFGd3","data":[],"key":"Vn8f4ovW3r"}],"key":"HRvaYmIEf8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate with N Total Equally Spaced Points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pwXGEQ2y2e"}],"identifier":"interpolate-with-n-total-equally-spaced-points","label":"Interpolate with N Total Equally Spaced Points","html_id":"interpolate-with-n-total-equally-spaced-points","implicit":true,"key":"bIvAmnl9di"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Imagine we are flying a plane with a set amount of gas and will need to make 10 stops along our path to refuel from Boulder to Boston. If we need to stop 10 times (imagine that there is a refueling station wherever we stop) then we can interpolate along our path with 10 additional points","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KCpclHGLNJ"}],"key":"j99aiTfLFX"}],"key":"xa89UFKgqO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n_total_points = 10 # total points (n points)\n\n# Calculate the distance between Point A (Boulder) and Point B (Boston)\ndistance_meter = distance_pyproj(\"boulder\", \"boston\")\nprint(f\"Total distance from Boulder to Boston = {distance_meter/1000} km\")\n\ndistance_between_points_meter = distance_meter / (n_total_points + 1)\nprint(f\"Each of the {n_total_points} points will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"ctxWkEMfDV"},{"type":"output","id":"iDNocgh_QPId_zDpGL2OM","data":[{"output_type":"stream","name":"stdout","text":"Total distance from Boulder to Boston = 2862.5974799145215 km\nEach of the 10 points will be separated by 260236.13453768377 meters (260.23613453768377 km)\n"}],"key":"JhhHEQVScI"}],"key":"c3yWdqqFKv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excellent! Now that we know the distances between each of the 10 equally spaced points we can use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rI3S7jR3fj"},{"type":"inlineCode","value":"interpolate_points_along_gc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j4TnpLk33m"},{"type":"text","value":" to find a list of interpolated points. Note that will be 12 total points, 10 intermediate points and 1 for each the starting and ending position.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rMoIULj1mu"}],"key":"Dg0CFfSrjt"}],"key":"IRS1fWPyjx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[[\"boulder\"]][\"latitude\"].iloc[0], location_df.loc[[\"boulder\"]][\"longitude\"].iloc[0]\nlat_end, lon_end = location_df.loc[[\"boston\"]][\"latitude\"].iloc[0], location_df.loc[[\"boston\"]][\"longitude\"].iloc[0]\n\ninterpolated_pts = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(interpolated_pts)} Total Points\")\nprint(f\"List of Interpolated Points:\\n{interpolated_pts}\")","key":"K8WXdpMW1h"},{"type":"output","id":"9ExowlxFFNHmI-A_wVLdM","data":[{"output_type":"stream","name":"stdout","text":"12 Total Points\nList of Interpolated Points:\n[(40.015, -105.2705), (40.64283438472448, -102.32002071588883), (41.19386139956729, -99.31719425393653), (41.665293789240074, -96.2672998277903), (42.05464865958041, -93.17653047007545), (42.35980367525435, -90.05192021556942), (42.579048241302566, -86.9012334462751), (42.71112689737456, -83.73281874084786), (42.75527239726804, -80.5554326250441), (42.711226442193585, -77.37804142647055), (42.579246749547636, -74.20961159223961), (42.3601, -71.0589)]\n"}],"key":"DTECm4EFnn"}],"key":"iwO2cexEAJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot Arcs as Points on a World Map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WhifX449Hy"}],"identifier":"plot-arcs-as-points-on-a-world-map","label":"Plot Arcs as Points on a World Map","html_id":"plot-arcs-as-points-on-a-world-map","implicit":true,"key":"wi7nDtNWLP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The easiest way to understand how these interpolated points will look along an arc is to plot them. To be able to reuse this plotting structure in multiple examples below we will encompass the plot into a simple function which takes in a string for the plot’s title and a list of coordinates (which will include Point A at the start and Point B at the end)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J3SP2cSqhb"}],"key":"TtjCtIAl3x"}],"key":"dZV20lriG1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_coordinate(lst_of_coords=None, title=None):\n    # Set up world map plot on the United States\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -130, -60, 20, 60\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.STATES, edgecolor=\"black\")\n    \n    # Plot Latitude/Longitude Coordinates\n    longitudes = [x[1] for x in lst_of_coords] # longitude\n    latitudes = [x[0] for x in lst_of_coords] # latitude\n    plt.plot(longitudes, latitudes)\n    plt.scatter(longitudes, latitudes)\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(title)\n    plt.show()","key":"VopnUh2mG8"},{"type":"output","id":"cjnNHKhp419xjN7sqM7gn","data":[],"key":"dBSPO8GBZk"}],"key":"kSjfpqZjTK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let’s plot those 10 equally spaced points!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jiWylRx0AJ"}],"key":"UDJguYAmwa"}],"key":"QGusfElr0Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(interpolated_pts,\n                title=f\"Interpolate {n_total_points} Equally Spaced Points\")","key":"OhgiSVZxhf"},{"type":"output","id":"JWPqqJuJjCMgMRMckoeIz","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_1_states_provinces_lakes.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31merror\u001b[39m                                     Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/IPython/core/formatters.py:402\u001b[39m, in \u001b[36mBaseFormatter.__call__\u001b[39m\u001b[34m(self, obj)\u001b[39m\n\u001b[32m    400\u001b[39m     \u001b[38;5;28;01mpass\u001b[39;00m\n\u001b[32m    401\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m402\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mprinter\u001b[49m\u001b[43m(\u001b[49m\u001b[43mobj\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    403\u001b[39m \u001b[38;5;66;03m# Finally look for special method names\u001b[39;00m\n\u001b[32m    404\u001b[39m method = get_real_method(obj, \u001b[38;5;28mself\u001b[39m.print_method)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/IPython/core/pylabtools.py:170\u001b[39m, in \u001b[36mprint_figure\u001b[39m\u001b[34m(fig, fmt, bbox_inches, base64, **kwargs)\u001b[39m\n\u001b[32m    167\u001b[39m     \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmatplotlib\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mbackend_bases\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m FigureCanvasBase\n\u001b[32m    168\u001b[39m     FigureCanvasBase(fig)\n\u001b[32m--> \u001b[39m\u001b[32m170\u001b[39m \u001b[43mfig\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcanvas\u001b[49m\u001b[43m.\u001b[49m\u001b[43mprint_figure\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbytes_io\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkw\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    171\u001b[39m data = bytes_io.getvalue()\n\u001b[32m    172\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m fmt == \u001b[33m'\u001b[39m\u001b[33msvg\u001b[39m\u001b[33m'\u001b[39m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/backend_bases.py:2157\u001b[39m, in \u001b[36mFigureCanvasBase.print_figure\u001b[39m\u001b[34m(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)\u001b[39m\n\u001b[32m   2154\u001b[39m     \u001b[38;5;66;03m# we do this instead of `self.figure.draw_without_rendering`\u001b[39;00m\n\u001b[32m   2155\u001b[39m     \u001b[38;5;66;03m# so that we can inject the orientation\u001b[39;00m\n\u001b[32m   2156\u001b[39m     \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mgetattr\u001b[39m(renderer, \u001b[33m\"\u001b[39m\u001b[33m_draw_disabled\u001b[39m\u001b[33m\"\u001b[39m, nullcontext)():\n\u001b[32m-> \u001b[39m\u001b[32m2157\u001b[39m         \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mfigure\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2158\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m bbox_inches:\n\u001b[32m   2159\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m bbox_inches == \u001b[33m\"\u001b[39m\u001b[33mtight\u001b[39m\u001b[33m\"\u001b[39m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/artist.py:94\u001b[39m, in \u001b[36m_finalize_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer, *args, **kwargs)\u001b[39m\n\u001b[32m     92\u001b[39m \u001b[38;5;129m@wraps\u001b[39m(draw)\n\u001b[32m     93\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mdraw_wrapper\u001b[39m(artist, renderer, *args, **kwargs):\n\u001b[32m---> \u001b[39m\u001b[32m94\u001b[39m     result = \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     95\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m renderer._rasterizing:\n\u001b[32m     96\u001b[39m         renderer.stop_rasterizing()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/figure.py:3257\u001b[39m, in \u001b[36mFigure.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m   3254\u001b[39m             \u001b[38;5;66;03m# ValueError can occur when resizing a window.\u001b[39;00m\n\u001b[32m   3256\u001b[39m     \u001b[38;5;28mself\u001b[39m.patch.draw(renderer)\n\u001b[32m-> \u001b[39m\u001b[32m3257\u001b[39m     \u001b[43mmimage\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_draw_list_compositing_images\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   3258\u001b[39m \u001b[43m        \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43martists\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43msuppressComposite\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   3260\u001b[39m     renderer.close_group(\u001b[33m'\u001b[39m\u001b[33mfigure\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m   3261\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/image.py:134\u001b[39m, in \u001b[36m_draw_list_compositing_images\u001b[39m\u001b[34m(renderer, parent, artists, suppress_composite)\u001b[39m\n\u001b[32m    132\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m not_composite \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m has_images:\n\u001b[32m    133\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m a \u001b[38;5;129;01min\u001b[39;00m artists:\n\u001b[32m--> \u001b[39m\u001b[32m134\u001b[39m         \u001b[43ma\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    135\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    136\u001b[39m     \u001b[38;5;66;03m# Composite any adjacent images together\u001b[39;00m\n\u001b[32m    137\u001b[39m     image_group = []\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/mpl/geoaxes.py:509\u001b[39m, in \u001b[36mGeoAxes.draw\u001b[39m\u001b[34m(self, renderer, **kwargs)\u001b[39m\n\u001b[32m    504\u001b[39m         \u001b[38;5;28mself\u001b[39m.imshow(img, extent=extent, origin=origin,\n\u001b[32m    505\u001b[39m                     transform=factory.crs, *factory_args[\u001b[32m1\u001b[39m:],\n\u001b[32m    506\u001b[39m                     **factory_kwargs)\n\u001b[32m    507\u001b[39m \u001b[38;5;28mself\u001b[39m._done_img_factory = \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m509\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m=\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/axes/_base.py:3226\u001b[39m, in \u001b[36m_AxesBase.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m   3223\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m artists_rasterized:\n\u001b[32m   3224\u001b[39m     _draw_rasterized(\u001b[38;5;28mself\u001b[39m.get_figure(root=\u001b[38;5;28;01mTrue\u001b[39;00m), artists_rasterized, renderer)\n\u001b[32m-> \u001b[39m\u001b[32m3226\u001b[39m \u001b[43mmimage\u001b[49m\u001b[43m.\u001b[49m\u001b[43m_draw_list_compositing_images\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   3227\u001b[39m \u001b[43m    \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43martists\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mget_figure\u001b[49m\u001b[43m(\u001b[49m\u001b[43mroot\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43msuppressComposite\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   3229\u001b[39m renderer.close_group(\u001b[33m'\u001b[39m\u001b[33maxes\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m   3230\u001b[39m \u001b[38;5;28mself\u001b[39m.stale = \u001b[38;5;28;01mFalse\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/image.py:134\u001b[39m, in \u001b[36m_draw_list_compositing_images\u001b[39m\u001b[34m(renderer, parent, artists, suppress_composite)\u001b[39m\n\u001b[32m    132\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m not_composite \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m has_images:\n\u001b[32m    133\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m a \u001b[38;5;129;01min\u001b[39;00m artists:\n\u001b[32m--> \u001b[39m\u001b[32m134\u001b[39m         \u001b[43ma\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    135\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    136\u001b[39m     \u001b[38;5;66;03m# Composite any adjacent images together\u001b[39;00m\n\u001b[32m    137\u001b[39m     image_group = []\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/matplotlib/artist.py:71\u001b[39m, in \u001b[36mallow_rasterization.<locals>.draw_wrapper\u001b[39m\u001b[34m(artist, renderer)\u001b[39m\n\u001b[32m     68\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m     69\u001b[39m         renderer.start_filter()\n\u001b[32m---> \u001b[39m\u001b[32m71\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdraw\u001b[49m\u001b[43m(\u001b[49m\u001b[43martist\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrenderer\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     72\u001b[39m \u001b[38;5;28;01mfinally\u001b[39;00m:\n\u001b[32m     73\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m artist.get_agg_filter() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/mpl/feature_artist.py:184\u001b[39m, in \u001b[36mFeatureArtist.draw\u001b[39m\u001b[34m(self, renderer)\u001b[39m\n\u001b[32m    179\u001b[39m     geoms = \u001b[38;5;28mself\u001b[39m._feature.geometries()\n\u001b[32m    180\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    181\u001b[39m     \u001b[38;5;66;03m# For efficiency on local maps with high resolution features (e.g\u001b[39;00m\n\u001b[32m    182\u001b[39m     \u001b[38;5;66;03m# from Natural Earth), only create paths for geometries that are\u001b[39;00m\n\u001b[32m    183\u001b[39m     \u001b[38;5;66;03m# in view.\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m184\u001b[39m     geoms = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_feature\u001b[49m\u001b[43m.\u001b[49m\u001b[43mintersecting_geometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43mextent\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    186\u001b[39m stylised_paths = {}\n\u001b[32m    187\u001b[39m \u001b[38;5;66;03m# Make an empty placeholder style dictionary for when styler is not\u001b[39;00m\n\u001b[32m    188\u001b[39m \u001b[38;5;66;03m# used.  Freeze it so that we can use it as a dict key.  We will need\u001b[39;00m\n\u001b[32m    189\u001b[39m \u001b[38;5;66;03m# to unfreeze all style dicts with dict(frozen) before passing to mpl.\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/feature/__init__.py:312\u001b[39m, in \u001b[36mNaturalEarthFeature.intersecting_geometries\u001b[39m\u001b[34m(self, extent)\u001b[39m\n\u001b[32m    305\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    306\u001b[39m \u001b[33;03mReturns an iterator of shapely geometries that intersect with\u001b[39;00m\n\u001b[32m    307\u001b[39m \u001b[33;03mthe given extent.\u001b[39;00m\n\u001b[32m    308\u001b[39m \u001b[33;03mThe extent is assumed to be in the CRS of the feature.\u001b[39;00m\n\u001b[32m    309\u001b[39m \u001b[33;03mIf extent is None, the method returns all geometries for this dataset.\u001b[39;00m\n\u001b[32m    310\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    311\u001b[39m \u001b[38;5;28mself\u001b[39m.scaler.scale_from_extent(extent)\n\u001b[32m--> \u001b[39m\u001b[32m312\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mintersecting_geometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43mextent\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/feature/__init__.py:112\u001b[39m, in \u001b[36mFeature.intersecting_geometries\u001b[39m\u001b[34m(self, extent)\u001b[39m\n\u001b[32m    109\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m extent \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m np.isnan(extent[\u001b[32m0\u001b[39m]):\n\u001b[32m    110\u001b[39m     extent_geom = sgeom.box(extent[\u001b[32m0\u001b[39m], extent[\u001b[32m2\u001b[39m],\n\u001b[32m    111\u001b[39m                             extent[\u001b[32m1\u001b[39m], extent[\u001b[32m3\u001b[39m])\n\u001b[32m--> \u001b[39m\u001b[32m112\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m (geom \u001b[38;5;28;01mfor\u001b[39;00m geom \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mgeometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mif\u001b[39;00m\n\u001b[32m    113\u001b[39m             geom \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m extent_geom.intersects(geom))\n\u001b[32m    114\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    115\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m.geometries()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/feature/__init__.py:297\u001b[39m, in \u001b[36mNaturalEarthFeature.geometries\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    295\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m reader.crs \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    296\u001b[39m         \u001b[38;5;28mself\u001b[39m._crs = reader.crs\n\u001b[32m--> \u001b[39m\u001b[32m297\u001b[39m     geometries = \u001b[38;5;28;43mtuple\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mreader\u001b[49m\u001b[43m.\u001b[49m\u001b[43mgeometries\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    298\u001b[39m     _NATURAL_EARTH_GEOM_CACHE[key] = geometries\n\u001b[32m    299\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/cartopy/io/shapereader.py:173\u001b[39m, in \u001b[36mBasicReader.geometries\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    161\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mgeometries\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m    162\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    163\u001b[39m \u001b[33;03m    Return an iterator of shapely geometries from the shapefile.\u001b[39;00m\n\u001b[32m    164\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    171\u001b[39m \n\u001b[32m    172\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m173\u001b[39m \u001b[43m    \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mshape\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_reader\u001b[49m\u001b[43m.\u001b[49m\u001b[43miterShapes\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_bbox\u001b[49m\u001b[43m)\u001b[49m\u001b[43m:\u001b[49m\n\u001b[32m    174\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# Skip the shape that can not be represented as geometry.\u001b[39;49;00m\n\u001b[32m    175\u001b[39m \u001b[43m        \u001b[49m\u001b[38;5;28;43;01mif\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mshape\u001b[49m\u001b[43m.\u001b[49m\u001b[43mshapeType\u001b[49m\u001b[43m \u001b[49m\u001b[43m!=\u001b[49m\u001b[43m \u001b[49m\u001b[43mshapefile\u001b[49m\u001b[43m.\u001b[49m\u001b[43mNULL\u001b[49m\u001b[43m:\u001b[49m\n\u001b[32m    176\u001b[39m \u001b[43m            \u001b[49m\u001b[38;5;28;43;01myield\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43msgeom\u001b[49m\u001b[43m.\u001b[49m\u001b[43mshape\u001b[49m\u001b[43m(\u001b[49m\u001b[43mshape\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/shapefile.py:2845\u001b[39m, in \u001b[36mReader.iterShapes\u001b[39m\u001b[34m(self, bbox)\u001b[39m\n\u001b[32m   2841\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.numShapes:\n\u001b[32m   2842\u001b[39m     \u001b[38;5;66;03m# Iterate exactly the number of shapes from shx header\u001b[39;00m\n\u001b[32m   2843\u001b[39m     \u001b[38;5;28;01mfor\u001b[39;00m i \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mrange\u001b[39m(\u001b[38;5;28mself\u001b[39m.numShapes):\n\u001b[32m   2844\u001b[39m         \u001b[38;5;66;03m# MAYBE: check if more left of file or exit early?\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m2845\u001b[39m         shape = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m__shape\u001b[49m\u001b[43m(\u001b[49m\u001b[43moid\u001b[49m\u001b[43m=\u001b[49m\u001b[43mi\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2846\u001b[39m         \u001b[38;5;28;01mif\u001b[39;00m shape:\n\u001b[32m   2847\u001b[39m             \u001b[38;5;28;01myield\u001b[39;00m shape\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/shapefile.py:2723\u001b[39m, in \u001b[36mReader.__shape\u001b[39m\u001b[34m(self, oid, bbox)\u001b[39m\n\u001b[32m   2720\u001b[39m shapeType = unpack(\u001b[33m\"\u001b[39m\u001b[33m<i\u001b[39m\u001b[33m\"\u001b[39m, b_io.read(\u001b[32m4\u001b[39m))[\u001b[32m0\u001b[39m]\n\u001b[32m   2722\u001b[39m ShapeClass = SHAPE_CLASS_FROM_SHAPETYPE[shapeType]\n\u001b[32m-> \u001b[39m\u001b[32m2723\u001b[39m shape = \u001b[43mShapeClass\u001b[49m\u001b[43m.\u001b[49m\u001b[43mfrom_byte_stream\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   2724\u001b[39m \u001b[43m    \u001b[49m\u001b[43mshapeType\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mrecLength_bytes\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moid\u001b[49m\u001b[43m=\u001b[49m\u001b[43moid\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbbox\u001b[49m\u001b[43m=\u001b[49m\u001b[43mbbox\u001b[49m\n\u001b[32m   2725\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2727\u001b[39m \u001b[38;5;66;03m# Seek to the end of this record as defined by the record header because\u001b[39;00m\n\u001b[32m   2728\u001b[39m \u001b[38;5;66;03m# the shapefile spec doesn't require the actual content to meet the header\u001b[39;00m\n\u001b[32m   2729\u001b[39m \u001b[38;5;66;03m# definition.  Probably allowed for lazy feature deletion.\u001b[39;00m\n\u001b[32m   2730\u001b[39m \u001b[38;5;66;03m# f.seek(next_shape)\u001b[39;00m\n\u001b[32m   2732\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m shape\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/shapefile.py:1214\u001b[39m, in \u001b[36m_CanHaveBBox.from_byte_stream\u001b[39m\u001b[34m(cls, shapeType, b_io, next_shape, oid, bbox)\u001b[39m\n\u001b[32m   1208\u001b[39m         kwargs[\u001b[33m\"\u001b[39m\u001b[33mpartTypes\u001b[39m\u001b[33m\"\u001b[39m] = MultiPatch._read_part_types_from_byte_stream(\n\u001b[32m   1209\u001b[39m             b_io, nParts\n\u001b[32m   1210\u001b[39m         )\n\u001b[32m   1212\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m nPoints:\n\u001b[32m   1213\u001b[39m     kwargs[\u001b[33m\"\u001b[39m\u001b[33mpoints\u001b[39m\u001b[33m\"\u001b[39m] = cast(\n\u001b[32m-> \u001b[39m\u001b[32m1214\u001b[39m         PointsT, \u001b[38;5;28;43mcls\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_read_points_from_byte_stream\u001b[49m\u001b[43m(\u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnPoints\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1215\u001b[39m     )\n\u001b[32m   1217\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m shapeType \u001b[38;5;129;01min\u001b[39;00m _HasZ_shapeTypes:\n\u001b[32m   1218\u001b[39m         kwargs[\u001b[33m\"\u001b[39m\u001b[33mzbox\u001b[39m\u001b[33m\"\u001b[39m], kwargs[\u001b[33m\"\u001b[39m\u001b[33mz\u001b[39m\u001b[33m\"\u001b[39m] = _HasZ._read_zs_from_byte_stream(\n\u001b[32m   1219\u001b[39m             b_io, nPoints\n\u001b[32m   1220\u001b[39m         )\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/cookbook-gc/lib/python3.13/site-packages/shapefile.py:1160\u001b[39m, in \u001b[36m_CanHaveBBox._read_points_from_byte_stream\u001b[39m\u001b[34m(b_io, nPoints)\u001b[39m\n\u001b[32m   1156\u001b[39m \u001b[38;5;129m@staticmethod\u001b[39m\n\u001b[32m   1157\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_read_points_from_byte_stream\u001b[39m(\n\u001b[32m   1158\u001b[39m     b_io: ReadableBinStream, nPoints: \u001b[38;5;28mint\u001b[39m\n\u001b[32m   1159\u001b[39m ) -> \u001b[38;5;28mlist\u001b[39m[Point2D]:\n\u001b[32m-> \u001b[39m\u001b[32m1160\u001b[39m     flat = \u001b[43munpack\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43mf\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m<\u001b[39;49m\u001b[38;5;132;43;01m{\u001b[39;49;00m\u001b[32;43m2\u001b[39;49m\u001b[38;5;250;43m \u001b[39;49m\u001b[43m*\u001b[49m\u001b[38;5;250;43m \u001b[39;49m\u001b[43mnPoints\u001b[49m\u001b[38;5;132;43;01m}\u001b[39;49;00m\u001b[33;43md\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb_io\u001b[49m\u001b[43m.\u001b[49m\u001b[43mread\u001b[49m\u001b[43m(\u001b[49m\u001b[32;43m16\u001b[39;49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m \u001b[49m\u001b[43mnPoints\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1161\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mlist\u001b[39m(\u001b[38;5;28mzip\u001b[39m(*(\u001b[38;5;28miter\u001b[39m(flat),) * \u001b[32m2\u001b[39m))\n\n\u001b[31merror\u001b[39m: unpack requires a buffer of 1872 bytes","ename":"error","evalue":"unpack requires a buffer of 1872 bytes"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"}}}],"key":"bu7qyrzyyL"}],"key":"tvLp9UsPKA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looking good! Alright, let’s move along to interpolate based on a known distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PQw3Ti1uJg"}],"key":"REGpdyQ1ns"}],"key":"CsuWQquCfl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate every N meters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kK0MtKXSop"}],"identifier":"interpolate-every-n-meters","label":"Interpolate every N meters","html_id":"interpolate-every-n-meters","implicit":true,"key":"tZbpAUHFZd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A plane has a fuel tank that can hold a known amount of gas, what if instead we wanted to known how far we need to refuel, but now in meters? Let’s say we hold a gas tank that can hold enough fuel to get 112 km, how many times will we need to stop and where along would those stops appear?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GCjGSz2zSU"}],"key":"WoOK39K5Nd"}],"key":"r11X9S3K8t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_between_points_meter = 112000 # 122.0 km\nprint(f\"Each point will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"dmtmt6mhEF"},{"type":"output","id":"NpEdn_T_5ami_E-1Q566C","data":[{"output_type":"stream","name":"stdout","text":"Each point will be separated by 112000 meters (112.0 km)\n"}],"key":"r8yOlnCPcy"}],"key":"N7Z2UL6BEQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\ninterpolated_pts = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(interpolated_pts)} Total Points\")\nprint(f\"List of Interpolated Points:\\n{interpolated_pts}\")","key":"bbhjuwYcjl"},{"type":"output","id":"9Jw_Da_K-oS-L_pXGWTSf","data":[{"output_type":"stream","name":"stdout","text":"27 Total Points\nList of Interpolated Points:\n[(40.015, -105.2705), (40.29443152420481, -104.00739372929635), (40.55994883031889, -102.73410083358552), (40.811312209497714, -101.45097760323463), (41.04829010633232, -100.15841313140038), (41.27065999040772, -98.8568290209118), (41.47820922569627, -97.54667886388195), (41.67073593071231, -96.22844748540258), (41.848049822017195, -94.90264994540797), (42.00997303342117, -93.56983029584387), (42.156340903095064, -92.23056009359964), (42.287002720790326, -90.88543667319323), (42.40182242747838, -89.53508118686946), (42.50067925996674, -88.1801364234981), (42.583468333429785, -86.82126442135142), (42.65010115530707, -85.45914389340653), (42.700506064664665, -84.09446748716023), (42.73462859187762, -82.72793890397021), (42.75243173435998, -81.36026990555973), (42.75389614502746, -79.99217723746453), (42.73902023120852, -78.62437950079696), (42.707820162798164, -77.25759400470386), (42.66032978955507, -75.89253363227026), (42.596600468550456, -74.52990375235937), (42.51670080386281, -73.1703992089883), (42.42071630165334, -71.81470141834599), (42.3601, -71.0589)]\n"}],"key":"ifQLTxmbRf"}],"key":"fhXl9CqWRb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(interpolated_pts,\n                title=f\"Interpolate every {distance_between_points_meter/1000} km\")","key":"Yi0Fb02ztN"},{"type":"output","id":"R46517mPI7Mx8ZGc1LqaM","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9869207601913d0dc5e2524b5ed65b22","path":"/great-circle-cookbook/build/9869207601913d0dc5e2524b5ed65b22.png"}}}],"key":"Xl5C7wjiUb"}],"key":"YGoOK3eZzc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That’s a lot of stop! Ok, now we can return to a familiar system. We can use this same system to also determine fractional distances as well!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DK5jRE4ekZ"}],"key":"iitkskfOHO"}],"key":"sMUofhAq4w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interpolate a fractional distance along arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fo7enXyMKu"}],"identifier":"interpolate-a-fractional-distance-along-arc","label":"Interpolate a fractional distance along arc","html_id":"interpolate-a-fractional-distance-along-arc","implicit":true,"key":"NqBY9WTcGz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Above","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v4AZ2EPOda"}],"identifier":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","label":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","kind":"heading","template":"{name}","resolved":true,"html_id":"determine-intermediate-points-mathemetically-via-unit-sphere-fractional-distance","key":"SNdJoYKdmm"},{"type":"text","value":" we calculated how to find intermediate points as a fractional distance along an arc. We can now return to this, but with the advantages of using an ellipsoid! Let’s try this method and interpolate points every 10th of an arc.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ceqgH0SEQv"}],"key":"KA2EqsI4eE"}],"key":"NAFrmpfzrw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fraction = 1/10","key":"pdZvs4JqKF"},{"type":"output","id":"_pcETkW8I8Qef0oTvg1k-","data":[],"key":"lZHdvSElhZ"}],"key":"DvGKBLoaiV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_between_points_meter = fraction * distance_meter\nprint(f\"Interpolate for every {fraction} of the arc\")\nprint(f\"Each point will be separated by {distance_between_points_meter} meters ({distance_between_points_meter/1000} km)\")","key":"DiMjIEizfd"},{"type":"output","id":"_k9SaYJdLPfYkbnL2HDi1","data":[{"output_type":"stream","name":"stdout","text":"Interpolate for every 0.1 of the arc\nEach point will be separated by 286259.74799145217 meters (286.2597479914522 km)\n"}],"key":"DfgvNNNnbU"}],"key":"xgcf2A5CYr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\ninterpolated_pts = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          distance_between_points_meter)\nprint(f\"{len(interpolated_pts)} Total Points\")\nprint(f\"List of Interpolated Points:\\n{interpolated_pts}\")","key":"iCRvWRfgtK"},{"type":"output","id":"DEunuyEaJ49ntmtjM5qD1","data":[{"output_type":"stream","name":"stdout","text":"11 Total Points\nList of Interpolated Points:\n[(40.015, -105.2705), (40.70144152851926, -102.0220139666611), (41.29459964930597, -98.7107954391427), (41.790822409112124, -95.34405626799516), (42.18692017366623, -91.93032741511365), (42.4802543416051, -88.47932636547252), (42.66881568690329, -85.00175846666659), (42.75128706952139, -81.50905885116296), (42.72708599453554, -78.01308797522954), (42.59638380227174, -74.52579917182065), (42.3601, -71.0589)]\n"}],"key":"JJUKEbR8uN"}],"key":"A5rM1UagvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(interpolated_pts,\n                title=f\"(Ellipsoid) Interpolate every {fraction}th of the arc\")","key":"R7GaI4hhIL"},{"type":"output","id":"bZLll0JgNPF6D-4BQOBvQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"bd0dff4e75f5641838a52438dd926a61","path":"/great-circle-cookbook/build/bd0dff4e75f5641838a52438dd926a61.png"}}}],"key":"BTQxqbCEAG"}],"key":"o1YFU6fWky"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now compare both the ellipsoid and spherical model. First, let’s plot the same fractional distance along the unit sphere:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dgpepbrjf3"}],"key":"DHbrwMxcRF"}],"key":"c4ZDfwP550"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nintermediate_unit_sphere = calculate_intermediate_pts(\"boulder\", \"boston\",\n                                               fraction, distance_unit_sphere_default)\nprint(f\"{len(intermediate_unit_sphere)} Total Points\")\nprint(f\"List of Interpolated Points:\\n{intermediate_unit_sphere}\")","key":"ytjWczwUzw"},{"type":"output","id":"D-sRjb1-Rb7sl2R_aIHh-","data":[{"output_type":"stream","name":"stdout","text":"11 Total Points\nList of Interpolated Points:\n[(40.015, -105.2705), (40.69956840796515, -102.0224051615289), (41.291305596308824, -98.71150732723615), (41.786544424077, -95.3450112546059), (42.1820804843035, -91.93144054027105), (42.475261312703864, -88.48050569778584), (42.66406520473303, -85.00290620334833), (42.74716436193266, -81.51007310432796), (42.723967826794556, -78.01386515980239), (42.59464096704978, -74.52623685097386), (42.3601, -71.0589)]\n"}],"key":"OUKS3IQdaW"}],"key":"b3AiYBsLTi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_coordinate(intermediate_unit_sphere,\n                title=f\"(Unit Sphere) Interpolate every {fraction}th of the arc\")","key":"KzV5UjGqHZ"},{"type":"output","id":"Yw5LnqZ10uFeoIi5IdaED","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ad6a78077f8c04f86365ff19d56235e5","path":"/great-circle-cookbook/build/ad6a78077f8c04f86365ff19d56235e5.png"}}}],"key":"mXalMeX4Hs"}],"key":"tA1qYOruQ4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The difference between the ellipsoid and the sphere will become more apparently as intermediate points along the arc are shifted to new positions based on whether or not it is a sphere.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HquLNMKjds"}],"key":"H3l1XlJzJV"}],"key":"mXnLz073EC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compare Unit Sphere and Ellipsoid\nfor i in range(len(interpolated_pts)):\n    _, _, distance_m = geodesic.inv(interpolated_pts[i][0], interpolated_pts[i][1],\n                                   intermediate_unit_sphere[i][0], intermediate_unit_sphere[i][1])\n    if np.isnan(distance_m): distance_m = 0\n    print(f\"Difference in distance between ellipsoid/unit sphere at point {i}: {distance_m} meters\")","key":"Uqh8vEkCOO"},{"type":"output","id":"ejtpql4FEqj1yqtcubMoH","data":[{"output_type":"stream","name":"stdout","text":"Difference in distance between ellipsoid/unit sphere at point 0: 0 meters\nDifference in distance between ellipsoid/unit sphere at point 1: 0 meters\nDifference in distance between ellipsoid/unit sphere at point 2: 0 meters\nDifference in distance between ellipsoid/unit sphere at point 3: 0 meters\nDifference in distance between ellipsoid/unit sphere at point 4: 0 meters\nDifference in distance between ellipsoid/unit sphere at point 5: 132.55154860348821 meters\nDifference in distance between ellipsoid/unit sphere at point 6: 136.26443374199349 meters\nDifference in distance between ellipsoid/unit sphere at point 7: 132.0972186842191 meters\nDifference in distance between ellipsoid/unit sphere at point 8: 112.95654352480192 meters\nDifference in distance between ellipsoid/unit sphere at point 9: 71.29186326482345 meters\nDifference in distance between ellipsoid/unit sphere at point 10: 0.0 meters\n"}],"key":"mIs6vhnu04"}],"key":"xLsby8cm2H"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine the Midpoint of a Great Circle Arc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tEUDAEgk34"}],"identifier":"determine-the-midpoint-of-a-great-circle-arc","label":"Determine the Midpoint of a Great Circle Arc","html_id":"determine-the-midpoint-of-a-great-circle-arc","implicit":true,"key":"T9nkPbFmT8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The advantage of using fractional distances it is make it simple to find the midpoint along the arc. The midpoint of an arc can be determined as a fractional distance along an arc where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TAj9dvFYVp"},{"type":"inlineCode","value":"f = 0.5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tX5bFdKDo1"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XlkVW751jr"}],"key":"FXFYWZ0Cqw"}],"key":"sQ7l1XNoHm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_meter = distance_pyproj(\"boulder\", \"boston\")\n\n# Distance along the arc where the midpoint lies:\nmidpoint = distance_meter / 2","key":"lpCBUtD5a8"},{"type":"output","id":"1NM0C8_v4-tbyMCmeK2KL","data":[],"key":"cJOlrDbFwt"}],"key":"B815NytIWf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lat_start, lon_start = location_df.loc[\"boulder\", \"latitude\"], location_df.loc[\"boulder\", \"longitude\"]\nlat_end, lon_end = location_df.loc[\"boston\", \"latitude\"], location_df.loc[\"boston\", \"longitude\"]\n\nintermediate_geodesic = interpolate_points_along_gc(lat_start,\n                                          lon_start,\n                                          lat_end,\n                                          lon_end,\n                                          midpoint)\nprint(f\"{len(interpolated_pts)} Total Points\")\nprint(f\"List of Interpolated Points:\\n{interpolated_pts}\")\nprint(f\"Midpoint = {interpolated_pts[1]}\")","key":"t6RY81aGsX"},{"type":"output","id":"vP01C3_cNU7YC3YMe3WzE","data":[{"output_type":"stream","name":"stdout","text":"11 Total Points\nList of Interpolated Points:\n[(40.015, -105.2705), (40.70144152851926, -102.0220139666611), (41.29459964930597, -98.7107954391427), (41.790822409112124, -95.34405626799516), (42.18692017366623, -91.93032741511365), (42.4802543416051, -88.47932636547252), (42.66881568690329, -85.00175846666659), (42.75128706952139, -81.50905885116296), (42.72708599453554, -78.01308797522954), (42.59638380227174, -74.52579917182065), (42.3601, -71.0589)]\nMidpoint = (40.70144152851926, -102.0220139666611)\n"}],"key":"XREDKNdeJk"}],"key":"OoWrxWU4jx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ok, let’s compare the midpoint along the ellipsoid and the unit sphere:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JA0QamMkK7"}],"key":"VXQQcD3jYl"}],"key":"vu2XhbgbEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_unit_sphere_default = distance_between_points_default(\"boulder\", \"boston\")\nintermediate_unit_sphere = calculate_intermediate_pts(\"boulder\", \"boston\",\n                                               1/2, distance_unit_sphere_default)\nprint(f\"{len(intermediate_unit_sphere)} Total Points\")\nprint(intermediate_unit_sphere)\nprint(f\"Midpoint = {intermediate_geodesic[1]}\")","key":"K42jNZexnB"},{"type":"output","id":"AzRgRPy4gaWYdzZNHPnrL","data":[{"output_type":"stream","name":"stdout","text":"3 Total Points\n[(40.015, -105.2705), (42.475261312703864, -88.48050569778584), (42.3601, -71.0589)]\nMidpoint = (42.48025434160511, -88.4793263654725)\n"}],"key":"FZicF0SAKU"}],"key":"dCfmVSWrBU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compare geodesic and unit sphere\n_, _, distance_m = geodesic.inv(intermediate_geodesic[1][0], intermediate_geodesic[1][1],\n                                   intermediate_unit_sphere[1][0], intermediate_unit_sphere[1][1])\nprint(f\"Distance between unit sphere and ellipsoid's midpoints = {distance_m} meters\")","key":"t5VQVsH1Y4"},{"type":"output","id":"9j7WDnLzRoDB4zTRrEuor","data":[{"output_type":"stream","name":"stdout","text":"Distance between unit sphere and ellipsoid's midpoints = 132.55154860505925 meters\n"}],"key":"r3iCduKN7P"}],"key":"y3O4MsISJA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"132 meters isn’t very far when you are working with something as large as the Earth, but that is more than an entire football field away from each other!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GGCHd3e5vW"}],"key":"Q8Jz1Wfu9o"}],"key":"KiRFscRVb0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate a Great Circle Path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ddwJmF456k"}],"identifier":"generate-a-great-circle-path","label":"Generate a Great Circle Path","html_id":"generate-a-great-circle-path","implicit":true,"key":"CbxzZaqqpB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A great circle arc is the arc formed between two points along the surface of a sphere. So far, this is all we’ve focused on. However, imagine if you extending that arc in the same bearing all the way around the globe until you returned back to your starting position. This is known as a great circle path.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QIrigcP5UL"}],"key":"EbsTD19O5Y"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The great circle path can be used to determine where (at what latitude/longtiude) a great circle would cross a given parallel as well as illustrate how the plane cutting through the globe that is used to form a great circle.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"klEzNSWmeC"}],"key":"O2i0nLuiZk"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Because a great circle path will move from -180 degrees to 180 degrees longitude, then all we need to know is what the latitude at each point would be. A a valid great circle path only exists if:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Si9RhXq1FS"}],"key":"XRNkUMfDLe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Point A and Point B are not meridians (at the same longitude, directly above or below each other)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PbsLT9bz03"}],"key":"N5fftMoID8"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Point A and Point B are not Antipodal (exactly on opposite sides of the globe)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"aieYFNTfi9"}],"key":"PU3Grqaro9"}],"key":"AcceQGRezR"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Otherwise, the great circle path is considered undefined.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"nqywhYjjBI"}],"key":"bM9f6oJUnc"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"To do this, we will generate a list of longitude points from -180 to 180 degrees. By default, this will be 360 total points, 1 point for each degree longitude. Then, since we know the starting and ending point, we can determine the latitude for any longitude point (","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"AbGrPpW81W"},{"type":"inlineCode","value":"lon","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Ye4ekUcZ4m"},{"type":"text","value":") along the great circle path generated from a great circle arc (from Point A to Point B):","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OBl4wncJ9w"}],"key":"tgfvnk9SzF"},{"type":"math","value":"\\text{latitude} = atan(\\frac{sin(latA)*cos(latB)*sin(lon-lonB)-sin(latB)*cos(latA)*sin(lon-lon1)}{cos(latA)*cos(latB)*sin(lonA-lonB)})","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>latitude</mtext><mo>=</mo><mi>a</mi><mi>t</mi><mi>a</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>a</mi><mi>t</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>A</mi><mo>−</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{latitude} = atan(\\frac{sin(latA)*cos(latB)*sin(lon-lonB)-sin(latB)*cos(latA)*sin(lon-lon1)}{cos(latA)*cos(latB)*sin(lonA-lonB)})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">an</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">tB</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"16","key":"w3c6LV06sk"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm#Int","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"See more: Latitude of point on GC","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"eyn5qdZjC2"}],"urlSource":"https://edwilliams.org/avform147.htm#Int","key":"UJOnoXTAsc"}],"key":"vKoRKMbw6F"}],"key":"ruUMqulH9s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Find Latitude Coordinate based on a Longitude Coordinate and a Great Circle Arc formed by Point A (start) to Point B (end)\ndef generate_latitude_along_gc(start_point=None, end_point=None, number_of_lon_pts=360):\n    # Generate a list of latitude coordinates for the great circle path\n\n    # First convert each point to radians (to work with sin/cos)\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n\n    # Verify not meridian (longitude passes through the poles)\n    # If points lie at the same longitude, alert user and return a totally linear path\n    if np.sin(lon1 - lon2) == 0:\n        print(\"Invalid inputs: start/end points are meridians\")\n        # plotting meridians at 0 longitude through all latitudes\n        meridian_lat = np.arange(-90, 90, 180/len(longitude_lst)) # split in n number\n        meridians = []\n        for lat in meridian_lat:\n            meridians.append((lat, 0))\n        return meridians\n\n    # verify not antipodal (diametrically opposite points)\n    if lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi:\n        # if points are anitpodal, alert user and return empty list\n        print(\"Invalid inputs: start/end points are antipodal\")\n        return []\n\n    # generate N total number of longitude points along the great circle\n    # Similar code in R: https://github.com/rspatial/geosphere/blob/master/R/greatCircle.R#L18C3-L18C7\n    gc_lon_lst = []\n    for lon in range(1, number_of_lon_pts+1):\n        new_lon = (lon  * (360/number_of_lon_pts) - 180)\n        gc_lon_lst.append(np.deg2rad(new_lon))\n\n    # Intermediate points on a great circle: https://edwilliams.org/avform147.htm#Int\n    # Equation 22\n    gc_lat_lon = []\n    for gc_lon in gc_lon_lst:\n        num = np.sin(lat1)*np.cos(lat2)*np.sin(gc_lon-lon2)-np.sin(lat2)*np.cos(lat1)*np.sin(gc_lon-lon1)\n        den = np.cos(lat1)*np.cos(lat2)*np.sin(lon1-lon2)\n        new_lat = np.arctan(num/den)\n        # convert back to degrees and save latitude/longitude pair\n        gc_lat_lon.append((np.rad2deg(new_lat), np.rad2deg(gc_lon)))\n    return gc_lat_lon","key":"rE7mOK60J4"},{"type":"output","id":"saEtcAmyTU_rrmomFMrOk","data":[],"key":"Ctnydbctca"}],"key":"fIxPP4yXqz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have a great circle arc (formed from Point A to Point B) and a list of possible longitude values (from -180 to 180 degrees). With ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OOHeCoMZcz"},{"type":"inlineCode","value":"generate_latitude_along_gc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M4doy9EEVb"},{"type":"text","value":" we can generate a full list of latitude/longitude pairs for the entire great circle path!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"My9qI1JZjA"}],"key":"sD7xDabyXR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To plot both the great circle arc and the great circle path, we will use ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cz9XmSDwSQ"},{"type":"inlineCode","value":"arc_points","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MCl4q81609"},{"type":"text","value":" to get a list of the great circle arc positions and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V3wcGy6i4l"},{"type":"inlineCode","value":"generate_latitude_along_gc","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X9dCCwbjcN"},{"type":"text","value":" to get a list of the points along the great circle path. There will be obvious overlap for the small section of the path that contains the arc.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MCioaTtKKX"}],"key":"tjfkonIN2D"}],"key":"myH9BMDceq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def arc_points(start_lat=None,\n               start_lon=None,\n               end_lat=None,\n               end_lon=None,\n               n_total_points=10):\n    _, _, distance_meter =  geodesic.inv(start_lon,\n                                        start_lat,\n                                        end_lon,\n                                        end_lat)\n        \n    distance_between_points_meter = distance_meter / (n_total_points + 1)\n\n    \n    points_along_arc = interpolate_points_along_gc(start_lat,\n                                              start_lon,\n                                              end_lat,\n                                              end_lon,\n                                              distance_between_points_meter)\n    return points_along_arc","key":"jSsB5Wvz7V"},{"type":"output","id":"8oFNrfSPDfM4KS1vBMtZD","data":[],"key":"SOxaaxQIuu"}],"key":"VLjmSTNcGl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Time to plot! To keep it simple ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lIZNnyYnTW"},{"type":"inlineCode","value":"plot_coordinates","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iZgHJdrotA"},{"type":"text","value":" will take in a list of points along the great circle path with a starting and ending point (Point A and B) and internally generate a list of points for the great circle arc.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dnWhLmqJJu"}],"key":"EybmG6d1pE"}],"key":"sb8ogsuEd7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_coordinate(lat_lon_lst=None,\n                    start_point=None, end_point=None,\n                    title=None):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -180, 180, -90, 90\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.BORDERS, edgecolor='grey')\n    ax.add_feature(cfeature.STATES, edgecolor=\"grey\")\n        \n    # Get list of points along the great circle path (in blue)\n    longitudes = [x[1] for x in lat_lon_lst] # longitude\n    latitudes = [x[0] for x in lat_lon_lst] # latitude\n    plt.plot(longitudes, latitudes, c=\"cornflowerblue\")\n    plt.scatter(longitudes, latitudes, c=\"cornflowerblue\")\n\n    # Generate a great circle arc from the starting to ending point (in red)\n    start_end_lat_lon = arc_points(location_df.loc[start_point, \"latitude\"],\n                                   location_df.loc[start_point, \"longitude\"],\n                                   location_df.loc[end_point, \"latitude\"],\n                                   location_df.loc[end_point, \"longitude\"],\n                                   n_total_points=20)\n    longitudes = [x[1] for x in start_end_lat_lon] # longitude\n    latitudes = [x[0] for x in start_end_lat_lon] # latitude\n    plt.plot(longitudes, latitudes, c=\"red\")\n    plt.scatter(longitudes, latitudes, c=\"red\")\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(title)\n    plt.show()","key":"Or3jLXhpwA"},{"type":"output","id":"TkRLym9-0O4tziPeUaHzq","data":[],"key":"HtsTALIlTr"}],"key":"lgUDVaruZB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s see how this look! First, let’s see how the great circle path and arc from Boulder to Boston looks:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fY5U2yqt3H"}],"key":"eT9QrAfJjY"}],"key":"m8KPNa0hBb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"boulder\"\nend_pt = \"boston\"\nn_pts = 360 # number of points along the longitude (resolution for 360 is one point for each 1 degree)\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"Q7muV8I6oN"},{"type":"output","id":"CXGMX0CU4E9I8nB61pktK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1e6a9254e5df5eeb6e5a35c89b1b991d","path":"/great-circle-cookbook/build/1e6a9254e5df5eeb6e5a35c89b1b991d.png"}}}],"key":"nxXt1gAVDr"}],"key":"B4YqL2yvDl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"How about a longer arc? Let’s start at the Arceibo Telescope and move up to Greenwich (the Prime Meridian)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A7wHhN9U6k"}],"key":"hvKdDwQYoA"}],"key":"ybsx8BVz86"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"arecibo\"\nend_pt = \"greenwich\"\nn_pts = 360 # number of points along the longitude (resolution for 360 is one point for each 1 degree)\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"g7581AZIU9"},{"type":"output","id":"RkefK97bjF9C9PaiAtZR4","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3b8c57f536121c93ad547d0054e09d70","path":"/great-circle-cookbook/build/3b8c57f536121c93ad547d0054e09d70.png"}}}],"key":"L83bzVq0d0"}],"key":"oY20neDMyI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excellent! And now a very extreme example, starting all the way down in Zambezi and all the way up to Svalbard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N4wKW9TaAU"}],"key":"REoiuLir10"}],"key":"cH7J1G3z75"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_pt = \"zambezi\"\nend_pt = \"svalbard\"\nn_pts = 360\nlat_lon_pts = generate_latitude_along_gc(start_pt, end_pt, number_of_lon_pts=n_pts)\nplot_coordinate(lat_lon_pts, start_pt, end_pt,\n                f\"Plot Great Circle, made from the arc {start_pt.title()} to {end_pt.title()}\")","key":"QlkUaItNdA"},{"type":"output","id":"Yjz-36SWcvCOnDQl5Q0_o","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0940b30507d6d0b5fa5a4d876dd4419e","path":"/great-circle-cookbook/build/0940b30507d6d0b5fa5a4d876dd4419e.png"}}}],"key":"Ks6Mz3fHRK"}],"key":"Shk7u3gReb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Wait! Wasn’t a Great Circle Suppose to be a Line?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VzCXzdfVrP"}],"identifier":"wait-wasnt-a-great-circle-suppose-to-be-a-line","label":"Wait! Wasn’t a Great Circle Suppose to be a Line?","html_id":"wait-wasnt-a-great-circle-suppose-to-be-a-line","implicit":true,"key":"dxqj5N3xjM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You are right! Great circle paths will appear like a straight line that cuts the globe in half. However, on a flat projection, a perfectly straight path will appear curved.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V7QkGbWxmq"}],"key":"vSa6szS9RQ"}],"key":"ekg5KVElDY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Determine an Antipodal Point","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AECTGQUVwF"}],"identifier":"determine-an-antipodal-point","label":"Determine an Antipodal Point","html_id":"determine-an-antipodal-point","implicit":true,"key":"OGaRDyKbzw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Imagine you could directly down below your feet through the Earth and all the way to the otherside of the planet. Where would that be? This exactly opposite position is known as a antipodal point.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dQcYfYGCMt"}],"key":"UZ3I0kCs9o"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The latitude is simple, it is simply the inverse of your current latitude. So, standing at 40 degrees in Boulder, my antipodal latitude will sit at -40 degrees, we can defined this as:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TQS2hqMlSz"}],"key":"pQUWn21oBL"},{"type":"math","value":"\\text{antipodal latitude} = -1 * \\text{latitude}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>antipodal latitude</mtext><mo>=</mo><mo>−</mo><mn>1</mn><mo>∗</mo><mtext>latitude</mtext></mrow><annotation encoding=\"application/x-tex\">\\text{antipodal latitude} = -1 * \\text{latitude}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">antipodal latitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">latitude</span></span></span></span></span></span>","enumerator":"17","key":"jH5JebtZAL"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Antipodal longitude is a little more complicated. This will depend on if you are standing to the East (positive) or West (negative) of the Prime Meridian (0 degrees longitude)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BvnyVSIXwP"}],"key":"zOTkTI51Go"},{"type":"math","value":"\\text{anitpodal longitude} = (\\text{longitude} + 180) \\text{ if longitude} \\le 0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>anitpodal longitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>longitude</mtext><mo>+</mo><mn>180</mn><mo stretchy=\"false\">)</mo><mtext> if longitude</mtext><mo>≤</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\text{anitpodal longitude} = (\\text{longitude} + 180) \\text{ if longitude} \\le 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">anitpodal longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">180</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> if longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"18","key":"rBprDFISco"},{"type":"math","value":"\\text{anitpodal longitude} = (\\text{longitude} - 180) \\text{ if longitude} \\gt 0","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>anitpodal longitude</mtext><mo>=</mo><mo stretchy=\"false\">(</mo><mtext>longitude</mtext><mo>−</mo><mn>180</mn><mo stretchy=\"false\">)</mo><mtext> if longitude</mtext><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\text{anitpodal longitude} = (\\text{longitude} - 180) \\text{ if longitude} \\gt 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">anitpodal longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">180</span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> if longitude</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>","enumerator":"19","key":"XvCQHWUg6e"}],"key":"EApjoV6XWf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def antipodal(start_point=None):\n    # return the antipodal (latitude/longitude) point from a starting position\n    anti_lat = -1 * location_df.loc[start_point, \"latitude\"]\n    ref_lon = location_df.loc[start_point, \"longitude\"]\n    if ref_lon > 0:\n        anti_lon = ref_lon - 180\n    else:\n        anti_lon = ref_lon + 180\n    return (float(anti_lat), float(anti_lon))","key":"SYC0HEOhCM"},{"type":"output","id":"546wa7XpwbbIpA9bXPJXT","data":[],"key":"kwYDFildS1"}],"key":"g4CQcrr6WG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def is_antipodal(start_point=None, end_point=None):\n    # return true is a point is antipodal from another point\n    lon1 = np.deg2rad(location_df.loc[start_point, \"longitude\"])\n    lat1 = np.deg2rad(location_df.loc[start_point, \"latitude\"])\n    lon2 = np.deg2rad(location_df.loc[end_point, \"longitude\"])\n    lat2 = np.deg2rad(location_df.loc[end_point, \"latitude\"])\n    return lat1 + lat2 == 0 and abs(lon1-lon2) == np.pi","key":"FHe5kDM95N"},{"type":"output","id":"G7LlUS6atN8CWNd1o7e8T","data":[],"key":"CN03KpGCyt"}],"key":"OpPD4Ax4oV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://www.antipodesmap.com/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"See for yourself on this antipodes map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jkuP5iS39M"}],"urlSource":"https://www.antipodesmap.com/","key":"aITDAhLenp"},{"type":"text","value":", but we can also plot this in Python.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZjyhiwxvCm"}],"key":"yQqFKcFeS7"}],"key":"TSc469LWBw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def plot_antipodal(start_point=None):\n    # Set up world map plot\n    fig = plt.subplots(figsize=(15, 10))\n    projection_map = ccrs.PlateCarree()\n    ax = plt.axes(projection=projection_map)\n    lon_west, lon_east, lat_south, lat_north = -180, 180, -90, 90\n    ax.set_extent([lon_west, lon_east, lat_south, lat_north], crs=projection_map)\n    ax.coastlines(color=\"black\")\n    ax.add_feature(cfeature.BORDERS, edgecolor='grey')\n    ax.add_feature(cfeature.STATES, edgecolor=\"grey\")\n        \n    # Plot Start point (in blue)\n    plt.scatter(location_df.loc[start_point, \"longitude\"],\n                location_df.loc[start_point, \"latitude\"],\n                s=100, c=\"cornflowerblue\", label=start_point.title())\n\n    # Plot Antipodal Point (in red)\n    antipodal_point = antipodal(start_point)\n    plt.scatter(antipodal_point[1], antipodal_point[0], s=100, c=\"red\", label=\"Antipodal\")\n    \n    # Setup Axis Limits and Title/Labels\n    plt.title(f\"{start_point.title()} and Antipodal Point {antipodal_point}\")\n    plt.legend(loc=\"lower right\")\n    plt.show()","key":"gYsYW66Oxj"},{"type":"output","id":"CuywMmcOxgCrh4tZU_xHP","data":[],"key":"FgcQvoCvmI"}],"key":"ib1znVOze3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s see how this looks. Where does the antipodal point from Boulder lie?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uL0SuL9t4t"}],"key":"xQsgISugeg"}],"key":"FQ9IBb5TCk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_antipodal(\"boulder\")","key":"NegHeRVngr"},{"type":"output","id":"9csDvXphiSad0w8QhEi_X","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9f33df636e74e51bed6e888891eae5ee","path":"/great-circle-cookbook/build/9f33df636e74e51bed6e888891eae5ee.png"}}}],"key":"DZE9htkF9l"}],"key":"LibVZLBAUD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ah, the middle of the ocean. What about Svalbard?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NavmjnlUdp"}],"key":"bbFLSYqTdI"}],"key":"kwfYauHGlK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_antipodal(\"svalbard\")","key":"jFqG9XEcyw"},{"type":"output","id":"VkZ--yf6aExkVMCxEtpTS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"44a47e857bc03b469f88ce6f4c0ceb59","path":"/great-circle-cookbook/build/44a47e857bc03b469f88ce6f4c0ceb59.png"}}}],"key":"nvJKdBKm2F"}],"key":"n92sxtBdz6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Just off the coast of Antartica! And the city of Cairo?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zOmzFsdjYx"}],"key":"Ol1dwpNKhK"}],"key":"hU391aMkpI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_antipodal(\"cairo\")","key":"YVxLENmPme"},{"type":"output","id":"HbzDj3IW89R45I-Z_Xmsg","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1500x1000 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"736e73e6de1eecdf8a609450d15289f9","path":"/great-circle-cookbook/build/736e73e6de1eecdf8a609450d15289f9.png"}}}],"key":"uTsPxgrLR2"}],"key":"WpBgAqKDNx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We are back in the ocean, but that isn’t strange. The Earth is mostly water, so don’t be surprised if the point on the opposite of the globe from you is lying in the middle of the ocean.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eKah7JChka"}],"key":"orksxZVlGL"}],"key":"emaz35B7Id"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iLeWGuOzNc"}],"key":"imbk3j0Lj2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qVeocZBYzv"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"RXsYHaozpB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook covered how to generate and plot great circle arcs and paths with just a starting and ending position. This also included how to calculate the bearing of a great circle arc as well interpolating along the great circle and even how to find the antipodal point to any point on the globe. You were able to see how the difference between treating the Earth as a sphere or as an ellipsoid impacts the final precision.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tWuD9Z9Yug"}],"key":"KzASHtZlx6"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UcPx16VDAj"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"n611GADY6A"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"With a great circle arc defined, it’s time to start using the great circle arc as part of a large question. Next, we will determine if a third point is along the arc or at what distance it sits from the great circle arc and path.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nmqNYU7Yv7"}],"key":"GwO3Z0hYsR"}],"key":"lTC6cgcHL1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DShfGCX5tQ"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"ZMfzJNwLGW"}],"key":"oKd0oucJnN"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://edwilliams.org/avform147.htm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ed Williams “Avitation Formulary”","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dSPJXHKPba"}],"urlSource":"https://edwilliams.org/avform147.htm","key":"thax8BlJUH"}],"key":"tO7W1Ymv8r"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://www.movable-type.co.uk/scripts/latlong.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Movable Type Scripts","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"T6rxQfQoZz"}],"urlSource":"https://www.movable-type.co.uk/scripts/latlong.html","key":"ePA4pvapNQ"}],"key":"if1e5BEJpg"}],"key":"y9QXi75cP8"}],"key":"jy7TgCrksF"}],"key":"B8FCi6S9FZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Coordinate Types","url":"/notebooks/foundations/coordinates","group":"Foundations"},"next":{"title":"Great Circles and a Point","url":"/notebooks/tutorials/arc-to-point","group":"Tutorials"}}},"domain":"http://localhost:3000"}